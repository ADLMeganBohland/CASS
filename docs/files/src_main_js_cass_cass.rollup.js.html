<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/main/js/cass/cass.rollup.js - CASS Javascript Library</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://docs.cassproject.org/img/customLogo-blue.png" title="CASS Javascript Library"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AboutPage.html">AboutPage</a></li>
                                <li><a href="../classes/AcceptAction.html">AcceptAction</a></li>
                                <li><a href="../classes/Accommodation.html">Accommodation</a></li>
                                <li><a href="../classes/AccountingService.html">AccountingService</a></li>
                                <li><a href="../classes/AccreditAction.html">AccreditAction</a></li>
                                <li><a href="../classes/AchieveAction.html">AchieveAction</a></li>
                                <li><a href="../classes/Action.html">Action</a></li>
                                <li><a href="../classes/ActionStatusType.html">ActionStatusType</a></li>
                                <li><a href="../classes/ActivateAction.html">ActivateAction</a></li>
                                <li><a href="../classes/AddAction.html">AddAction</a></li>
                                <li><a href="../classes/AdministrativeArea.html">AdministrativeArea</a></li>
                                <li><a href="../classes/AdultEntertainment.html">AdultEntertainment</a></li>
                                <li><a href="../classes/AdvancedStandingAction.html">AdvancedStandingAction</a></li>
                                <li><a href="../classes/Agent.html">Agent</a></li>
                                <li><a href="../classes/AggregateOffer.html">AggregateOffer</a></li>
                                <li><a href="../classes/AggregateRating.html">AggregateRating</a></li>
                                <li><a href="../classes/AgreeAction.html">AgreeAction</a></li>
                                <li><a href="../classes/Airline.html">Airline</a></li>
                                <li><a href="../classes/Airport.html">Airport</a></li>
                                <li><a href="../classes/AlignmentMap.html">AlignmentMap</a></li>
                                <li><a href="../classes/AlignmentObject.html">AlignmentObject</a></li>
                                <li><a href="../classes/AllocateAction.html">AllocateAction</a></li>
                                <li><a href="../classes/AmusementPark.html">AmusementPark</a></li>
                                <li><a href="../classes/AnimalShelter.html">AnimalShelter</a></li>
                                <li><a href="../classes/Answer.html">Answer</a></li>
                                <li><a href="../classes/Apartment.html">Apartment</a></li>
                                <li><a href="../classes/ApartmentComplex.html">ApartmentComplex</a></li>
                                <li><a href="../classes/APIReference.html">APIReference</a></li>
                                <li><a href="../classes/AppendAction.html">AppendAction</a></li>
                                <li><a href="../classes/ApplyAction.html">ApplyAction</a></li>
                                <li><a href="../classes/ApprenticeshipCertificate.html">ApprenticeshipCertificate</a></li>
                                <li><a href="../classes/ApproveAction.html">ApproveAction</a></li>
                                <li><a href="../classes/Aquarium.html">Aquarium</a></li>
                                <li><a href="../classes/ArriveAction.html">ArriveAction</a></li>
                                <li><a href="../classes/ArtGallery.html">ArtGallery</a></li>
                                <li><a href="../classes/Article.html">Article</a></li>
                                <li><a href="../classes/AskAction.html">AskAction</a></li>
                                <li><a href="../classes/ASNImport.html">ASNImport</a></li>
                                <li><a href="../classes/Assertion.html">Assertion</a></li>
                                <li><a href="../classes/AssertionEnvelope.html">AssertionEnvelope</a></li>
                                <li><a href="../classes/AssertionProcessor.html">AssertionProcessor</a></li>
                                <li><a href="../classes/AssessAction.html">AssessAction</a></li>
                                <li><a href="../classes/Assessment.html">Assessment</a></li>
                                <li><a href="../classes/AssessmentProfile.html">AssessmentProfile</a></li>
                                <li><a href="../classes/AssignAction.html">AssignAction</a></li>
                                <li><a href="../classes/AssociateDegree.html">AssociateDegree</a></li>
                                <li><a href="../classes/Attorney.html">Attorney</a></li>
                                <li><a href="../classes/Audience.html">Audience</a></li>
                                <li><a href="../classes/AudioObject.html">AudioObject</a></li>
                                <li><a href="../classes/AuthorizeAction.html">AuthorizeAction</a></li>
                                <li><a href="../classes/AutoBodyShop.html">AutoBodyShop</a></li>
                                <li><a href="../classes/AutoDealer.html">AutoDealer</a></li>
                                <li><a href="../classes/AutomatedTeller.html">AutomatedTeller</a></li>
                                <li><a href="../classes/AutomotiveBusiness.html">AutomotiveBusiness</a></li>
                                <li><a href="../classes/AutoPartsStore.html">AutoPartsStore</a></li>
                                <li><a href="../classes/AutoRental.html">AutoRental</a></li>
                                <li><a href="../classes/AutoRepair.html">AutoRepair</a></li>
                                <li><a href="../classes/AutoWash.html">AutoWash</a></li>
                                <li><a href="../classes/BachelorDegree.html">BachelorDegree</a></li>
                                <li><a href="../classes/Badge.html">Badge</a></li>
                                <li><a href="../classes/Bakery.html">Bakery</a></li>
                                <li><a href="../classes/BankAccount.html">BankAccount</a></li>
                                <li><a href="../classes/BankOrCreditUnion.html">BankOrCreditUnion</a></li>
                                <li><a href="../classes/Barcode.html">Barcode</a></li>
                                <li><a href="../classes/BarOrPub.html">BarOrPub</a></li>
                                <li><a href="../classes/Beach.html">Beach</a></li>
                                <li><a href="../classes/BeautySalon.html">BeautySalon</a></li>
                                <li><a href="../classes/BedAndBreakfast.html">BedAndBreakfast</a></li>
                                <li><a href="../classes/BedDetails.html">BedDetails</a></li>
                                <li><a href="../classes/BefriendAction.html">BefriendAction</a></li>
                                <li><a href="../classes/BikeStore.html">BikeStore</a></li>
                                <li><a href="../classes/Blog.html">Blog</a></li>
                                <li><a href="../classes/BlogPosting.html">BlogPosting</a></li>
                                <li><a href="../classes/BoardingPolicyType.html">BoardingPolicyType</a></li>
                                <li><a href="../classes/BodyOfWater.html">BodyOfWater</a></li>
                                <li><a href="../classes/Book.html">Book</a></li>
                                <li><a href="../classes/BookFormatType.html">BookFormatType</a></li>
                                <li><a href="../classes/BookmarkAction.html">BookmarkAction</a></li>
                                <li><a href="../classes/BookSeries.html">BookSeries</a></li>
                                <li><a href="../classes/BookStore.html">BookStore</a></li>
                                <li><a href="../classes/BorrowAction.html">BorrowAction</a></li>
                                <li><a href="../classes/BowlingAlley.html">BowlingAlley</a></li>
                                <li><a href="../classes/Brand.html">Brand</a></li>
                                <li><a href="../classes/BreadcrumbList.html">BreadcrumbList</a></li>
                                <li><a href="../classes/Brewery.html">Brewery</a></li>
                                <li><a href="../classes/Bridge.html">Bridge</a></li>
                                <li><a href="../classes/BroadcastChannel.html">BroadcastChannel</a></li>
                                <li><a href="../classes/BroadcastEvent.html">BroadcastEvent</a></li>
                                <li><a href="../classes/BroadcastService.html">BroadcastService</a></li>
                                <li><a href="../classes/BuddhistTemple.html">BuddhistTemple</a></li>
                                <li><a href="../classes/BusinessAudience.html">BusinessAudience</a></li>
                                <li><a href="../classes/BusinessEntityType.html">BusinessEntityType</a></li>
                                <li><a href="../classes/BusinessEvent.html">BusinessEvent</a></li>
                                <li><a href="../classes/BusinessFunction.html">BusinessFunction</a></li>
                                <li><a href="../classes/BusReservation.html">BusReservation</a></li>
                                <li><a href="../classes/BusStation.html">BusStation</a></li>
                                <li><a href="../classes/BusStop.html">BusStop</a></li>
                                <li><a href="../classes/BusTrip.html">BusTrip</a></li>
                                <li><a href="../classes/BuyAction.html">BuyAction</a></li>
                                <li><a href="../classes/CableOrSatelliteService.html">CableOrSatelliteService</a></li>
                                <li><a href="../classes/CafeOrCoffeeShop.html">CafeOrCoffeeShop</a></li>
                                <li><a href="../classes/Campground.html">Campground</a></li>
                                <li><a href="../classes/CampingPitch.html">CampingPitch</a></li>
                                <li><a href="../classes/Canal.html">Canal</a></li>
                                <li><a href="../classes/CancelAction.html">CancelAction</a></li>
                                <li><a href="../classes/Car.html">Car</a></li>
                                <li><a href="../classes/CareerPathway.html">CareerPathway</a></li>
                                <li><a href="../classes/Casino.html">Casino</a></li>
                                <li><a href="../classes/Cass.html">Cass</a></li>
                                <li><a href="../classes/CatholicChurch.html">CatholicChurch</a></li>
                                <li><a href="../classes/Cemetery.html">Cemetery</a></li>
                                <li><a href="../classes/Certificate.html">Certificate</a></li>
                                <li><a href="../classes/Certification.html">Certification</a></li>
                                <li><a href="../classes/CheckAction.html">CheckAction</a></li>
                                <li><a href="../classes/CheckInAction.html">CheckInAction</a></li>
                                <li><a href="../classes/CheckOutAction.html">CheckOutAction</a></li>
                                <li><a href="../classes/CheckoutPage.html">CheckoutPage</a></li>
                                <li><a href="../classes/ChildCare.html">ChildCare</a></li>
                                <li><a href="../classes/ChildrensEvent.html">ChildrensEvent</a></li>
                                <li><a href="../classes/ChooseAction.html">ChooseAction</a></li>
                                <li><a href="../classes/Church.html">Church</a></li>
                                <li><a href="../classes/City.html">City</a></li>
                                <li><a href="../classes/CityHall.html">CityHall</a></li>
                                <li><a href="../classes/CivicStructure.html">CivicStructure</a></li>
                                <li><a href="../classes/ClaimReview.html">ClaimReview</a></li>
                                <li><a href="../classes/Clip.html">Clip</a></li>
                                <li><a href="../classes/ClothingStore.html">ClothingStore</a></li>
                                <li><a href="../classes/Code.html">Code</a></li>
                                <li><a href="../classes/Collection.html">Collection</a></li>
                                <li><a href="../classes/CollectionPage.html">CollectionPage</a></li>
                                <li><a href="../classes/CollegeOrUniversity.html">CollegeOrUniversity</a></li>
                                <li><a href="../classes/ComedyClub.html">ComedyClub</a></li>
                                <li><a href="../classes/ComedyEvent.html">ComedyEvent</a></li>
                                <li><a href="../classes/Comment.html">Comment</a></li>
                                <li><a href="../classes/CommentAction.html">CommentAction</a></li>
                                <li><a href="../classes/CommunicateAction.html">CommunicateAction</a></li>
                                <li><a href="../classes/Competency.html">Competency</a></li>
                                <li><a href="../classes/CompetencyFramework.html">CompetencyFramework</a></li>
                                <li><a href="../classes/CompoundPriceSpecification.html">CompoundPriceSpecification</a></li>
                                <li><a href="../classes/ComputerLanguage.html">ComputerLanguage</a></li>
                                <li><a href="../classes/ComputerStore.html">ComputerStore</a></li>
                                <li><a href="../classes/Concept.html">Concept</a></li>
                                <li><a href="../classes/ConceptScheme.html">ConceptScheme</a></li>
                                <li><a href="../classes/ConditionManifest.html">ConditionManifest</a></li>
                                <li><a href="../classes/ConditionProfile.html">ConditionProfile</a></li>
                                <li><a href="../classes/ConfirmAction.html">ConfirmAction</a></li>
                                <li><a href="../classes/ConsumeAction.html">ConsumeAction</a></li>
                                <li><a href="../classes/ContactPage.html">ContactPage</a></li>
                                <li><a href="../classes/ContactPoint.html">ContactPoint</a></li>
                                <li><a href="../classes/ContactPointOption.html">ContactPointOption</a></li>
                                <li><a href="../classes/Continent.html">Continent</a></li>
                                <li><a href="../classes/ControlAction.html">ControlAction</a></li>
                                <li><a href="../classes/ConvenienceStore.html">ConvenienceStore</a></li>
                                <li><a href="../classes/Conversation.html">Conversation</a></li>
                                <li><a href="../classes/CookAction.html">CookAction</a></li>
                                <li><a href="../classes/Corporation.html">Corporation</a></li>
                                <li><a href="../classes/CostManifest.html">CostManifest</a></li>
                                <li><a href="../classes/CostProfile.html">CostProfile</a></li>
                                <li><a href="../classes/Country.html">Country</a></li>
                                <li><a href="../classes/Course.html">Course</a></li>
                                <li><a href="../classes/CourseInstance.html">CourseInstance</a></li>
                                <li><a href="../classes/Courthouse.html">Courthouse</a></li>
                                <li><a href="../classes/CreateAction.html">CreateAction</a></li>
                                <li><a href="../classes/CreativeWork.html">CreativeWork</a></li>
                                <li><a href="../classes/CreativeWorkSeason.html">CreativeWorkSeason</a></li>
                                <li><a href="../classes/CreativeWorkSeries.html">CreativeWorkSeries</a></li>
                                <li><a href="../classes/Credential.html">Credential</a></li>
                                <li><a href="../classes/CredentialAlignmentObject.html">CredentialAlignmentObject</a></li>
                                <li><a href="../classes/CredentialAssertion.html">CredentialAssertion</a></li>
                                <li><a href="../classes/CredentialFramework.html">CredentialFramework</a></li>
                                <li><a href="../classes/CredentialingAction.html">CredentialingAction</a></li>
                                <li><a href="../classes/CredentialOrganization.html">CredentialOrganization</a></li>
                                <li><a href="../classes/CredentialPerson.html">CredentialPerson</a></li>
                                <li><a href="../classes/CreditCard.html">CreditCard</a></li>
                                <li><a href="../classes/Crematorium.html">Crematorium</a></li>
                                <li><a href="../classes/CSVExport.html">CSVExport</a></li>
                                <li><a href="../classes/CSVImport.html">CSVImport</a></li>
                                <li><a href="../classes/CurrencyConversionService.html">CurrencyConversionService</a></li>
                                <li><a href="../classes/DanceEvent.html">DanceEvent</a></li>
                                <li><a href="../classes/DanceGroup.html">DanceGroup</a></li>
                                <li><a href="../classes/DataCatalog.html">DataCatalog</a></li>
                                <li><a href="../classes/DataDownload.html">DataDownload</a></li>
                                <li><a href="../classes/DataFeed.html">DataFeed</a></li>
                                <li><a href="../classes/DataFeedItem.html">DataFeedItem</a></li>
                                <li><a href="../classes/Dataset.html">Dataset</a></li>
                                <li><a href="../classes/DatedMoneySpecification.html">DatedMoneySpecification</a></li>
                                <li><a href="../classes/DayOfWeek.html">DayOfWeek</a></li>
                                <li><a href="../classes/DaySpa.html">DaySpa</a></li>
                                <li><a href="../classes/DeactivateAction.html">DeactivateAction</a></li>
                                <li><a href="../classes/DefenceEstablishment.html">DefenceEstablishment</a></li>
                                <li><a href="../classes/Degree.html">Degree</a></li>
                                <li><a href="../classes/DeleteAction.html">DeleteAction</a></li>
                                <li><a href="../classes/DeliveryChargeSpecification.html">DeliveryChargeSpecification</a></li>
                                <li><a href="../classes/DeliveryEvent.html">DeliveryEvent</a></li>
                                <li><a href="../classes/DeliveryMethod.html">DeliveryMethod</a></li>
                                <li><a href="../classes/Demand.html">Demand</a></li>
                                <li><a href="../classes/Dentist.html">Dentist</a></li>
                                <li><a href="../classes/DepartAction.html">DepartAction</a></li>
                                <li><a href="../classes/DepartmentStore.html">DepartmentStore</a></li>
                                <li><a href="../classes/DepositAccount.html">DepositAccount</a></li>
                                <li><a href="../classes/DigitalBadge.html">DigitalBadge</a></li>
                                <li><a href="../classes/DigitalDocument.html">DigitalDocument</a></li>
                                <li><a href="../classes/DigitalDocumentPermission.html">DigitalDocumentPermission</a></li>
                                <li><a href="../classes/DigitalDocumentPermissionType.html">DigitalDocumentPermissionType</a></li>
                                <li><a href="../classes/Diploma.html">Diploma</a></li>
                                <li><a href="../classes/DisagreeAction.html">DisagreeAction</a></li>
                                <li><a href="../classes/DiscoverAction.html">DiscoverAction</a></li>
                                <li><a href="../classes/DiscussionForumPosting.html">DiscussionForumPosting</a></li>
                                <li><a href="../classes/DislikeAction.html">DislikeAction</a></li>
                                <li><a href="../classes/Distance.html">Distance</a></li>
                                <li><a href="../classes/DoctoralDegree.html">DoctoralDegree</a></li>
                                <li><a href="../classes/DonateAction.html">DonateAction</a></li>
                                <li><a href="../classes/DownloadAction.html">DownloadAction</a></li>
                                <li><a href="../classes/DrawAction.html">DrawAction</a></li>
                                <li><a href="../classes/DrinkAction.html">DrinkAction</a></li>
                                <li><a href="../classes/DriveWheelConfigurationValue.html">DriveWheelConfigurationValue</a></li>
                                <li><a href="../classes/DryCleaningOrLaundry.html">DryCleaningOrLaundry</a></li>
                                <li><a href="../classes/Duration.html">Duration</a></li>
                                <li><a href="../classes/DurationProfile.html">DurationProfile</a></li>
                                <li><a href="../classes/EarningsProfile.html">EarningsProfile</a></li>
                                <li><a href="../classes/EatAction.html">EatAction</a></li>
                                <li><a href="../classes/Ebac.html">Ebac</a></li>
                                <li><a href="../classes/EbacContact.html">EbacContact</a></li>
                                <li><a href="../classes/EbacContactGrant.html">EbacContactGrant</a></li>
                                <li><a href="../classes/EbacCredential.html">EbacCredential</a></li>
                                <li><a href="../classes/EbacCredentialCommit.html">EbacCredentialCommit</a></li>
                                <li><a href="../classes/EbacCredentialRequest.html">EbacCredentialRequest</a></li>
                                <li><a href="../classes/EbacCredentials.html">EbacCredentials</a></li>
                                <li><a href="../classes/EbacEncryptedSecret.html">EbacEncryptedSecret</a></li>
                                <li><a href="../classes/EbacEncryptedValue.html">EbacEncryptedValue</a></li>
                                <li><a href="../classes/EbacSignature.html">EbacSignature</a></li>
                                <li><a href="../classes/EcAes.html">EcAes</a></li>
                                <li><a href="../classes/EcAesCtr.html">EcAesCtr</a></li>
                                <li><a href="../classes/EcAesCtrAsync.html">EcAesCtrAsync</a></li>
                                <li><a href="../classes/EcAesCtrAsyncWorker.html">EcAesCtrAsyncWorker</a></li>
                                <li><a href="../classes/EcAlignment.html">EcAlignment</a></li>
                                <li><a href="../classes/EcArray.html">EcArray</a></li>
                                <li><a href="../classes/EcAsyncHelper.html">EcAsyncHelper</a></li>
                                <li><a href="../classes/EcCompetency.html">EcCompetency</a></li>
                                <li><a href="../classes/EcContact.html">EcContact</a></li>
                                <li><a href="../classes/EcCrypto.html">EcCrypto</a></li>
                                <li><a href="../classes/EcDirectedGraph.html">EcDirectedGraph</a></li>
                                <li><a href="../classes/EcEncryptedValue.html">EcEncryptedValue</a></li>
                                <li><a href="../classes/EcFile.html">EcFile</a></li>
                                <li><a href="../classes/EcFramework.html">EcFramework</a></li>
                                <li><a href="../classes/EcFrameworkGraph.html">EcFrameworkGraph</a></li>
                                <li><a href="../classes/EcIdentity.html">EcIdentity</a></li>
                                <li><a href="../classes/EcIdentityManager.html">EcIdentityManager</a></li>
                                <li><a href="../classes/EcLevel.html">EcLevel</a></li>
                                <li><a href="../classes/EcLinkedData.html">EcLinkedData</a></li>
                                <li><a href="../classes/EcModal.html">EcModal</a></li>
                                <li><a href="../classes/EcObject.html">EcObject</a></li>
                                <li><a href="../classes/EcOverlay.html">EcOverlay</a></li>
                                <li><a href="../classes/EcPk.html">EcPk</a></li>
                                <li><a href="../classes/EcPpk.html">EcPpk</a></li>
                                <li><a href="../classes/EcRemote.html">EcRemote</a></li>
                                <li><a href="../classes/EcRemoteIdentityManager.html">EcRemoteIdentityManager</a></li>
                                <li><a href="../classes/EcRemoteLinkedData.html">EcRemoteLinkedData</a></li>
                                <li><a href="../classes/EcRepository.html">EcRepository</a></li>
                                <li><a href="../classes/EcRollupRule.html">EcRollupRule</a></li>
                                <li><a href="../classes/EcRsaOaep.html">EcRsaOaep</a></li>
                                <li><a href="../classes/EcRsaOaepAsync.html">EcRsaOaepAsync</a></li>
                                <li><a href="../classes/EcRsaOaepAsyncWorker.html">EcRsaOaepAsyncWorker</a></li>
                                <li><a href="../classes/EcScreen.html">EcScreen</a></li>
                                <li><a href="../classes/EcView.html">EcView</a></li>
                                <li><a href="../classes/EducationalAudience.html">EducationalAudience</a></li>
                                <li><a href="../classes/EducationalOrganization.html">EducationalOrganization</a></li>
                                <li><a href="../classes/EducationEvent.html">EducationEvent</a></li>
                                <li><a href="../classes/Electrician.html">Electrician</a></li>
                                <li><a href="../classes/ElectronicsStore.html">ElectronicsStore</a></li>
                                <li><a href="../classes/ElementarySchool.html">ElementarySchool</a></li>
                                <li><a href="../classes/EmailMessage.html">EmailMessage</a></li>
                                <li><a href="../classes/Embassy.html">Embassy</a></li>
                                <li><a href="../classes/EmergencyService.html">EmergencyService</a></li>
                                <li><a href="../classes/EmployeeRole.html">EmployeeRole</a></li>
                                <li><a href="../classes/EmploymentAgency.html">EmploymentAgency</a></li>
                                <li><a href="../classes/EmploymentOutcomeProfile.html">EmploymentOutcomeProfile</a></li>
                                <li><a href="../classes/EndorseAction.html">EndorseAction</a></li>
                                <li><a href="../classes/Energy.html">Energy</a></li>
                                <li><a href="../classes/EngineSpecification.html">EngineSpecification</a></li>
                                <li><a href="../classes/EntertainmentBusiness.html">EntertainmentBusiness</a></li>
                                <li><a href="../classes/EntryPoint.html">EntryPoint</a></li>
                                <li><a href="../classes/Enumeration.html">Enumeration</a></li>
                                <li><a href="../classes/Episode.html">Episode</a></li>
                                <li><a href="../classes/Event.html">Event</a></li>
                                <li><a href="../classes/EventReservation.html">EventReservation</a></li>
                                <li><a href="../classes/EventStatusType.html">EventStatusType</a></li>
                                <li><a href="../classes/EventVenue.html">EventVenue</a></li>
                                <li><a href="../classes/ExerciseAction.html">ExerciseAction</a></li>
                                <li><a href="../classes/ExerciseGym.html">ExerciseGym</a></li>
                                <li><a href="../classes/ExhibitionEvent.html">ExhibitionEvent</a></li>
                                <li><a href="../classes/Exporter.html">Exporter</a></li>
                                <li><a href="../classes/FastFoodRestaurant.html">FastFoodRestaurant</a></li>
                                <li><a href="../classes/Festival.html">Festival</a></li>
                                <li><a href="../classes/FilmAction.html">FilmAction</a></li>
                                <li><a href="../classes/FinancialAlignmentObject.html">FinancialAlignmentObject</a></li>
                                <li><a href="../classes/FinancialAssistanceProfile.html">FinancialAssistanceProfile</a></li>
                                <li><a href="../classes/FinancialProduct.html">FinancialProduct</a></li>
                                <li><a href="../classes/FinancialService.html">FinancialService</a></li>
                                <li><a href="../classes/FindAction.html">FindAction</a></li>
                                <li><a href="../classes/FireStation.html">FireStation</a></li>
                                <li><a href="../classes/Flight.html">Flight</a></li>
                                <li><a href="../classes/FlightReservation.html">FlightReservation</a></li>
                                <li><a href="../classes/Florist.html">Florist</a></li>
                                <li><a href="../classes/FollowAction.html">FollowAction</a></li>
                                <li><a href="../classes/FoodEstablishment.html">FoodEstablishment</a></li>
                                <li><a href="../classes/FoodEstablishmentReservation.html">FoodEstablishmentReservation</a></li>
                                <li><a href="../classes/FoodEvent.html">FoodEvent</a></li>
                                <li><a href="../classes/FoodService.html">FoodService</a></li>
                                <li><a href="../classes/Framework.html">Framework</a></li>
                                <li><a href="../classes/FrameworkImport.html">FrameworkImport</a></li>
                                <li><a href="../classes/FurnitureStore.html">FurnitureStore</a></li>
                                <li><a href="../classes/Game.html">Game</a></li>
                                <li><a href="../classes/GamePlayMode.html">GamePlayMode</a></li>
                                <li><a href="../classes/GameServer.html">GameServer</a></li>
                                <li><a href="../classes/GameServerStatus.html">GameServerStatus</a></li>
                                <li><a href="../classes/GardenStore.html">GardenStore</a></li>
                                <li><a href="../classes/GasStation.html">GasStation</a></li>
                                <li><a href="../classes/GatedResidenceCommunity.html">GatedResidenceCommunity</a></li>
                                <li><a href="../classes/GenderType.html">GenderType</a></li>
                                <li><a href="../classes/General.html">General</a></li>
                                <li><a href="../classes/GeneralContractor.html">GeneralContractor</a></li>
                                <li><a href="../classes/GeneralEducationDevelopment.html">GeneralEducationDevelopment</a></li>
                                <li><a href="../classes/GeneralFile.html">GeneralFile</a></li>
                                <li><a href="../classes/GeoCircle.html">GeoCircle</a></li>
                                <li><a href="../classes/GeoCoordinates.html">GeoCoordinates</a></li>
                                <li><a href="../classes/GeoShape.html">GeoShape</a></li>
                                <li><a href="../classes/GiveAction.html">GiveAction</a></li>
                                <li><a href="../classes/GolfCourse.html">GolfCourse</a></li>
                                <li><a href="../classes/GovernmentBuilding.html">GovernmentBuilding</a></li>
                                <li><a href="../classes/GovernmentOffice.html">GovernmentOffice</a></li>
                                <li><a href="../classes/GovernmentOrganization.html">GovernmentOrganization</a></li>
                                <li><a href="../classes/GovernmentPermit.html">GovernmentPermit</a></li>
                                <li><a href="../classes/GovernmentService.html">GovernmentService</a></li>
                                <li><a href="../classes/Graph.html">Graph</a></li>
                                <li><a href="../classes/GroceryStore.html">GroceryStore</a></li>
                                <li><a href="../classes/HairSalon.html">HairSalon</a></li>
                                <li><a href="../classes/HardwareStore.html">HardwareStore</a></li>
                                <li><a href="../classes/HealthAndBeautyBusiness.html">HealthAndBeautyBusiness</a></li>
                                <li><a href="../classes/HealthClub.html">HealthClub</a></li>
                                <li><a href="../classes/HighSchool.html">HighSchool</a></li>
                                <li><a href="../classes/HinduTemple.html">HinduTemple</a></li>
                                <li><a href="../classes/HistoryClosure.html">HistoryClosure</a></li>
                                <li><a href="../classes/HobbyShop.html">HobbyShop</a></li>
                                <li><a href="../classes/HoldersProfile.html">HoldersProfile</a></li>
                                <li><a href="../classes/HomeAndConstructionBusiness.html">HomeAndConstructionBusiness</a></li>
                                <li><a href="../classes/HomeGoodsStore.html">HomeGoodsStore</a></li>
                                <li><a href="../classes/Hospital.html">Hospital</a></li>
                                <li><a href="../classes/Hostel.html">Hostel</a></li>
                                <li><a href="../classes/Hotel.html">Hotel</a></li>
                                <li><a href="../classes/HotelRoom.html">HotelRoom</a></li>
                                <li><a href="../classes/House.html">House</a></li>
                                <li><a href="../classes/HousePainter.html">HousePainter</a></li>
                                <li><a href="../classes/HVACBusiness.html">HVACBusiness</a></li>
                                <li><a href="../classes/Hypergraph.html">Hypergraph</a></li>
                                <li><a href="../classes/IceCreamShop.html">IceCreamShop</a></li>
                                <li><a href="../classes/IdentifierValue.html">IdentifierValue</a></li>
                                <li><a href="../classes/IdentifierValueSet.html">IdentifierValueSet</a></li>
                                <li><a href="../classes/IgnoreAction.html">IgnoreAction</a></li>
                                <li><a href="../classes/ImageGallery.html">ImageGallery</a></li>
                                <li><a href="../classes/ImageObject.html">ImageObject</a></li>
                                <li><a href="../classes/Importer.html">Importer</a></li>
                                <li><a href="../classes/IndividualProduct.html">IndividualProduct</a></li>
                                <li><a href="../classes/IndustryClassification.html">IndustryClassification</a></li>
                                <li><a href="../classes/InformAction.html">InformAction</a></li>
                                <li><a href="../classes/InquiryPacket.html">InquiryPacket</a></li>
                                <li><a href="../classes/InsertAction.html">InsertAction</a></li>
                                <li><a href="../classes/InstallAction.html">InstallAction</a></li>
                                <li><a href="../classes/InstructionalProgramClassification.html">InstructionalProgramClassification</a></li>
                                <li><a href="../classes/InsuranceAgency.html">InsuranceAgency</a></li>
                                <li><a href="../classes/Intangible.html">Intangible</a></li>
                                <li><a href="../classes/InteractAction.html">InteractAction</a></li>
                                <li><a href="../classes/InteractionCounter.html">InteractionCounter</a></li>
                                <li><a href="../classes/InternetCafe.html">InternetCafe</a></li>
                                <li><a href="../classes/InvestmentOrDeposit.html">InvestmentOrDeposit</a></li>
                                <li><a href="../classes/InviteAction.html">InviteAction</a></li>
                                <li><a href="../classes/Invoice.html">Invoice</a></li>
                                <li><a href="../classes/ItemAvailability.html">ItemAvailability</a></li>
                                <li><a href="../classes/ItemList.html">ItemList</a></li>
                                <li><a href="../classes/ItemListOrderType.html">ItemListOrderType</a></li>
                                <li><a href="../classes/ItemPage.html">ItemPage</a></li>
                                <li><a href="../classes/JewelryStore.html">JewelryStore</a></li>
                                <li><a href="../classes/JobPosting.html">JobPosting</a></li>
                                <li><a href="../classes/JoinAction.html">JoinAction</a></li>
                                <li><a href="../classes/JourneymanCertificate.html">JourneymanCertificate</a></li>
                                <li><a href="../classes/JurisdictionProfile.html">JurisdictionProfile</a></li>
                                <li><a href="../classes/LakeBodyOfWater.html">LakeBodyOfWater</a></li>
                                <li><a href="../classes/Landform.html">Landform</a></li>
                                <li><a href="../classes/LandmarksOrHistoricalBuildings.html">LandmarksOrHistoricalBuildings</a></li>
                                <li><a href="../classes/Language.html">Language</a></li>
                                <li><a href="../classes/LearningOpportunity.html">LearningOpportunity</a></li>
                                <li><a href="../classes/LearningOpportunityProfile.html">LearningOpportunityProfile</a></li>
                                <li><a href="../classes/LearningResource.html">LearningResource</a></li>
                                <li><a href="../classes/LeaveAction.html">LeaveAction</a></li>
                                <li><a href="../classes/LegalService.html">LegalService</a></li>
                                <li><a href="../classes/LegislativeBuilding.html">LegislativeBuilding</a></li>
                                <li><a href="../classes/LendAction.html">LendAction</a></li>
                                <li><a href="../classes/Level.html">Level</a></li>
                                <li><a href="../classes/Library.html">Library</a></li>
                                <li><a href="../classes/License.html">License</a></li>
                                <li><a href="../classes/LikeAction.html">LikeAction</a></li>
                                <li><a href="../classes/LiquorStore.html">LiquorStore</a></li>
                                <li><a href="../classes/ListenAction.html">ListenAction</a></li>
                                <li><a href="../classes/ListItem.html">ListItem</a></li>
                                <li><a href="../classes/LiteraryEvent.html">LiteraryEvent</a></li>
                                <li><a href="../classes/LiveBlogPosting.html">LiveBlogPosting</a></li>
                                <li><a href="../classes/LoanOrCredit.html">LoanOrCredit</a></li>
                                <li><a href="../classes/LocalBusiness.html">LocalBusiness</a></li>
                                <li><a href="../classes/LocationFeatureSpecification.html">LocationFeatureSpecification</a></li>
                                <li><a href="../classes/LockerDelivery.html">LockerDelivery</a></li>
                                <li><a href="../classes/Locksmith.html">Locksmith</a></li>
                                <li><a href="../classes/LodgingBusiness.html">LodgingBusiness</a></li>
                                <li><a href="../classes/LodgingReservation.html">LodgingReservation</a></li>
                                <li><a href="../classes/LoseAction.html">LoseAction</a></li>
                                <li><a href="../classes/Map.html">Map</a></li>
                                <li><a href="../classes/MapCategoryType.html">MapCategoryType</a></li>
                                <li><a href="../classes/MarryAction.html">MarryAction</a></li>
                                <li><a href="../classes/Mass.html">Mass</a></li>
                                <li><a href="../classes/MasterCertificate.html">MasterCertificate</a></li>
                                <li><a href="../classes/MasterDegree.html">MasterDegree</a></li>
                                <li><a href="../classes/MedbiqImport.html">MedbiqImport</a></li>
                                <li><a href="../classes/MediaObject.html">MediaObject</a></li>
                                <li><a href="../classes/MedicalOrganization.html">MedicalOrganization</a></li>
                                <li><a href="../classes/MeetingRoom.html">MeetingRoom</a></li>
                                <li><a href="../classes/MensClothingStore.html">MensClothingStore</a></li>
                                <li><a href="../classes/Menu.html">Menu</a></li>
                                <li><a href="../classes/MenuItem.html">MenuItem</a></li>
                                <li><a href="../classes/MenuSection.html">MenuSection</a></li>
                                <li><a href="../classes/Message.html">Message</a></li>
                                <li><a href="../classes/MicroCredential.html">MicroCredential</a></li>
                                <li><a href="../classes/MiddleSchool.html">MiddleSchool</a></li>
                                <li><a href="../classes/MobileApplication.html">MobileApplication</a></li>
                                <li><a href="../classes/MobilePhoneStore.html">MobilePhoneStore</a></li>
                                <li><a href="../classes/ModalManager.html">ModalManager</a></li>
                                <li><a href="../classes/MonetaryAmount.html">MonetaryAmount</a></li>
                                <li><a href="../classes/MoodleConfig.html">MoodleConfig</a></li>
                                <li><a href="../classes/Mosque.html">Mosque</a></li>
                                <li><a href="../classes/Motel.html">Motel</a></li>
                                <li><a href="../classes/MotorcycleDealer.html">MotorcycleDealer</a></li>
                                <li><a href="../classes/MotorcycleRepair.html">MotorcycleRepair</a></li>
                                <li><a href="../classes/Mountain.html">Mountain</a></li>
                                <li><a href="../classes/MoveAction.html">MoveAction</a></li>
                                <li><a href="../classes/Movie.html">Movie</a></li>
                                <li><a href="../classes/MovieClip.html">MovieClip</a></li>
                                <li><a href="../classes/MovieRentalStore.html">MovieRentalStore</a></li>
                                <li><a href="../classes/MovieSeries.html">MovieSeries</a></li>
                                <li><a href="../classes/MovieTheater.html">MovieTheater</a></li>
                                <li><a href="../classes/MovingCompany.html">MovingCompany</a></li>
                                <li><a href="../classes/Museum.html">Museum</a></li>
                                <li><a href="../classes/MusicAlbum.html">MusicAlbum</a></li>
                                <li><a href="../classes/MusicAlbumProductionType.html">MusicAlbumProductionType</a></li>
                                <li><a href="../classes/MusicAlbumReleaseType.html">MusicAlbumReleaseType</a></li>
                                <li><a href="../classes/MusicComposition.html">MusicComposition</a></li>
                                <li><a href="../classes/MusicEvent.html">MusicEvent</a></li>
                                <li><a href="../classes/MusicGroup.html">MusicGroup</a></li>
                                <li><a href="../classes/MusicPlaylist.html">MusicPlaylist</a></li>
                                <li><a href="../classes/MusicRecording.html">MusicRecording</a></li>
                                <li><a href="../classes/MusicRelease.html">MusicRelease</a></li>
                                <li><a href="../classes/MusicReleaseFormatType.html">MusicReleaseFormatType</a></li>
                                <li><a href="../classes/MusicStore.html">MusicStore</a></li>
                                <li><a href="../classes/MusicVenue.html">MusicVenue</a></li>
                                <li><a href="../classes/MusicVideoObject.html">MusicVideoObject</a></li>
                                <li><a href="../classes/NailSalon.html">NailSalon</a></li>
                                <li><a href="../classes/NewsArticle.html">NewsArticle</a></li>
                                <li><a href="../classes/NGO.html">NGO</a></li>
                                <li><a href="../classes/NightClub.html">NightClub</a></li>
                                <li><a href="../classes/Notary.html">Notary</a></li>
                                <li><a href="../classes/NoteDigitalDocument.html">NoteDigitalDocument</a></li>
                                <li><a href="../classes/NutritionInformation.html">NutritionInformation</a></li>
                                <li><a href="../classes/OccupationClassification.html">OccupationClassification</a></li>
                                <li><a href="../classes/OceanBodyOfWater.html">OceanBodyOfWater</a></li>
                                <li><a href="../classes/Offer.html">Offer</a></li>
                                <li><a href="../classes/OfferAction.html">OfferAction</a></li>
                                <li><a href="../classes/OfferCatalog.html">OfferCatalog</a></li>
                                <li><a href="../classes/OfferItemCondition.html">OfferItemCondition</a></li>
                                <li><a href="../classes/OfficeEquipmentStore.html">OfficeEquipmentStore</a></li>
                                <li><a href="../classes/OnDemandEvent.html">OnDemandEvent</a></li>
                                <li><a href="../classes/OpenBadge.html">OpenBadge</a></li>
                                <li><a href="../classes/OpeningHoursSpecification.html">OpeningHoursSpecification</a></li>
                                <li><a href="../classes/Order.html">Order</a></li>
                                <li><a href="../classes/OrderAction.html">OrderAction</a></li>
                                <li><a href="../classes/OrderedCollection.html">OrderedCollection</a></li>
                                <li><a href="../classes/OrderItem.html">OrderItem</a></li>
                                <li><a href="../classes/OrderStatus.html">OrderStatus</a></li>
                                <li><a href="../classes/Organization.html">Organization</a></li>
                                <li><a href="../classes/OrganizationRole.html">OrganizationRole</a></li>
                                <li><a href="../classes/OrganizeAction.html">OrganizeAction</a></li>
                                <li><a href="../classes/OutletStore.html">OutletStore</a></li>
                                <li><a href="../classes/OverlayManager.html">OverlayManager</a></li>
                                <li><a href="../classes/OwnershipInfo.html">OwnershipInfo</a></li>
                                <li><a href="../classes/PaintAction.html">PaintAction</a></li>
                                <li><a href="../classes/Painting.html">Painting</a></li>
                                <li><a href="../classes/ParcelDelivery.html">ParcelDelivery</a></li>
                                <li><a href="../classes/ParcelService.html">ParcelService</a></li>
                                <li><a href="../classes/ParentAudience.html">ParentAudience</a></li>
                                <li><a href="../classes/Park.html">Park</a></li>
                                <li><a href="../classes/ParkingFacility.html">ParkingFacility</a></li>
                                <li><a href="../classes/PawnShop.html">PawnShop</a></li>
                                <li><a href="../classes/PayAction.html">PayAction</a></li>
                                <li><a href="../classes/PaymentCard.html">PaymentCard</a></li>
                                <li><a href="../classes/PaymentChargeSpecification.html">PaymentChargeSpecification</a></li>
                                <li><a href="../classes/PaymentMethod.html">PaymentMethod</a></li>
                                <li><a href="../classes/PaymentService.html">PaymentService</a></li>
                                <li><a href="../classes/PaymentStatusType.html">PaymentStatusType</a></li>
                                <li><a href="../classes/PeopleAudience.html">PeopleAudience</a></li>
                                <li><a href="../classes/PerformAction.html">PerformAction</a></li>
                                <li><a href="../classes/PerformanceRole.html">PerformanceRole</a></li>
                                <li><a href="../classes/PerformingArtsTheater.html">PerformingArtsTheater</a></li>
                                <li><a href="../classes/PerformingGroup.html">PerformingGroup</a></li>
                                <li><a href="../classes/Periodical.html">Periodical</a></li>
                                <li><a href="../classes/Permit.html">Permit</a></li>
                                <li><a href="../classes/Person.html">Person</a></li>
                                <li><a href="../classes/PetStore.html">PetStore</a></li>
                                <li><a href="../classes/Pharmacy.html">Pharmacy</a></li>
                                <li><a href="../classes/Photograph.html">Photograph</a></li>
                                <li><a href="../classes/PhotographAction.html">PhotographAction</a></li>
                                <li><a href="../classes/Physician.html">Physician</a></li>
                                <li><a href="../classes/Place.html">Place</a></li>
                                <li><a href="../classes/PlaceOfWorship.html">PlaceOfWorship</a></li>
                                <li><a href="../classes/PlanAction.html">PlanAction</a></li>
                                <li><a href="../classes/PlayAction.html">PlayAction</a></li>
                                <li><a href="../classes/Playground.html">Playground</a></li>
                                <li><a href="../classes/Plumber.html">Plumber</a></li>
                                <li><a href="../classes/PoliceStation.html">PoliceStation</a></li>
                                <li><a href="../classes/Pond.html">Pond</a></li>
                                <li><a href="../classes/PostalAddress.html">PostalAddress</a></li>
                                <li><a href="../classes/PostOffice.html">PostOffice</a></li>
                                <li><a href="../classes/PrependAction.html">PrependAction</a></li>
                                <li><a href="../classes/Preschool.html">Preschool</a></li>
                                <li><a href="../classes/PresentationDigitalDocument.html">PresentationDigitalDocument</a></li>
                                <li><a href="../classes/PriceSpecification.html">PriceSpecification</a></li>
                                <li><a href="../classes/ProcessProfile.html">ProcessProfile</a></li>
                                <li><a href="../classes/Product.html">Product</a></li>
                                <li><a href="../classes/ProductModel.html">ProductModel</a></li>
                                <li><a href="../classes/ProfessionalDoctorate.html">ProfessionalDoctorate</a></li>
                                <li><a href="../classes/ProfessionalService.html">ProfessionalService</a></li>
                                <li><a href="../classes/ProficiencyScale.html">ProficiencyScale</a></li>
                                <li><a href="../classes/ProfilePage.html">ProfilePage</a></li>
                                <li><a href="../classes/ProfileProcessor.html">ProfileProcessor</a></li>
                                <li><a href="../classes/ProgramMembership.html">ProgramMembership</a></li>
                                <li><a href="../classes/PropertyValue.html">PropertyValue</a></li>
                                <li><a href="../classes/PropertyValueSpecification.html">PropertyValueSpecification</a></li>
                                <li><a href="../classes/PublicationEvent.html">PublicationEvent</a></li>
                                <li><a href="../classes/PublicationIssue.html">PublicationIssue</a></li>
                                <li><a href="../classes/PublicationVolume.html">PublicationVolume</a></li>
                                <li><a href="../classes/PublicSwimmingPool.html">PublicSwimmingPool</a></li>
                                <li><a href="../classes/QACredentialOrganization.html">QACredentialOrganization</a></li>
                                <li><a href="../classes/QAPage.html">QAPage</a></li>
                                <li><a href="../classes/QualitativeValue.html">QualitativeValue</a></li>
                                <li><a href="../classes/QualityAssuranceCredential.html">QualityAssuranceCredential</a></li>
                                <li><a href="../classes/QuantitativeValue.html">QuantitativeValue</a></li>
                                <li><a href="../classes/Quantity.html">Quantity</a></li>
                                <li><a href="../classes/Question.html">Question</a></li>
                                <li><a href="../classes/QuoteAction.html">QuoteAction</a></li>
                                <li><a href="../classes/RadioChannel.html">RadioChannel</a></li>
                                <li><a href="../classes/RadioClip.html">RadioClip</a></li>
                                <li><a href="../classes/RadioEpisode.html">RadioEpisode</a></li>
                                <li><a href="../classes/RadioSeason.html">RadioSeason</a></li>
                                <li><a href="../classes/RadioSeries.html">RadioSeries</a></li>
                                <li><a href="../classes/RadioStation.html">RadioStation</a></li>
                                <li><a href="../classes/Rating.html">Rating</a></li>
                                <li><a href="../classes/ReactAction.html">ReactAction</a></li>
                                <li><a href="../classes/ReadAction.html">ReadAction</a></li>
                                <li><a href="../classes/RealEstateAgent.html">RealEstateAgent</a></li>
                                <li><a href="../classes/ReceiveAction.html">ReceiveAction</a></li>
                                <li><a href="../classes/Recipe.html">Recipe</a></li>
                                <li><a href="../classes/RecognizeAction.html">RecognizeAction</a></li>
                                <li><a href="../classes/RecyclingCenter.html">RecyclingCenter</a></li>
                                <li><a href="../classes/RegisterAction.html">RegisterAction</a></li>
                                <li><a href="../classes/RegulateAction.html">RegulateAction</a></li>
                                <li><a href="../classes/RejectAction.html">RejectAction</a></li>
                                <li><a href="../classes/Relation.html">Relation</a></li>
                                <li><a href="../classes/RelationshipPacketGenerator.html">RelationshipPacketGenerator</a></li>
                                <li><a href="../classes/RenewAction.html">RenewAction</a></li>
                                <li><a href="../classes/RentAction.html">RentAction</a></li>
                                <li><a href="../classes/RentalCarReservation.html">RentalCarReservation</a></li>
                                <li><a href="../classes/ReplaceAction.html">ReplaceAction</a></li>
                                <li><a href="../classes/ReplyAction.html">ReplyAction</a></li>
                                <li><a href="../classes/Report.html">Report</a></li>
                                <li><a href="../classes/ResearchDoctorate.html">ResearchDoctorate</a></li>
                                <li><a href="../classes/Reservation.html">Reservation</a></li>
                                <li><a href="../classes/ReservationPackage.html">ReservationPackage</a></li>
                                <li><a href="../classes/ReservationStatusType.html">ReservationStatusType</a></li>
                                <li><a href="../classes/ReserveAction.html">ReserveAction</a></li>
                                <li><a href="../classes/Reservoir.html">Reservoir</a></li>
                                <li><a href="../classes/Residence.html">Residence</a></li>
                                <li><a href="../classes/Resort.html">Resort</a></li>
                                <li><a href="../classes/Restaurant.html">Restaurant</a></li>
                                <li><a href="../classes/RestrictedDiet.html">RestrictedDiet</a></li>
                                <li><a href="../classes/ResumeAction.html">ResumeAction</a></li>
                                <li><a href="../classes/ReturnAction.html">ReturnAction</a></li>
                                <li><a href="../classes/Review.html">Review</a></li>
                                <li><a href="../classes/ReviewAction.html">ReviewAction</a></li>
                                <li><a href="../classes/RevocationProfile.html">RevocationProfile</a></li>
                                <li><a href="../classes/RevokeAction.html">RevokeAction</a></li>
                                <li><a href="../classes/RightsAction.html">RightsAction</a></li>
                                <li><a href="../classes/RiverBodyOfWater.html">RiverBodyOfWater</a></li>
                                <li><a href="../classes/Role.html">Role</a></li>
                                <li><a href="../classes/RollupRule.html">RollupRule</a></li>
                                <li><a href="../classes/RoofingContractor.html">RoofingContractor</a></li>
                                <li><a href="../classes/Room.html">Room</a></li>
                                <li><a href="../classes/RsvpAction.html">RsvpAction</a></li>
                                <li><a href="../classes/RsvpResponseType.html">RsvpResponseType</a></li>
                                <li><a href="../classes/RVPark.html">RVPark</a></li>
                                <li><a href="../classes/SaleEvent.html">SaleEvent</a></li>
                                <li><a href="../classes/ScheduleAction.html">ScheduleAction</a></li>
                                <li><a href="../classes/ScholarlyArticle.html">ScholarlyArticle</a></li>
                                <li><a href="../classes/School.html">School</a></li>
                                <li><a href="../classes/ScreeningEvent.html">ScreeningEvent</a></li>
                                <li><a href="../classes/Screenmanager.html">Screenmanager</a></li>
                                <li><a href="../classes/Sculpture.html">Sculpture</a></li>
                                <li><a href="../classes/SeaBodyOfWater.html">SeaBodyOfWater</a></li>
                                <li><a href="../classes/SearchAction.html">SearchAction</a></li>
                                <li><a href="../classes/SearchResultsPage.html">SearchResultsPage</a></li>
                                <li><a href="../classes/Season.html">Season</a></li>
                                <li><a href="../classes/Seat.html">Seat</a></li>
                                <li><a href="../classes/SecondarySchoolDiploma.html">SecondarySchoolDiploma</a></li>
                                <li><a href="../classes/SelfStorage.html">SelfStorage</a></li>
                                <li><a href="../classes/SellAction.html">SellAction</a></li>
                                <li><a href="../classes/SendAction.html">SendAction</a></li>
                                <li><a href="../classes/Series.html">Series</a></li>
                                <li><a href="../classes/Service.html">Service</a></li>
                                <li><a href="../classes/ServiceChannel.html">ServiceChannel</a></li>
                                <li><a href="../classes/ShareAction.html">ShareAction</a></li>
                                <li><a href="../classes/ShoeStore.html">ShoeStore</a></li>
                                <li><a href="../classes/ShoppingCenter.html">ShoppingCenter</a></li>
                                <li><a href="../classes/SingleFamilyResidence.html">SingleFamilyResidence</a></li>
                                <li><a href="../classes/SiteNavigationElement.html">SiteNavigationElement</a></li>
                                <li><a href="../classes/SkiResort.html">SkiResort</a></li>
                                <li><a href="../classes/SocialEvent.html">SocialEvent</a></li>
                                <li><a href="../classes/SocialMediaPosting.html">SocialMediaPosting</a></li>
                                <li><a href="../classes/SoftwareApplication.html">SoftwareApplication</a></li>
                                <li><a href="../classes/SoftwareSourceCode.html">SoftwareSourceCode</a></li>
                                <li><a href="../classes/SomeProducts.html">SomeProducts</a></li>
                                <li><a href="../classes/Specialty.html">Specialty</a></li>
                                <li><a href="../classes/SportingGoodsStore.html">SportingGoodsStore</a></li>
                                <li><a href="../classes/SportsActivityLocation.html">SportsActivityLocation</a></li>
                                <li><a href="../classes/SportsClub.html">SportsClub</a></li>
                                <li><a href="../classes/SportsEvent.html">SportsEvent</a></li>
                                <li><a href="../classes/SportsOrganization.html">SportsOrganization</a></li>
                                <li><a href="../classes/SportsTeam.html">SportsTeam</a></li>
                                <li><a href="../classes/SpreadsheetDigitalDocument.html">SpreadsheetDigitalDocument</a></li>
                                <li><a href="../classes/StadiumOrArena.html">StadiumOrArena</a></li>
                                <li><a href="../classes/State.html">State</a></li>
                                <li><a href="../classes/SteeringPositionValue.html">SteeringPositionValue</a></li>
                                <li><a href="../classes/Store.html">Store</a></li>
                                <li><a href="../classes/StructuredValue.html">StructuredValue</a></li>
                                <li><a href="../classes/SubscribeAction.html">SubscribeAction</a></li>
                                <li><a href="../classes/SubwayStation.html">SubwayStation</a></li>
                                <li><a href="../classes/Suite.html">Suite</a></li>
                                <li><a href="../classes/SuspendAction.html">SuspendAction</a></li>
                                <li><a href="../classes/Synagogue.html">Synagogue</a></li>
                                <li><a href="../classes/Table.html">Table</a></li>
                                <li><a href="../classes/TakeAction.html">TakeAction</a></li>
                                <li><a href="../classes/Task.html">Task</a></li>
                                <li><a href="../classes/TaskProfile.html">TaskProfile</a></li>
                                <li><a href="../classes/TattooParlor.html">TattooParlor</a></li>
                                <li><a href="../classes/Taxi.html">Taxi</a></li>
                                <li><a href="../classes/TaxiReservation.html">TaxiReservation</a></li>
                                <li><a href="../classes/TaxiService.html">TaxiService</a></li>
                                <li><a href="../classes/TaxiStand.html">TaxiStand</a></li>
                                <li><a href="../classes/TechArticle.html">TechArticle</a></li>
                                <li><a href="../classes/TelevisionChannel.html">TelevisionChannel</a></li>
                                <li><a href="../classes/TelevisionStation.html">TelevisionStation</a></li>
                                <li><a href="../classes/TennisComplex.html">TennisComplex</a></li>
                                <li><a href="../classes/TextDigitalDocument.html">TextDigitalDocument</a></li>
                                <li><a href="../classes/TheaterEvent.html">TheaterEvent</a></li>
                                <li><a href="../classes/TheaterGroup.html">TheaterGroup</a></li>
                                <li><a href="../classes/Thing.html">Thing</a></li>
                                <li><a href="../classes/Ticket.html">Ticket</a></li>
                                <li><a href="../classes/TieAction.html">TieAction</a></li>
                                <li><a href="../classes/TipAction.html">TipAction</a></li>
                                <li><a href="../classes/TireShop.html">TireShop</a></li>
                                <li><a href="../classes/TouristAttraction.html">TouristAttraction</a></li>
                                <li><a href="../classes/TouristInformationCenter.html">TouristInformationCenter</a></li>
                                <li><a href="../classes/ToyStore.html">ToyStore</a></li>
                                <li><a href="../classes/TrackAction.html">TrackAction</a></li>
                                <li><a href="../classes/TradeAction.html">TradeAction</a></li>
                                <li><a href="../classes/TrainReservation.html">TrainReservation</a></li>
                                <li><a href="../classes/TrainStation.html">TrainStation</a></li>
                                <li><a href="../classes/TrainTrip.html">TrainTrip</a></li>
                                <li><a href="../classes/TransferAction.html">TransferAction</a></li>
                                <li><a href="../classes/TravelAction.html">TravelAction</a></li>
                                <li><a href="../classes/TravelAgency.html">TravelAgency</a></li>
                                <li><a href="../classes/Triple.html">Triple</a></li>
                                <li><a href="../classes/TVClip.html">TVClip</a></li>
                                <li><a href="../classes/TVEpisode.html">TVEpisode</a></li>
                                <li><a href="../classes/TVSeason.html">TVSeason</a></li>
                                <li><a href="../classes/TVSeries.html">TVSeries</a></li>
                                <li><a href="../classes/TypeAndQuantityNode.html">TypeAndQuantityNode</a></li>
                                <li><a href="../classes/UnitPriceSpecification.html">UnitPriceSpecification</a></li>
                                <li><a href="../classes/UnRegisterAction.html">UnRegisterAction</a></li>
                                <li><a href="../classes/UpdateAction.html">UpdateAction</a></li>
                                <li><a href="../classes/UseAction.html">UseAction</a></li>
                                <li><a href="../classes/UserBlocks.html">UserBlocks</a></li>
                                <li><a href="../classes/UserCheckins.html">UserCheckins</a></li>
                                <li><a href="../classes/UserComments.html">UserComments</a></li>
                                <li><a href="../classes/UserDownloads.html">UserDownloads</a></li>
                                <li><a href="../classes/UserInteraction.html">UserInteraction</a></li>
                                <li><a href="../classes/UserLikes.html">UserLikes</a></li>
                                <li><a href="../classes/UserPageVisits.html">UserPageVisits</a></li>
                                <li><a href="../classes/UserPlays.html">UserPlays</a></li>
                                <li><a href="../classes/UserPlusOnes.html">UserPlusOnes</a></li>
                                <li><a href="../classes/UserTweets.html">UserTweets</a></li>
                                <li><a href="../classes/Vehicle.html">Vehicle</a></li>
                                <li><a href="../classes/VerificationServiceProfile.html">VerificationServiceProfile</a></li>
                                <li><a href="../classes/VideoGallery.html">VideoGallery</a></li>
                                <li><a href="../classes/VideoGame.html">VideoGame</a></li>
                                <li><a href="../classes/VideoGameClip.html">VideoGameClip</a></li>
                                <li><a href="../classes/VideoGameSeries.html">VideoGameSeries</a></li>
                                <li><a href="../classes/VideoObject.html">VideoObject</a></li>
                                <li><a href="../classes/ViewAction.html">ViewAction</a></li>
                                <li><a href="../classes/ViewManager.html">ViewManager</a></li>
                                <li><a href="../classes/VisualArtsEvent.html">VisualArtsEvent</a></li>
                                <li><a href="../classes/VisualArtwork.html">VisualArtwork</a></li>
                                <li><a href="../classes/Volcano.html">Volcano</a></li>
                                <li><a href="../classes/VoteAction.html">VoteAction</a></li>
                                <li><a href="../classes/WantAction.html">WantAction</a></li>
                                <li><a href="../classes/WarrantyPromise.html">WarrantyPromise</a></li>
                                <li><a href="../classes/WarrantyScope.html">WarrantyScope</a></li>
                                <li><a href="../classes/WatchAction.html">WatchAction</a></li>
                                <li><a href="../classes/Waterfall.html">Waterfall</a></li>
                                <li><a href="../classes/WearAction.html">WearAction</a></li>
                                <li><a href="../classes/WebApplication.html">WebApplication</a></li>
                                <li><a href="../classes/WebPage.html">WebPage</a></li>
                                <li><a href="../classes/WebPageElement.html">WebPageElement</a></li>
                                <li><a href="../classes/WebSite.html">WebSite</a></li>
                                <li><a href="../classes/WholesaleStore.html">WholesaleStore</a></li>
                                <li><a href="../classes/WinAction.html">WinAction</a></li>
                                <li><a href="../classes/Winery.html">Winery</a></li>
                                <li><a href="../classes/WPAdBlock.html">WPAdBlock</a></li>
                                <li><a href="../classes/WPFooter.html">WPFooter</a></li>
                                <li><a href="../classes/WPHeader.html">WPHeader</a></li>
                                <li><a href="../classes/WPSideBar.html">WPSideBar</a></li>
                                <li><a href="../classes/WriteAction.html">WriteAction</a></li>
                                <li><a href="../classes/XapiConfig.html">XapiConfig</a></li>
                                <li><a href="../classes/Zoo.html">Zoo</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/com.eduworks.ec.html">com.eduworks.ec</a></li>
                                <li><a href="../modules/com.eduworks.ec.ui.html">com.eduworks.ec.ui</a></li>
                                <li><a href="../modules/org.cassproject.html">org.cassproject</a></li>
                                <li><a href="../modules/org.credentialengine.html">org.credentialengine</a></li>
                                <li><a href="../modules/org.json.ld.html">org.json.ld</a></li>
                                <li><a href="../modules/org.schema.html">org.schema</a></li>
                                <li><a href="../modules/org.w3.skos.html">org.w3.skos</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/main/js/cass/cass.rollup.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*-
 * --BEGIN_LICENSE--
 * Competency and Skills System
 * -----
 * Copyright (C) 2015 - 2019 Eduworks Corporation and other contributing parties.
 * -----
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * --END_LICENSE--
 */
/**
 *  Created by fray on 5/30/17.
 */
var AssertionCoprocessor = function() {};
AssertionCoprocessor = stjs.extend(AssertionCoprocessor, null, [], function(constructor, prototype) {
    prototype.assertionProcessor = null;
    prototype.collectAssertions = function(ip, listOfCompetencies, success) {
        success(new Array());
    };
    prototype.mutateAssertions = function(ip, listOfCompetencies, success) {
        success();
    };
}, {assertionProcessor: &quot;AssertionProcessor&quot;}, {});
/**
 *  Data structure used to hold data relevant to a request to determine the competence of an individual.
 *  (hereafter, &quot;Inquiry&quot;)
 * 
 *  @author fritz.ray@eduworks.com
 *  @author tom.buskirk@eduworks.com
 *  @class InquiryPacket
 *  @module org.cassproject
 */
var InquiryPacket = /**
 *  Create an InquiryPacket.
 * 
 *  @param {EcPk[]}                  subject Public keys of the individual to retreive assertions about.
 *  @param {EcCompetency}            competency Competency that the inquiry is made about.
 *  @param {EcLevel}                 level Level of the competency.
 *  @param {EcFramework}             context Framework to provide boundaries for the inquiry within.
 *  @param {function(InquiryPacket)} success Method to call when a result has been reached.
 *  @param {function(string)}        failure Method to call if the inquiry fails.
 *  @param {string}                  rule For rollup rules, this is a search used to populate this inquiry packet.
 *  @param {IPType}                  type The type of this inquiry packet. May be competency, rollup rule, or relation.
 *  @constructor
 */
function(subject, competency, level, context, success, failure, rule, type) {
    this.positive = new Array();
    this.negative = new Array();
    this.equivalentPackets = new Array();
    this.subPackets = new Array();
    this.dateCreated = new Date().getTime();
    this.subject = subject;
    this.competency = new Array();
    if (competency != null) 
        this.competency.push(competency);
    this.level = new Array();
    if (level != null) 
        this.level.push(level);
    this.context = context;
    this.success = success;
    this.failure = failure;
    this.rule = rule;
    this.type = type;
    this.result = null;
    this.log = &quot;&quot;;
};
InquiryPacket = stjs.extend(InquiryPacket, null, [], function(constructor, prototype) {
    prototype.root = false;
    /**
     *  One or more identifiers that identify an individual.
     * 
     *  @property subject
     *  @type EcPk[]
     */
    prototype.subject = null;
    /**
     *  Competency that this packet is inquiring about.
     *  May be multiple competencies that are either collapsed due to an inference loop, or are equivalent to one another.
     * 
     *  @property competency
     *  @type EcCompetency[]
     */
    prototype.competency = null;
    /**
     *  Framework that this inquiry is scoped to.
     * 
     *  @property context
     *  @type EcFramework
     */
    prototype.context = null;
    /**
     *  Callback when this and all child inquiries have successfully reached a conclusion.
     * 
     *  @property success
     *  @type function(InquiryPacket)
     */
    prototype.success = null;
    /**
     *  Callback if this inquiry requires additional information to proceed.
     * 
     *  @property ask
     *  @type string function(string)
     */
    prototype.ask = null;
    /**
     *  Callback if this inquiry fails.
     * 
     *  @property failure
     *  @type function(string)
     */
    prototype.failure = null;
    /**
     *  Level that the competency is being measured at.
     *  May have multiple levels referring to multiple competencies due to cycles or equivalence.
     * 
     *  @property level
     *  @type EcLevel[]
     */
    prototype.level = null;
    /**
     *  Packets that are equivalent to this packet. May be used when equivalence is best represented with additional packets.
     * 
     *  @property equivalentPackets
     *  @type InquiryPacket[]
     */
    prototype.equivalentPackets = null;
    /**
     *  Packets that assist in determining the state of this packet.
     * 
     *  @property subPackets
     *  @type InquiryPacket[]
     */
    prototype.subPackets = null;
    /**
     *  Datetime representing when this packet was created.
     * 
     *  @property dateCreated
     *  @internal
     *  @type number
     */
    prototype.dateCreated = 0.0;
    /**
     *  Mark true when assertions have been retrieved for this packet.
     * 
     *  @property hasCheckedAssertionsForCompetency
     *  @type boolean
     */
    prototype.hasCheckedAssertionsForCompetency = false;
    /**
     *  Mark true when rollup rules have been processed for this packet.
     * 
     *  @property hasCheckedRollupRulesForCompetency
     *  @type boolean
     */
    prototype.hasCheckedRollupRulesForCompetency = false;
    /**
     *  Mark true when relations have been processed for this packet.
     * 
     *  @property hasCheckedRelationshipsForCompetency
     *  @type boolean
     */
    prototype.hasCheckedRelationshipsForCompetency = false;
    /**
     *  Async counter to keep track of number of unresolved processes.
     * 
     *  @property numberOfQueriesRunning
     *  @type integer
     */
    prototype.numberOfQueriesRunning = 0;
    /**
     *  Local log for this inquiry packet.
     * 
     *  @property log
     *  @type string
     */
    prototype.log = null;
    /**
     *  Assertions (direct or indirect) that contribute to a positive result.
     * 
     *  @property positive
     *  @type EcAssertion[]
     */
    prototype.positive = null;
    /**
     *  Assertions (direct or indirect) that contribute to a negative result.
     * 
     *  @property negative
     *  @type EcAssertion[]
     */
    prototype.negative = null;
    /**
     *  Set to true if this packet has completed processing.
     * 
     *  @property finished
     *  @type boolean
     */
    prototype.finished = false;
    /**
     *  Set to true if this packet has finished stage one.
     * 
     *  @property stageOneFinished
     *  @type boolean
     */
    prototype.stageOneComplete = false;
    /**
     *  Type of inquiry packet. Inquiry packets can represent relational logic, rollup logic or competencies.
     * 
     *  @property type
     *  @type IPType
     */
    prototype.type = null;
    /**
     *  Rollup Rule search string. (if IPType == ROLLUPRULE)
     * 
     *  @property rule
     *  @type string
     */
    prototype.rule = null;
    /**
     *  Result as a ResultType. ResultType is an autogenerated Enum object, and result._name may match &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;UNKNOWN&quot;, &quot;INDETERMINANT&quot;
     * 
     *  @property result
     *  @type ResultType
     */
    prototype.result = null;
    prototype.getContext = function() {
        return this.context;
    };
    /**
     *  Returns true if any child packets have an indeterminate result.
     * 
     *  @return {boolean}
     *  @method anyIndeterminantChildPackets
     */
    prototype.anyIndeterminantChildPackets = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.INDETERMINANT.equals(this.equivalentPackets[i].result)) 
                return true;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.INDETERMINANT.equals(this.subPackets[i].result)) 
                return true;
        }
        return false;
    };
    /**
     *  Returns true if all child packets have unknown results.
     * 
     *  @return {boolean}
     *  @method allChildPacketsUnknown
     */
    prototype.allChildPacketsUnknown = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (!InquiryPacket.ResultType.UNKNOWN.equals(this.equivalentPackets[i].result)) 
                return false;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (!InquiryPacket.ResultType.UNKNOWN.equals(this.subPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if all child packets have unknown results.
     * 
     *  @return {boolean}
     *  @method allChildPacketsUnknown
     */
    prototype.allChildPacketsAreTrue = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (!InquiryPacket.ResultType.TRUE.equals(this.equivalentPackets[i].result)) 
                return false;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (!InquiryPacket.ResultType.TRUE.equals(this.subPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if any child packets have false results.
     * 
     *  @return {boolean}
     *  @method anyChildPacketsAreFalse
     */
    prototype.anyChildPacketsAreFalse = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.FALSE.equals(this.equivalentPackets[i].result)) 
                return true;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.FALSE.equals(this.subPackets[i].result)) 
                return true;
        }
        return false;
    };
    /**
     *  Returns true if any child packets have unknown results.
     * 
     *  @return {boolean}
     *  @method anyChildPacketsAreUnknown
     */
    prototype.anyChildPacketsAreUnknown = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.UNKNOWN.equals(this.equivalentPackets[i].result)) 
                return true;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.UNKNOWN.equals(this.subPackets[i].result)) 
                return true;
        }
        return false;
    };
    /**
     *  Returns true if any child packets have true results.
     * 
     *  @return {boolean}
     *  @method anyChildPacketsAreTrue
     */
    prototype.anyChildPacketsAreTrue = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.TRUE.equals(this.equivalentPackets[i].result)) 
                return true;
        }
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.TRUE.equals(this.subPackets[i].result)) 
                return true;
        }
        return false;
    };
    /**
     *  Returns true if all equivalent packets have unknown results.
     * 
     *  @return {boolean}
     *  @method allEquivalentPacketsUnknown
     */
    prototype.allEquivalentPacketsUnknown = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (!InquiryPacket.ResultType.UNKNOWN.equals(this.equivalentPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if all equivalent packets have the true or unknown result.
     * 
     *  @return {boolean}
     *  @method allEquivalentPacketsTrueOrUnknown
     */
    prototype.allEquivalentPacketsTrueOrUnknown = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.FALSE.equals(this.equivalentPackets[i].result) || InquiryPacket.ResultType.INDETERMINANT.equals(this.equivalentPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if all sub packets have the true or unknown result.
     * 
     *  @return {boolean}
     *  @method allSubPacketsTrueOrUnknown
     */
    prototype.allSubPacketsTrueOrUnknown = function() {
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.FALSE.equals(this.subPackets[i].result) || InquiryPacket.ResultType.INDETERMINANT.equals(this.subPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if all equivalent packets have the false or unknown result.
     * 
     *  @return {boolean}
     *  @method allEquivalentPacketsFalseOrUnknown
     */
    prototype.allEquivalentPacketsFalseOrUnknown = function() {
        for (var i = 0; i &lt; this.equivalentPackets.length; i++) {
            if (InquiryPacket.ResultType.TRUE.equals(this.equivalentPackets[i].result) || InquiryPacket.ResultType.INDETERMINANT.equals(this.equivalentPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if all sub packets have the false or unknown result.
     * 
     *  @return
     */
    prototype.allSubPacketsFalseOrUnknown = function() {
        for (var i = 0; i &lt; this.subPackets.length; i++) {
            if (InquiryPacket.ResultType.TRUE.equals(this.subPackets[i].result) || InquiryPacket.ResultType.INDETERMINANT.equals(this.subPackets[i].result)) 
                return false;
        }
        return true;
    };
    /**
     *  Returns true if the provided ID represents a competency in this packet.
     * 
     *  @param competencyId
     *  @return
     */
    prototype.hasId = function(competencyId) {
        for (var i = 0; i &lt; this.competency.length; i++) 
            if (this.competency[i].isId(competencyId)) 
                return true;
        return false;
    };
    constructor.IPType = stjs.enumeration(&quot;COMPETENCY&quot;, &quot;ROLLUPRULE&quot;, &quot;RELATION_AND&quot;, &quot;RELATION_OR&quot;, &quot;RELATION_NARROWS&quot;, &quot;RELATION_BROADENS&quot;, &quot;RELATION_REQUIRES&quot;, &quot;RELATION_ISREQUIREDBY&quot;);
    constructor.ResultType = stjs.enumeration(&quot;TRUE&quot;, &quot;FALSE&quot;, &quot;UNKNOWN&quot;, &quot;INDETERMINANT&quot;);
}, {subject: {name: &quot;Array&quot;, arguments: [&quot;EcPk&quot;]}, competency: {name: &quot;Array&quot;, arguments: [&quot;EcCompetency&quot;]}, context: &quot;EcFramework&quot;, success: {name: &quot;Callback1&quot;, arguments: [&quot;InquiryPacket&quot;]}, ask: {name: &quot;Function1&quot;, arguments: [null, null]}, failure: {name: &quot;Callback1&quot;, arguments: [null]}, level: {name: &quot;Array&quot;, arguments: [&quot;EcLevel&quot;]}, equivalentPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, subPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, positive: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, negative: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, type: {name: &quot;Enum&quot;, arguments: [&quot;InquiryPacket.IPType&quot;]}, result: {name: &quot;Enum&quot;, arguments: [&quot;InquiryPacket.ResultType&quot;]}}, {});
var EcGraphUtil = function() {};
EcGraphUtil = stjs.extend(EcGraphUtil, null, [], function(constructor, prototype) {
    constructor.buildIdSearchQueryForIdList = function(idList) {
        var searchQuery = &quot;&quot;;
        if (idList.length &gt; 1) 
            searchQuery = &quot;(&quot;;
        for (var i = 0; i &lt; idList.length; i++) {
            if (i &gt; 0) 
                searchQuery += &quot; OR &quot;;
            searchQuery += &quot;(\\*@id:\&quot;&quot; + idList[i] + &quot;\&quot;)&quot;;
        }
        if (idList.length &gt; 1) 
            searchQuery += &quot;)&quot;;
        return searchQuery;
    };
}, {}, {});
var NodePacket = function() {
    this.nodeList = new Array();
    this.nodeMap = {};
};
NodePacket = stjs.extend(NodePacket, null, [], function(constructor, prototype) {
    prototype.nodeList = null;
    prototype.nodeMap = null;
    prototype.getNodeList = function() {
        return this.nodeList;
    };
    prototype.setNodeList = function(nodeList) {
        this.nodeList = nodeList;
    };
    prototype.getNodeCount = function() {
        return this.nodeList.length;
    };
    prototype.addNode = function(n) {
        if (this.nodeMap[n.getId()] == null) {
            this.nodeList.push(n);
            this.nodeMap[n.getId()] = n;
        }
    };
    prototype.toString = function() {
        var ret = &quot;&quot;;
        ret = ret + &quot;NodePacket: (&quot;;
        for (var i = 0; i &lt; this.nodeList.length; i++) {
            if ((i + 1) &lt; this.nodeList.length) 
                ret = ret + this.nodeList[i].toString() + &quot;, &quot;;
             else 
                ret = ret + this.nodeList[i].toString();
        }
        ret = ret + &quot;)&quot;;
        return ret;
    };
}, {nodeList: {name: &quot;Array&quot;, arguments: [&quot;Node&quot;]}, nodeMap: {name: &quot;Map&quot;, arguments: [null, &quot;Node&quot;]}}, {});
var Node = function(nameId) {
    this.name = nameId;
    this.id = nameId;
};
Node = stjs.extend(Node, null, [], function(constructor, prototype) {
    prototype.name = null;
    prototype.id = null;
    prototype.description = null;
    prototype.getName = function() {
        return this.name;
    };
    prototype.setName = function(name) {
        this.name = name;
    };
    prototype.getId = function() {
        return this.id;
    };
    prototype.setId = function(id) {
        this.id = id;
    };
    prototype.getDescription = function() {
        return this.description;
    };
    prototype.setDescription = function(description) {
        this.description = description;
    };
    prototype.toString = function() {
        return &quot;Node: \&quot;&quot; + this.id + &quot;\&quot;&quot;;
    };
}, {}, {});
var PapDependencyParms = function() {};
PapDependencyParms = stjs.extend(PapDependencyParms, null, [], function(constructor, prototype) {
    prototype.parentIndex = null;
    prototype.childIndex = null;
    prototype.type = null;
    prototype.weight = null;
    prototype.leak = null;
    prototype.dependencyFirst = false;
    prototype.reverse = false;
    prototype.getParentIndex = function() {
        return this.parentIndex;
    };
    prototype.setParentIndex = function(parentIndex) {
        this.parentIndex = parentIndex;
    };
    prototype.getChildIndex = function() {
        return this.childIndex;
    };
    prototype.setChildIndex = function(childIndex) {
        this.childIndex = childIndex;
    };
    prototype.getType = function() {
        return this.type;
    };
    prototype.setType = function(type) {
        this.type = type;
    };
    prototype.getWeight = function() {
        return this.weight;
    };
    prototype.setWeight = function(weight) {
        this.weight = weight;
    };
    prototype.getLeak = function() {
        return this.leak;
    };
    prototype.setLeak = function(leak) {
        this.leak = leak;
    };
    prototype.getDependencyFirst = function() {
        return this.dependencyFirst;
    };
    prototype.setDependencyFirst = function(dependencyFirst) {
        this.dependencyFirst = dependencyFirst;
    };
    prototype.getReverse = function() {
        return this.reverse;
    };
    prototype.setReverse = function(reverse) {
        this.reverse = reverse;
    };
    prototype.swapParentChildIndexes = function() {
        var temp = this.parentIndex;
        this.parentIndex = this.childIndex;
        this.childIndex = temp;
    };
}, {}, {});
var PapUpdate = function(index, change, positive) {
    this.index = index;
    this.change = change;
    this.visited = new Array();
    this.positive = positive;
};
PapUpdate = stjs.extend(PapUpdate, null, [], function(constructor, prototype) {
    prototype.index = 0;
    prototype.visited = null;
    prototype.change = 0.0;
    prototype.positive = false;
    prototype.hasVisited = function(index) {
        for (var i = 0; i &lt; this.visited.length; i++) {
            if (this.visited[i].intValue() == index) 
                return true;
        }
        return false;
    };
    prototype.updateChild = function(index, change) {
        var res = new PapUpdate(index, change, this.positive);
        res.setVisited(this.cloneVisited());
        res.getVisited().push(index);
        return res;
    };
    prototype.toString = function() {
        var sign = this.positive ? &quot;+&quot; : &quot;-&quot;;
        return &quot;&lt;update &quot; + this.index + &quot; | &quot; + sign + this.change + &quot;&gt;&quot;;
    };
    prototype.compare = function(other) {
        var diff = this.change - other.getChange();
        if (diff &lt; 0) 
            return 1;
        if (diff &gt; 0) 
            return -1;
        return 0;
    };
    prototype.cloneVisited = function() {
        var newVis = new Array();
        for (var i = 0; i &lt; this.visited.length; i++) {
            newVis.push(this.visited[i]);
        }
        return newVis;
    };
    prototype.getIndex = function() {
        return this.index;
    };
    prototype.setIndex = function(index) {
        this.index = index;
    };
    prototype.getVisited = function() {
        return this.visited;
    };
    prototype.setVisited = function(visited) {
        this.visited = visited;
    };
    prototype.getChange = function() {
        return this.change;
    };
    prototype.setChange = function(change) {
        this.change = change;
    };
    prototype.getPositive = function() {
        return this.positive;
    };
    prototype.setPositive = function(positive) {
        this.positive = positive;
    };
}, {visited: {name: &quot;Array&quot;, arguments: [null]}}, {});
var RelationType = function() {};
RelationType = stjs.extend(RelationType, null, [], function(constructor, prototype) {
    constructor.RELATION_TYPE = stjs.enumeration(&quot;IS_EQUIVALENT_TO&quot;, &quot;NARROWS&quot;, &quot;BROADENS&quot;, &quot;REQUIRES&quot;, &quot;IS_REQUIRED_BY&quot;);
}, {}, {});
var SimpleAssertion = function(id, competencyId, confidence) {
    this.id = id;
    this.competencyId = competencyId;
    this.confidence = confidence;
};
SimpleAssertion = stjs.extend(SimpleAssertion, null, [], function(constructor, prototype) {
    prototype.id = null;
    prototype.subjectPem = null;
    prototype.competencyId = null;
    prototype.confidence = null;
    prototype.assertionDate = null;
    prototype.expirationDate = null;
    prototype.negative = null;
    prototype.getId = function() {
        return this.id;
    };
    prototype.setId = function(id) {
        this.id = id;
    };
    prototype.getSubjectPem = function() {
        return this.subjectPem;
    };
    prototype.setSubjectPem = function(subjectPem) {
        this.subjectPem = subjectPem;
    };
    prototype.getCompetencyId = function() {
        return this.competencyId;
    };
    prototype.setCompetencyId = function(competencyId) {
        this.competencyId = competencyId;
    };
    prototype.getConfidence = function() {
        return this.confidence;
    };
    prototype.setConfidence = function(confidence) {
        this.confidence = confidence;
    };
    prototype.getAssertionDate = function() {
        return this.assertionDate;
    };
    prototype.setAssertionDate = function(assertionDate) {
        this.assertionDate = assertionDate;
    };
    prototype.getExpirationDate = function() {
        return this.expirationDate;
    };
    prototype.setExpirationDate = function(expirationDate) {
        this.expirationDate = expirationDate;
    };
    prototype.isNegative = function() {
        return this.negative;
    };
    prototype.setNegative = function(negative) {
        this.negative = negative;
    };
}, {}, {});
var ExceptionReturn = function(errorMessage) {
    this.errorMessage = errorMessage;
};
ExceptionReturn = stjs.extend(ExceptionReturn, null, [], function(constructor, prototype) {
    prototype.errorMessage = null;
    prototype.getErrorMessage = function() {
        return this.errorMessage;
    };
    prototype.setErrorMessage = function(errorMessage) {
        this.errorMessage = errorMessage;
    };
    prototype.getJsonString = function() {
        return JSON.stringify(this);
    };
}, {}, {});
var RrQuery = function() {};
RrQuery = stjs.extend(RrQuery, null, [], function(constructor, prototype) {
    prototype.query = null;
}, {}, {});
var PapCompetencyPrediction = function() {};
PapCompetencyPrediction = stjs.extend(PapCompetencyPrediction, null, [], function(constructor, prototype) {
    prototype.competencyId = null;
    prototype.confidence = 0.0;
    prototype.conflictLevel = 0.0;
    prototype.conflictClass = null;
    prototype.getCompetencyId = function() {
        return this.competencyId;
    };
    prototype.setCompetencyId = function(competencyId) {
        this.competencyId = competencyId;
    };
    prototype.getConfidence = function() {
        return this.confidence;
    };
    prototype.setConfidence = function(confidence) {
        this.confidence = confidence;
    };
    prototype.getConflictLevel = function() {
        return this.conflictLevel;
    };
    prototype.setConflictLevel = function(conflictLevel) {
        this.conflictLevel = conflictLevel;
    };
    prototype.getConflictClass = function() {
        return this.conflictClass;
    };
    prototype.setConflictClass = function(conflictClass) {
        this.conflictClass = conflictClass;
    };
}, {}, {});
var RrS = function() {
    this.token = new Array();
    this.query = new Array();
};
RrS = stjs.extend(RrS, null, [], function(constructor, prototype) {
    prototype.token = null;
    prototype.query = null;
    prototype.addToken = function(rrToken) {
        this.token.push(rrToken);
    };
    prototype.addQuery = function(rrQuery) {
        this.query.push(rrQuery);
    };
}, {token: {name: &quot;Array&quot;, arguments: [&quot;RrToken&quot;]}, query: {name: &quot;Array&quot;, arguments: [&quot;RrQuery&quot;]}}, {});
var RrToken = function() {};
RrToken = stjs.extend(RrToken, null, [], function(constructor, prototype) {
    prototype.number = null;
    prototype.bool = null;
}, {}, {});
var NodeRelationMap = function() {
    this.nodeList = new Array();
    this.relationMap = {};
};
NodeRelationMap = stjs.extend(NodeRelationMap, null, [], function(constructor, prototype) {
    prototype.nodeList = null;
    prototype.relationMap = null;
    prototype.addNodeRelations = function(n, rm) {
        this.nodeList.push(n);
        this.relationMap[n.getId()] = rm;
    };
    prototype.getRelationsForNode = function(n) {
        return this.relationMap[n.getId()];
    };
    prototype.getNodeList = function() {
        return this.nodeList;
    };
    prototype.setNodeList = function(nodeList) {
        this.nodeList = nodeList;
    };
    prototype.getRelationMap = function() {
        return this.relationMap;
    };
    prototype.setRelationMap = function(relationMap) {
        this.relationMap = relationMap;
    };
    prototype.toString = function() {
        var ret = &quot;&quot;;
        var n;
        var nra;
        for (var i = 0; i &lt; this.nodeList.length; i++) {
            n = this.nodeList[i];
            ret = ret + n.toString() + &quot;\n&quot;;
            nra = this.relationMap[n.getId()];
            for (var j = 0; j &lt; nra.length; j++) {
                ret = ret + &quot;\t&quot; + nra[j].toString() + &quot;\n&quot;;
            }
        }
        return ret;
    };
}, {nodeList: {name: &quot;Array&quot;, arguments: [&quot;Node&quot;]}, relationMap: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;NodeRelation&quot;]}]}}, {});
var NodeRelation = function(source, target, type) {
    this.source = source;
    this.target = target;
    this.type = type;
};
NodeRelation = stjs.extend(NodeRelation, null, [], function(constructor, prototype) {
    prototype.type = null;
    prototype.source = null;
    prototype.target = null;
    prototype.getSource = function() {
        return this.source;
    };
    prototype.setSource = function(source) {
        this.source = source;
    };
    prototype.getTarget = function() {
        return this.target;
    };
    prototype.setTarget = function(target) {
        this.target = target;
    };
    prototype.getType = function() {
        return this.type;
    };
    prototype.setType = function(type) {
        this.type = type;
    };
    prototype.toString = function() {
        return this.getSource().toString() + &quot; &gt;&gt;&quot; + this.getType() + &quot;&lt;&lt; &quot; + this.getTarget().toString();
    };
}, {type: {name: &quot;Enum&quot;, arguments: [&quot;RelationType.RELATION_TYPE&quot;]}, source: &quot;Node&quot;, target: &quot;Node&quot;}, {});
var CgEdge = function(source, target, relation) {
    this.source = source;
    this.target = target;
    this.relation = relation;
};
CgEdge = stjs.extend(CgEdge, null, [], function(constructor, prototype) {
    prototype.source = null;
    prototype.target = null;
    prototype.relation = null;
    prototype.getSource = function() {
        return this.source;
    };
    prototype.setSource = function(source) {
        this.source = source;
    };
    prototype.getTarget = function() {
        return this.target;
    };
    prototype.setTarget = function(target) {
        this.target = target;
    };
    prototype.getRelation = function() {
        return this.relation;
    };
    prototype.setRelation = function(relation) {
        this.relation = relation;
    };
}, {}, {});
var PapDependencyDefinitionBase = function(depClass, reverse, weight, leak) {
    this.depClass = depClass;
    this.reverse = reverse;
    this.weight = weight;
    this.leak = leak;
};
PapDependencyDefinitionBase = stjs.extend(PapDependencyDefinitionBase, null, [], function(constructor, prototype) {
    prototype.depClass = null;
    prototype.reverse = false;
    prototype.weight = null;
    prototype.leak = null;
    prototype.getDepClass = function() {
        return this.depClass;
    };
    prototype.setDepClass = function(depClass) {
        this.depClass = depClass;
    };
    prototype.getReverse = function() {
        return this.reverse;
    };
    prototype.setReverse = function(reverse) {
        this.reverse = reverse;
    };
    prototype.getWeight = function() {
        return this.weight;
    };
    prototype.setWeight = function(weight) {
        this.weight = weight;
    };
    prototype.getLeak = function() {
        return this.leak;
    };
    prototype.setLeak = function(leak) {
        this.leak = leak;
    };
}, {}, {});
var ArrayUtil = function() {};
ArrayUtil = stjs.extend(ArrayUtil, null, [], function(constructor, prototype) {
    constructor.arrayContains = function(a, o) {
        for (var i = 0; i &lt; a.length; i++) {
            if (a[i] == o) 
                return true;
        }
        return false;
    };
    constructor.arrayRemove = function(a, o) {
        var retArray = new Array();
        for (var i = 0; i &lt; a.length; i++) {
            if (a[i] != o) 
                retArray.push(a[i]);
        }
        return retArray;
    };
    constructor.arrayLastIndexOf = function(a, o) {
        for (var i = (a.length - 1); i &gt;= 0; i--) {
            if (a[i] == o) 
                return i;
        }
        return -1;
    };
    constructor.arrayToString = function(a) {
        if (a == null || a.length == 0) 
            return &quot;&lt;Emtpy&gt;&quot;;
        var ret = &quot;&quot;;
        for (var i = 0; i &lt; a.length; i++) {
            if ((i + 1) &lt; a.length) 
                ret = ret + a[i].toString() + &quot;, &quot;;
             else 
                ret = ret + a[i].toString();
        }
        return ret;
    };
}, {}, {});
var PacketRelation = function(source, target, type) {
    this.source = source;
    this.target = target;
    this.type = type;
};
PacketRelation = stjs.extend(PacketRelation, null, [], function(constructor, prototype) {
    prototype.type = null;
    prototype.source = null;
    prototype.target = null;
    prototype.getSource = function() {
        return this.source;
    };
    prototype.setSource = function(source) {
        this.source = source;
    };
    prototype.getTarget = function() {
        return this.target;
    };
    prototype.setTarget = function(target) {
        this.target = target;
    };
    prototype.getType = function() {
        return this.type;
    };
    prototype.setType = function(type) {
        this.type = type;
    };
    prototype.toString = function() {
        return this.getSource().toString() + &quot; &gt;&gt;&quot; + this.getType() + &quot;&lt;&lt; &quot; + this.getTarget().toString();
    };
}, {type: {name: &quot;Enum&quot;, arguments: [&quot;RelationType.RELATION_TYPE&quot;]}, source: &quot;NodePacket&quot;, target: &quot;NodePacket&quot;}, {});
var PapSettings = function() {
    this.iterations = PapSettings.DEFAULT_ITERATIONS;
    this.abruptExpiration = PapSettings.DEFAULT_ABRUPT_EXP;
    this.gradualForgetting = PapSettings.DEFAULT_GRAD_FORGETTING;
    this.evidenceWeight = PapSettings.DEFAULT_EVIDENCE_WEIGHT;
    this.discount = PapSettings.DEFAULT_DISCOUNT;
    this.priorityQueueThreshold = PapSettings.DEFAULT_PRIORITY_QUEUE_THRESHOLD;
    this.betaPrecision = PapSettings.DEFAULT_BETA_PRECISION;
    this.betaMean = PapSettings.DEFAULT_BETA_MEAN;
};
PapSettings = stjs.extend(PapSettings, null, [], function(constructor, prototype) {
    constructor.DEFAULT_ITERATIONS = 200;
    constructor.DEFAULT_ABRUPT_EXP = false;
    constructor.DEFAULT_GRAD_FORGETTING = true;
    constructor.DEFAULT_EVIDENCE_WEIGHT = 1.0;
    constructor.DEFAULT_DISCOUNT = 1.0;
    constructor.DEFAULT_PRIORITY_QUEUE_THRESHOLD = 0.01;
    constructor.DEFAULT_BETA_PRECISION = 0.1;
    constructor.DEFAULT_BETA_MEAN = 0.2;
    prototype.iterations = null;
    prototype.abruptExpiration = false;
    prototype.gradualForgetting = false;
    prototype.evidenceWeight = null;
    prototype.discount = null;
    prototype.priorityQueueThreshold = null;
    prototype.betaPrecision = null;
    prototype.betaMean = null;
    prototype.getIterations = function() {
        return this.iterations;
    };
    prototype.setIterations = function(iterations) {
        this.iterations = iterations;
    };
    prototype.getAbruptExpiration = function() {
        return this.abruptExpiration;
    };
    prototype.setAbruptExpiration = function(abruptExpiration) {
        this.abruptExpiration = abruptExpiration;
    };
    prototype.getGradualForgetting = function() {
        return this.gradualForgetting;
    };
    prototype.setGradualForgetting = function(gradualForgetting) {
        this.gradualForgetting = gradualForgetting;
    };
    prototype.getEvidenceWeight = function() {
        return this.evidenceWeight;
    };
    prototype.setEvidenceWeight = function(evidenceWeight) {
        this.evidenceWeight = evidenceWeight;
    };
    prototype.getDiscount = function() {
        return this.discount;
    };
    prototype.setDiscount = function(discount) {
        this.discount = discount;
    };
    prototype.getPriorityQueueThreshold = function() {
        return this.priorityQueueThreshold;
    };
    prototype.setPriorityQueueThreshold = function(priorityQueueThreshold) {
        this.priorityQueueThreshold = priorityQueueThreshold;
    };
    prototype.getBetaPrecision = function() {
        return this.betaPrecision;
    };
    prototype.setBetaPrecision = function(betaPrecision) {
        this.betaPrecision = betaPrecision;
    };
    prototype.getBetaMean = function() {
        return this.betaMean;
    };
    prototype.setBetaMean = function(betaMean) {
        this.betaMean = betaMean;
    };
}, {}, {});
var PapCompetencyNetwork = function(dependencies, numberNodes, settings) {
    this.numberNodes = numberNodes;
    this.dependencies = dependencies;
    this.activations = new Array();
    this.alphas = new Array();
    this.betas = new Array();
    this.updated = new Array();
    for (var i = 0; i &lt; numberNodes; i++) {
        var beta_prior = settings.getBetaPrecision();
        var beta_mean = settings.getBetaMean();
        this.alphas.push(beta_mean * beta_prior);
        this.betas.push((1.0 - beta_mean) * beta_prior);
        this.activations.push(beta_mean);
        this.updated.push(false);
    }
};
PapCompetencyNetwork = stjs.extend(PapCompetencyNetwork, null, [], function(constructor, prototype) {
    constructor.LOW_CONFLICT_CLASS = &quot;low&quot;;
    constructor.MEDIUM_CONFLICT_CLASS = &quot;medium&quot;;
    constructor.HIGH_CONFLICT_CLASS = &quot;high&quot;;
    constructor.EMPTY_PREDICTION = 0.0;
    constructor.EMPTY_CONFLICT_LEVEL = 0.0;
    constructor.MEDIUM_CONFLICT_CLASS_QUALIFIER = 1.05;
    constructor.HIGH_CONFLICT_CLASS_QUALIFIER = 1.5;
    prototype.dependencies = null;
    prototype.activations = null;
    prototype.alphas = null;
    prototype.betas = null;
    prototype.updated = null;
    prototype.numberNodes = 0;
    prototype.update = function(nodeIndex, change, positive) {
        var a = this.alphas[nodeIndex];
        var b = this.betas[nodeIndex];
        if (positive) 
            this.alphas[nodeIndex] = a + change;
         else 
            this.betas[nodeIndex] = b + change;
        this.activations[nodeIndex] = (a + (positive ? change : 0)) / (a + b + change);
        this.updated[nodeIndex] = true;
    };
    prototype.getPrediction = function(index) {
        if (this.updated[index]) {
            return this.activations[index];
        } else 
            return PapCompetencyNetwork.EMPTY_PREDICTION;
    };
    prototype.getConflictLevel = function(index) {
        if (this.updated[index]) {
            var a = this.alphas[index];
            var b = this.betas[index];
            var act = this.activations[index];
            var stdev = Math.sqrt((a * b) / (a + b + 1)) / (a + b);
            return Math.min(act, 1.0 - act) / stdev;
        } else 
            return PapCompetencyNetwork.EMPTY_CONFLICT_LEVEL;
    };
    prototype.getConflictClass = function(index) {
        var level = this.getConflictLevel(index);
        var res = PapCompetencyNetwork.LOW_CONFLICT_CLASS;
        if (level &gt;= PapCompetencyNetwork.MEDIUM_CONFLICT_CLASS_QUALIFIER) 
            res = PapCompetencyNetwork.MEDIUM_CONFLICT_CLASS;
        if (level &gt;= PapCompetencyNetwork.HIGH_CONFLICT_CLASS_QUALIFIER) 
            res = PapCompetencyNetwork.HIGH_CONFLICT_CLASS;
        return res;
    };
    prototype.getDependencies = function() {
        return this.dependencies;
    };
    prototype.setDependencies = function(dependencies) {
        this.dependencies = dependencies;
    };
    prototype.getActivations = function() {
        return this.activations;
    };
    prototype.setActivations = function(activations) {
        this.activations = activations;
    };
    prototype.getAlphas = function() {
        return this.alphas;
    };
    prototype.setAlphas = function(alphas) {
        this.alphas = alphas;
    };
    prototype.getBetas = function() {
        return this.betas;
    };
    prototype.setBetas = function(betas) {
        this.betas = betas;
    };
    prototype.getUpdated = function() {
        return this.updated;
    };
    prototype.setUpdated = function(updated) {
        this.updated = updated;
    };
    prototype.getNumberNodes = function() {
        return this.numberNodes;
    };
    prototype.setNumberNodes = function(numberNodes) {
        this.numberNodes = numberNodes;
    };
}, {dependencies: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;PapDependency&quot;]}]}]}, activations: {name: &quot;Array&quot;, arguments: [null]}, alphas: {name: &quot;Array&quot;, arguments: [null]}, betas: {name: &quot;Array&quot;, arguments: [null]}, updated: {name: &quot;Array&quot;, arguments: [null]}}, {});
var PapAssertion = function(confidence, competencyIndex, assertionDate, expirationDate, result) {
    this.confidence = confidence;
    this.assertionDate = assertionDate;
    this.expirationDate = expirationDate;
    this.result = result;
    this.competencyIndex = competencyIndex;
};
PapAssertion = stjs.extend(PapAssertion, null, [], function(constructor, prototype) {
    prototype.confidence = null;
    prototype.competencyIndex = null;
    prototype.assertionDate = null;
    prototype.expirationDate = null;
    prototype.result = false;
    prototype.getConfidence = function() {
        return this.confidence;
    };
    prototype.setConfidence = function(confidence) {
        this.confidence = confidence;
    };
    prototype.getCompetencyIndex = function() {
        return this.competencyIndex;
    };
    prototype.setCompetencyIndex = function(competencyIndex) {
        this.competencyIndex = competencyIndex;
    };
    prototype.getAssertionDate = function() {
        return this.assertionDate;
    };
    prototype.setAssertionDate = function(assertionDate) {
        this.assertionDate = assertionDate;
    };
    prototype.getExpirationDate = function() {
        return this.expirationDate;
    };
    prototype.setExpirationDate = function(expirationDate) {
        this.expirationDate = expirationDate;
    };
    prototype.getResult = function() {
        return this.result;
    };
    prototype.setResult = function(result) {
        this.result = result;
    };
}, {}, {});
var RollupRuleInterface = function(input, processor) {
    var chars = new antlr4.InputStream(input);
    var lexer = new RollupLexer.RollupLexer(chars);
    var tokens = new antlr4.CommonTokenStream(lexer);
    this.parser = new RollupParser.RollupParser(tokens);
    this.parser.buildParseTrees = true;
    this.listener = new RollupListener.RollupListener();
    this.processor = processor;
    var me = this;
    this.listener.enterS = function(ctx) {
        me.processor.enterS(ctx);
    };
    this.listener.exitS = function(ctx) {
        me.processor.exitS(ctx);
        me.success(true);
    };
    this.listener.exitToken = function(ctx) {
        me.processor.exitToken(ctx);
    };
    this.listener.enterQuery = function(ctx) {
        me.processor.enterQuery(ctx);
    };
    this.listener.exitQuery = function(ctx) {
        me.processor.exitQuery(ctx);
    };
    this.listener.exitInnerquery = function(ctx) {
        me.processor.exitInnerquery(ctx);
    };
    this.listener.exitLogical_or_math_operator = function(ctx) {
        me.processor.exitLogical_or_math_operator(ctx);
    };
    this.parser.addParseListener(this.listener);
};
RollupRuleInterface = stjs.extend(RollupRuleInterface, null, [], function(constructor, prototype) {
    prototype.logFunction = null;
    prototype.success = null;
    prototype.failure = null;
    prototype.listener = null;
    prototype.parser = null;
    prototype.processor = null;
    prototype.go = function() {
        this.processor.logFunction = this.logFunction;
        this.processor.success = this.success;
        this.processor.failure = this.failure;
        this.parser.s();
    };
}, {logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, success: {name: &quot;Callback1&quot;, arguments: [null]}, failure: {name: &quot;Callback1&quot;, arguments: [null]}, listener: &quot;RollupListener.RollupListener&quot;, parser: &quot;RollupParser.RollupParser&quot;, processor: &quot;RollupRuleProcessor&quot;}, {});
var RollupRulePacketGenerator = function(ip, ep) {
    this.ip = ip;
    this.ep = ep;
    this.queries = new Array();
    this.queryOperations = new Array();
};
RollupRulePacketGenerator = stjs.extend(RollupRulePacketGenerator, null, [], function(constructor, prototype) {
    prototype.queries = null;
    prototype.queryOperations = null;
    prototype.ip = null;
    prototype.ep = null;
    constructor.main = function(args) {};
    prototype.addQuery = function(query) {
        this.queries.push(query);
    };
    prototype.addQueryOperation = function(operation) {
        this.queryOperations.push(operation);
    };
    prototype.hasOrOperation = function() {
        for (var i = 0; i &lt; this.queryOperations.length; i++) {
            if (RollupRulePacketGenerator.OperationType.OR.equals(this.queryOperations[i])) 
                return true;
        }
        return false;
    };
    prototype.getIPType = function() {
        if (this.hasOrOperation()) 
            return InquiryPacket.IPType.RELATION_OR;
        return InquiryPacket.IPType.RELATION_AND;
    };
    prototype.generateComboAndPacket = function() {
        var meEp = this.ep;
        var meIp = this.ip;
        return new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
            if (meEp != null) 
                meEp.continueProcessingFirstPass(meIp);
        }, this.ip.failure, null, InquiryPacket.IPType.RELATION_AND);
    };
    prototype.generateRollupRulePacket = function(rule) {
        var meEp = this.ep;
        var meIp = this.ip;
        return new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
            if (meEp != null) 
                meEp.continueProcessingFirstPass(meIp);
        }, this.ip.failure, rule, InquiryPacket.IPType.ROLLUPRULE);
    };
    prototype.addAllQueries = function(rollupIp) {
        for (var i = 0; i &lt; this.queries.length; i++) {
            rollupIp.subPackets.push(this.generateRollupRulePacket(this.queries[i]));
        }
    };
    prototype.buildQueryTree = function(rollupIp) {
        if (this.queryOperations.length &lt;= 0) 
            return;
        var currentAndPacket = this.generateComboAndPacket();
        var priorOt;
        if (RollupRulePacketGenerator.OperationType.OR.equals(this.queryOperations[0])) 
            rollupIp.subPackets.push(this.generateRollupRulePacket(this.queries[0]));
         else 
            currentAndPacket.subPackets.push(this.generateRollupRulePacket(this.queries[0]));
        priorOt = this.queryOperations[0];
        for (var i = 1; i &lt; this.queryOperations.length; i++) {
            if (RollupRulePacketGenerator.OperationType.OR.equals(this.queryOperations[i])) {
                if (RollupRulePacketGenerator.OperationType.OR.equals(priorOt)) 
                    rollupIp.subPackets.push(this.generateRollupRulePacket(this.queries[i]));
                 else {
                    currentAndPacket.subPackets.push(this.generateRollupRulePacket(this.queries[i]));
                    rollupIp.subPackets.push(currentAndPacket);
                }
            } else {
                if (RollupRulePacketGenerator.OperationType.OR.equals(priorOt)) {
                    currentAndPacket = this.generateComboAndPacket();
                    currentAndPacket.subPackets.push(this.generateRollupRulePacket(this.queries[i]));
                } else 
                    currentAndPacket.subPackets.push(this.generateRollupRulePacket(this.queries[i]));
            }
            priorOt = this.queryOperations[i];
        }
        if (RollupRulePacketGenerator.OperationType.OR.equals(priorOt)) 
            rollupIp.subPackets.push(this.generateRollupRulePacket(this.queries[this.queries.length - 1]));
         else {
            currentAndPacket.subPackets.push(this.generateRollupRulePacket(this.queries[this.queries.length - 1]));
            rollupIp.subPackets.push(currentAndPacket);
        }
    };
    prototype.generatePacket = function() {
        var ipt = this.getIPType();
        var meEp = this.ep;
        var meIp = this.ip;
        var rollupIp = new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
            if (meEp != null) 
                meEp.continueProcessingFirstPass(meIp);
        }, this.ip.failure, null, ipt);
        if (InquiryPacket.IPType.RELATION_AND.equals(ipt)) 
            this.addAllQueries(rollupIp);
         else 
            this.buildQueryTree(rollupIp);
        return rollupIp;
    };
    constructor.OperationType = stjs.enumeration(&quot;AND&quot;, &quot;OR&quot;);
}, {queries: {name: &quot;Array&quot;, arguments: [null]}, queryOperations: {name: &quot;Array&quot;, arguments: [{name: &quot;Enum&quot;, arguments: [&quot;RollupRulePacketGenerator.OperationType&quot;]}]}, ip: &quot;InquiryPacket&quot;, ep: &quot;AssertionProcessor&quot;}, {});
if (!stjs.mainCallDisabled) 
    RollupRulePacketGenerator.main();
var PapDependency = function(depParms) {
    PapDependencyParms.call(this);
    if (depParms.getDependencyFirst()) {
        this.setParentIndex(depParms.getParentIndex());
        this.setChildIndex(depParms.getChildIndex());
    } else {
        this.setChildIndex(depParms.getParentIndex());
        this.setParentIndex(depParms.getChildIndex());
    }
    this.setType(depParms.getType());
    this.setWeight(depParms.getWeight());
    this.setLeak(depParms.getLeak());
};
PapDependency = stjs.extend(PapDependency, PapDependencyParms, [], function(constructor, prototype) {
    constructor.NECESSARY_TYPE = &quot;NECESSARY&quot;;
    constructor.SUFFICIENT_TYPE = &quot;SUFFICIENT&quot;;
    constructor.EQUIVALENCE_TYPE = &quot;EQUIVALENCE&quot;;
    constructor.BROADENS_TYPE = &quot;BROADENS&quot;;
    constructor.NULL_TYPE = &quot;NULL&quot;;
    constructor.HASH_CODE_MULTIPLIER = 41;
    constructor.HASH_CODE_PERCENTAGE_MULTIPLIER = 97;
    constructor.getDependencyTypes = function() {
        var dt = new Array();
        dt.push(PapDependency.NECESSARY_TYPE);
        dt.push(PapDependency.SUFFICIENT_TYPE);
        dt.push(PapDependency.EQUIVALENCE_TYPE);
        dt.push(PapDependency.BROADENS_TYPE);
        dt.push(PapDependency.NULL_TYPE);
        return dt;
    };
    prototype.toString = function() {
        return &quot;Dependency: [&quot; + this.getType().toString() + &quot;] &quot; + this.getParentIndex() + &quot; &lt;-- &quot; + this.getChildIndex();
    };
    prototype.equals = function(other) {
        return (this.getParentIndex() == (other).getParentIndex()) &amp;&amp; (this.getChildIndex() == (other).getChildIndex()) &amp;&amp; (this.getType() == (other).getType());
    };
    prototype.hashCode = function() {
        var temp = 0;
        if (PapDependency.NECESSARY_TYPE.equalsIgnoreCase(this.getType())) 
            temp = 1;
         else if (PapDependency.EQUIVALENCE_TYPE.equalsIgnoreCase(this.getType())) 
            temp = 2;
         else if (PapDependency.SUFFICIENT_TYPE.equalsIgnoreCase(this.getType())) 
            temp = 3;
         else if (PapDependency.BROADENS_TYPE.equalsIgnoreCase(this.getType())) 
            temp = 4;
        temp *= PapDependency.HASH_CODE_MULTIPLIER;
        temp += this.getParentIndex();
        temp *= PapDependency.HASH_CODE_MULTIPLIER;
        temp += this.getChildIndex();
        return temp + (stjs.trunc((100 * this.getWeight())) % PapDependency.HASH_CODE_PERCENTAGE_MULTIPLIER);
    };
}, {}, {});
/**
 *  Creates child packets for an InquiryPacket based on its context.
 * 
 *  @author fritz.ray@eduworks.com
 *  @author tom.buskirk@eduworks.com
 *  @class RelationshipPacketGenerator
 *  @module org.cassproject
 */
var RelationshipPacketGenerator = /**
 *  Constructor for the RelationshipPacketGenerator
 * 
 *  @param {InquiryPacket}      ip Inquiry Packet to generate and fill with relationship packets.
 *  @param {AssertionProcessor} ep Assertion processor to tell to resume when complete.
 *  @param {object}             processedAlignments An object to fill with keys to ensure that relations are not processed twice.
 *  @constructor
 */
function(ip, ep, processedAlignments) {
    this.ip = ip;
    this.ep = ep;
    this.processedAlignments = processedAlignments;
    this.narrowsPackets = new Array();
    this.broadensPackets = new Array();
    this.requiredPackets = new Array();
    this.isRequiredByPackets = new Array();
};
RelationshipPacketGenerator = stjs.extend(RelationshipPacketGenerator, null, [], function(constructor, prototype) {
    /**
     *  Method to call when any operation fails.
     * 
     *  @property failure
     *  @type function(string)
     */
    prototype.failure = null;
    /**
     *  Method to call when the operation succeeds.
     * 
     *  @property success
     *  @type function()
     */
    prototype.success = null;
    /**
     *  Method to call when the generator has log statements to emit.
     * 
     *  @property logFunction
     *  @type function(any)
     */
    prototype.logFunction = null;
    /**
     *  List of packets representing the narrows relation.
     * 
     *  @property narrowsPackets
     *  @type InquiryPacket[]
     */
    prototype.narrowsPackets = null;
    /**
     *  List of packets representing the broadens relation.
     * 
     *  @property broadensPackets
     *  @type InquiryPacket[]
     */
    prototype.broadensPackets = null;
    /**
     *  List of packets representing the required relation.
     * 
     *  @property requiredPackets
     *  @type InquiryPacket[]
     */
    prototype.requiredPackets = null;
    /**
     *  List of packets representing the isRequiredBy relation.
     * 
     *  @property isRequiredByPackets
     *  @type InquiryPacket[]
     */
    prototype.isRequiredByPackets = null;
    prototype.relationLookup = null;
    /**
     *  Async counter to keep track of number of outstanding requests.
     * 
     *  @property numberOfRelationsToProcess
     *  @type integer
     */
    prototype.numberOfRelationsToProcess = 0;
    /**
     *  Number of relations that have been processed.
     * 
     *  @property numberOfRelationsProcessed
     *  @type integer
     */
    prototype.numberOfRelationsProcessed = 0;
    /**
     *  Alignments to ignore, as they have already been processed.
     * 
     *  @property processedAlignments;
     *  @type Object (Map&lt;String,String&gt;)
     */
    prototype.processedAlignments = null;
    /**
     *  Assertion Processor that invoked this generator.
     * 
     *  @property ep
     *  @type AssertionProcessor
     */
    prototype.ep = null;
    /**
     *  Inquiry Packet that this generator is creating relationships for.
     * 
     *  @property ip
     *  @type InquiryPacket
     */
    prototype.ip = null;
    prototype.log = function(string) {
        if (this.logFunction != null) 
            this.logFunction(&quot;&quot; + new Date().getTime() % 100000 + &quot;: &quot; + string);
    };
    prototype.processEventFailure = function(message, ip) {
        ip.numberOfQueriesRunning--;
        this.failure(message);
    };
    prototype.pushRequiredPacketsToIp = function() {
        if (this.requiredPackets.length &gt; 0) {
            var meEp = this.ep;
            var meIp = this.ip;
            var rootRequiredPacket = new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
                if (meEp != null) 
                    meEp.continueProcessingFirstPass(meIp);
            }, this.ip.failure, null, InquiryPacket.IPType.RELATION_REQUIRES);
            rootRequiredPacket.subPackets = this.requiredPackets;
            this.ip.subPackets.push(rootRequiredPacket);
        }
    };
    prototype.pushIsRequiredByPacketsToIp = function() {
        if (this.isRequiredByPackets.length &gt; 0) {
            var meEp = this.ep;
            var meIp = this.ip;
            var rootRequiredPacket = new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
                if (meEp != null) 
                    meEp.continueProcessingFirstPass(meIp);
            }, this.ip.failure, null, InquiryPacket.IPType.RELATION_ISREQUIREDBY);
            rootRequiredPacket.subPackets = this.isRequiredByPackets;
            this.ip.subPackets.push(rootRequiredPacket);
        }
    };
    prototype.pushNarrowsPacketsToIp = function() {
        if (this.narrowsPackets.length &gt; 0) {
            var meEp = this.ep;
            var meIp = this.ip;
            var rootNarrowsPacket = new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
                if (meEp != null) 
                    meEp.continueProcessingFirstPass(meIp);
            }, this.ip.failure, null, InquiryPacket.IPType.RELATION_NARROWS);
            rootNarrowsPacket.subPackets = this.narrowsPackets;
            this.ip.subPackets.push(rootNarrowsPacket);
        }
    };
    prototype.pushBroadensPacketsToIp = function() {
        if (this.broadensPackets.length &gt; 0) {
            var meEp = this.ep;
            var meIp = this.ip;
            var rootBroadensPacket = new InquiryPacket(this.ip.subject, null, null, this.ip.context, function(p1) {
                if (meEp != null) 
                    meEp.continueProcessingFirstPass(meIp);
            }, this.ip.failure, null, InquiryPacket.IPType.RELATION_BROADENS);
            rootBroadensPacket.subPackets = this.broadensPackets;
            this.ip.subPackets.push(rootBroadensPacket);
        }
    };
    prototype.finishRelationProcessing = function() {
        this.pushRequiredPacketsToIp();
        this.pushIsRequiredByPacketsToIp();
        this.pushNarrowsPacketsToIp();
        this.pushBroadensPacketsToIp();
        this.success();
    };
    prototype.processGetRelatedCompetencySuccess = function(relatedCompetency, alignment) {
        this.numberOfRelationsProcessed++;
        var meEp = this.ep;
        var meIp = this.ip;
        if (this.processedAlignments[alignment.shortId()] != null) {
            this.ip.numberOfQueriesRunning--;
            this.checkForFinish();
            return;
        }
        this.processedAlignments[alignment.shortId()] = &quot;done&quot;;
        this.log(&quot;Adding new &quot; + alignment.relationType + &quot; relationship packet&quot;);
        if (EcAlignment.IS_EQUIVALENT_TO.equals(alignment.relationType)) {
            var ip2 = null;
            this.ip.equivalentPackets.push(ip2 = new InquiryPacket(this.ip.subject, relatedCompetency, null, this.ip.context, function(p1) {
                if (meEp != null) 
                    meEp.continueProcessingFirstPass(meIp);
            }, this.ip.failure, null, InquiryPacket.IPType.COMPETENCY));
        } else if (EcAlignment.REQUIRES.equals(alignment.relationType)) {
            if (this.ip.hasId(alignment.source)) 
                this.requiredPackets.push(new InquiryPacket(this.ip.subject, relatedCompetency, null, this.ip.context, function(p1) {
                    if (meEp != null) 
                        meEp.continueProcessingFirstPass(meIp);
                }, this.ip.failure, null, InquiryPacket.IPType.COMPETENCY));
             else 
                this.isRequiredByPackets.push(new InquiryPacket(this.ip.subject, relatedCompetency, null, this.ip.context, function(p1) {
                    if (meEp != null) 
                        meEp.continueProcessingFirstPass(meIp);
                }, this.ip.failure, null, InquiryPacket.IPType.COMPETENCY));
        } else if (EcAlignment.NARROWS.equals(alignment.relationType)) {
            if (this.ip.hasId(alignment.source)) 
                this.narrowsPackets.push(new InquiryPacket(this.ip.subject, relatedCompetency, null, this.ip.context, function(p1) {
                    if (meEp != null) 
                        meEp.continueProcessingFirstPass(meIp);
                }, this.ip.failure, null, InquiryPacket.IPType.COMPETENCY));
             else 
                this.broadensPackets.push(new InquiryPacket(this.ip.subject, relatedCompetency, null, this.ip.context, function(p1) {
                    if (meEp != null) 
                        meEp.continueProcessingFirstPass(meIp);
                }, this.ip.failure, null, InquiryPacket.IPType.COMPETENCY));
        }
        this.ip.numberOfQueriesRunning--;
        this.checkForFinish();
    };
    prototype.checkForFinish = function() {
        if (this.numberOfRelationsProcessed &gt;= this.numberOfRelationsToProcess) 
            this.finishRelationProcessing();
    };
    prototype.processFindCompetencyRelationshipSuccess = function(alignment, ip) {
        ip.numberOfQueriesRunning--;
        var relatedCompetencyId = null;
        if (ip.hasId(alignment.source) &amp;&amp; ip.hasId(alignment.target)) {
            this.numberOfRelationsProcessed++;
            this.checkForFinish();
            return;
        } else if (ip.hasId(alignment.source)) 
            relatedCompetencyId = alignment.target;
         else if (ip.hasId(alignment.target)) 
            relatedCompetencyId = alignment.source;
         else {
            this.numberOfRelationsProcessed++;
            this.checkForFinish();
            return;
        }
        this.log(&quot;Relationship found (&quot; + alignment.relationType + &quot;) source: &quot; + alignment.source + &quot; target: &quot; + alignment.target);
        ip.numberOfQueriesRunning++;
        var rpg = this;
        if (!ip.context.isId(alignment.source) &amp;&amp; !ip.context.isId(alignment.target)) {
            EcCompetency.get(relatedCompetencyId, function(p1) {
                rpg.processGetRelatedCompetencySuccess(p1, alignment);
            }, function(p1) {
                rpg.processEventFailure(p1, ip);
            });
        } else {
            this.numberOfRelationsProcessed++;
            ip.numberOfQueriesRunning--;
            this.checkForFinish();
        }
    };
    /**
     *  Method to invoke to begin relation processing.
     * 
     *  @method go
     */
    prototype.go = function() {
        var rpg = this;
        if (this.ip.getContext().relation == null) 
            this.success();
         else {
            this.numberOfRelationsToProcess = 0;
            for (var i = 0; i &lt; this.ip.competency.length; i++) {
                var relationsRelatedToThisCompetency = (this.relationLookup)[this.ip.competency[i].shortId()];
                if (relationsRelatedToThisCompetency == null) 
                    relationsRelatedToThisCompetency = new Array();
                this.numberOfRelationsToProcess += relationsRelatedToThisCompetency.length;
                this.numberOfRelationsProcessed = 0;
                for (var j = 0; j &lt; relationsRelatedToThisCompetency.length; j++) {
                    this.ip.numberOfQueriesRunning++;
                    rpg.processFindCompetencyRelationshipSuccess(relationsRelatedToThisCompetency[j], rpg.ip);
                }
                if (relationsRelatedToThisCompetency.length == 0) {
                    this.checkForFinish();
                }
            }
        }
    };
}, {failure: {name: &quot;Callback1&quot;, arguments: [null]}, success: &quot;Callback0&quot;, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, narrowsPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, broadensPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, requiredPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, isRequiredByPackets: {name: &quot;Array&quot;, arguments: [&quot;InquiryPacket&quot;]}, relationLookup: &quot;Object&quot;, processedAlignments: {name: &quot;Map&quot;, arguments: [null, null]}, ep: &quot;AssertionProcessor&quot;, ip: &quot;InquiryPacket&quot;}, {});
var RollupRuleGenerator = function(ip) {
    this.ip = ip;
    this.rule = &quot;&quot;;
    this.outerRule = &quot;&quot;;
};
RollupRuleGenerator = stjs.extend(RollupRuleGenerator, null, [], function(constructor, prototype) {
    prototype.failure = null;
    prototype.success = null;
    prototype.rule = null;
    prototype.outerRule = null;
    prototype.ip = null;
    prototype.go = function() {
        var me = this;
        if (this.ip.getContext().relation == null) 
            this.success(null);
         else 
            for (var i = 0; i &lt; this.ip.getContext().relation.length; i++) {
                this.ip.numberOfQueriesRunning++;
                EcAlignment.get(this.ip.getContext().relation[i], function(p1) {
                    me.ip.numberOfQueriesRunning--;
                    if (!p1.source.equals(me.ip.competency) &amp;&amp; !p1.target.equals(me.ip.competency)) 
                        return;
                    if (p1.source.equals(me.ip.competency)) {
                        if (p1.relationType.equals(EcAlignment.REQUIRES)) {
                            if (me.rule != null &amp;&amp; me.rule != &quot;&quot;) 
                                me.rule += &quot; AND &quot;;
                            me.rule += &quot;[notNegative competency:\&quot;&quot; + p1.target + &quot;\&quot;]&quot;;
                        }
                        if (p1.relationType.equals(EcAlignment.NARROWS)) {
                            if (me.outerRule != null &amp;&amp; me.outerRule != &quot;&quot;) 
                                me.outerRule += &quot; OR &quot;;
                            me.outerRule += &quot;[competency:\&quot;&quot; + p1.target + &quot;\&quot;]&quot;;
                        }
                    }
                }, function(p1) {
                    me.ip.numberOfQueriesRunning--;
                });
            }
    };
}, {failure: {name: &quot;Callback1&quot;, arguments: [null]}, success: {name: &quot;Callback1&quot;, arguments: [null]}, ip: &quot;InquiryPacket&quot;}, {});
var PapNetworkPrediction = function(predictionDate, subjectPem, competencyList, competencyNetwork) {
    this.predictionDate = predictionDate;
    this.subjectPem = subjectPem;
    this.predictions = new Array();
    var currentCompetency;
    var pcp;
    for (var i = 0; i &lt; competencyList.length; i++) {
        currentCompetency = competencyList[i];
        pcp = new PapCompetencyPrediction();
        pcp.setCompetencyId(currentCompetency);
        pcp.setConfidence(competencyNetwork.getPrediction(i));
        pcp.setConflictLevel(competencyNetwork.getConflictLevel(i));
        pcp.setConflictClass(competencyNetwork.getConflictClass(i));
        this.predictions.push(pcp);
    }
};
PapNetworkPrediction = stjs.extend(PapNetworkPrediction, null, [], function(constructor, prototype) {
    prototype.predictionDate = null;
    prototype.subjectPem = null;
    prototype.predictions = null;
    prototype.getPredictionDate = function() {
        return this.predictionDate;
    };
    prototype.setPredictionDate = function(predictionDate) {
        this.predictionDate = predictionDate;
    };
    prototype.getSubjectPem = function() {
        return this.subjectPem;
    };
    prototype.setSubjectPem = function(subjectPem) {
        this.subjectPem = subjectPem;
    };
    prototype.getPredictions = function() {
        return this.predictions;
    };
    prototype.setPredictions = function(predictions) {
        this.predictions = predictions;
    };
    prototype.getJsonString = function() {
        return JSON.stringify(this);
    };
}, {predictions: {name: &quot;Array&quot;, arguments: [&quot;PapCompetencyPrediction&quot;]}}, {});
var NodeGraph = function() {
    this.nodeList = new Array();
    this.relationList = new Array();
    this.nodeMap = {};
    this.relationMap = {};
};
NodeGraph = stjs.extend(NodeGraph, null, [], function(constructor, prototype) {
    prototype.nodeList = null;
    prototype.nodeMap = null;
    prototype.relationList = null;
    prototype.relationMap = null;
    prototype.addNode = function(n) {
        if (this.nodeMap[n.getId()] == null) {
            this.nodeList.push(n);
            this.nodeMap[n.getId()] = n;
        }
    };
    prototype.createImpliedRelations = function() {
        try {
            var relationsToAdd = new Array();
            var nr;
            for (var i = 0; i &lt; this.relationList.length; i++) {
                nr = this.relationList[i];
                if (nr.getType() == RelationType.RELATION_TYPE.NARROWS) {
                    relationsToAdd.push(new NodeRelation(nr.getTarget(), nr.getSource(), RelationType.RELATION_TYPE.BROADENS));
                } else if (nr.getType() == RelationType.RELATION_TYPE.REQUIRES) {
                    relationsToAdd.push(new NodeRelation(nr.getTarget(), nr.getSource(), RelationType.RELATION_TYPE.IS_REQUIRED_BY));
                } else if (nr.getType() == RelationType.RELATION_TYPE.BROADENS) {
                    relationsToAdd.push(new NodeRelation(nr.getTarget(), nr.getSource(), RelationType.RELATION_TYPE.NARROWS));
                } else if (nr.getType() == RelationType.RELATION_TYPE.IS_REQUIRED_BY) {
                    relationsToAdd.push(new NodeRelation(nr.getTarget(), nr.getSource(), RelationType.RELATION_TYPE.REQUIRES));
                }
            }
            var nnr;
            for (var i = 0; i &lt; relationsToAdd.length; i++) {
                nnr = relationsToAdd[i];
                this.addRelation(nnr.getSource(), nnr.getTarget(), nnr.getType());
            }
        }catch (e) {
             throw new Exception(&quot;createImpliedRelations: &quot; + e.toString());
        }
    };
    prototype.addRelation = function(sourceNode, targetNode, relationType) {
        try {
            if (sourceNode == null || targetNode == null) 
                return;
            var nodeRelationList;
            if (this.nodeHasRelations(sourceNode)) 
                nodeRelationList = this.getRelationListForNode(sourceNode);
             else {
                nodeRelationList = new Array();
                this.relationMap[sourceNode.getId()] = nodeRelationList;
            }
            var newNodeRelation = new NodeRelation(sourceNode, targetNode, relationType);
            if (!this.doesRelationAlreadyExist(newNodeRelation, nodeRelationList)) {
                nodeRelationList.push(newNodeRelation);
                this.relationList.push(newNodeRelation);
            }
        }catch (e) {
             throw new Exception(&quot;addRelation: &quot; + e.toString());
        }
    };
    prototype.getRelationListForNode = function(n) {
        return this.relationMap[n.getId()];
    };
    prototype.getNarrowsIsRequiredByEqualsRelationListForNode = function(n) {
        var retList = new Array();
        if (this.relationMap[n.getId()] != null) {
            var nra = this.relationMap[n.getId()];
            var nr;
            for (var i = 0; i &lt; nra.length; i++) {
                nr = nra[i];
                if (nr.getType() == RelationType.RELATION_TYPE.IS_EQUIVALENT_TO || nr.getType() == RelationType.RELATION_TYPE.NARROWS || nr.getType() == RelationType.RELATION_TYPE.IS_REQUIRED_BY) {
                    retList.push(nr);
                }
            }
        }
        return retList;
    };
    prototype.getBroadensRequiresEqualsRelationListForNode = function(n) {
        var retList = new Array();
        if (this.relationMap[n.getId()] != null) {
            var nra = this.relationMap[n.getId()];
            var nr;
            for (var i = 0; i &lt; nra.length; i++) {
                nr = nra[i];
                if (nr.getType() == RelationType.RELATION_TYPE.IS_EQUIVALENT_TO || nr.getType() == RelationType.RELATION_TYPE.BROADENS || nr.getType() == RelationType.RELATION_TYPE.REQUIRES) {
                    retList.push(nr);
                }
            }
        }
        return retList;
    };
    prototype.getNodeList = function() {
        return this.nodeList;
    };
    prototype.setNodeList = function(nodeList) {
        this.nodeList = nodeList;
    };
    prototype.getRelationList = function() {
        return this.relationList;
    };
    prototype.setRelationList = function(relationList) {
        this.relationList = relationList;
    };
    prototype.nodeHasRelations = function(n) {
        if (this.relationMap[n.getId()] == null) 
            return false;
        return true;
    };
    prototype.doesRelationAlreadyExist = function(nodeRelation, nodeRelationList) {
        var nr;
        for (var i = 0; i &lt; nodeRelationList.length; i++) {
            nr = nodeRelationList[i];
            if (nodeRelation.getSource().getId() == nr.getSource().getId() &amp;&amp; nodeRelation.getTarget().getId() == nr.getTarget().getId() &amp;&amp; nodeRelation.getType() == nr.getType()) 
                return true;
        }
        return false;
    };
    prototype.toStringGraphAll = function() {
        var ret = &quot;&quot;;
        var n;
        for (var i = 0; i &lt; this.nodeList.length; i++) {
            n = this.nodeList[i];
            ret = ret + n.toString() + &quot;\n&quot;;
        }
        var nr;
        for (var i = 0; i &lt; this.relationList.length; i++) {
            nr = this.relationList[i];
            ret = ret + nr.toString() + &quot;\n&quot;;
        }
        return ret;
    };
    prototype.toStringGraphByNode = function() {
        var ret = &quot;&quot;;
        ret = ret + &quot; - TEST HOWDY - \n&quot;;
        var n;
        var nra;
        var nr;
        for (var i = 0; i &lt; this.nodeList.length; i++) {
            n = this.nodeList[i];
            ret = ret + &quot;   --&gt; &quot; + n.toString() + &quot;\n&quot;;
            if (this.nodeHasRelations(n)) {
                nra = this.getRelationListForNode(n);
                for (var j = 0; j &lt; nra.length; j++) {
                    nr = nra[j];
                    ret = ret + &quot;\t\t&quot; + nr.toString() + &quot;\n&quot;;
                }
            } else 
                ret = ret + &quot;\t\t---------NO RELATIONSHIPS---------\n&quot;;
        }
        return ret;
    };
    prototype.toStringGraphByNodeSplit = function() {
        var ret = &quot;&quot;;
        var n;
        var nra;
        var nr;
        for (var i = 0; i &lt; this.nodeList.length; i++) {
            n = this.nodeList[i];
            ret = ret + &quot;   --&gt; &quot; + n.toString() + &quot;\n&quot;;
            if (this.nodeHasRelations(n)) {
                ret = ret + &quot;\t\t=== Narrows/isRequiredBy ===\n&quot;;
                nra = this.getNarrowsIsRequiredByEqualsRelationListForNode(n);
                for (var j = 0; j &lt; nra.length; j++) {
                    nr = nra[j];
                    ret = ret + &quot;\t\t&quot; + nr.toString() + &quot;\n&quot;;
                }
                ret = ret + &quot;\t\t=== Broadens/Requires ===\n&quot;;
                nra = this.getBroadensRequiresEqualsRelationListForNode(n);
                for (var j = 0; j &lt; nra.length; j++) {
                    nr = nra[j];
                    ret = ret + &quot;\t\t&quot; + nr.toString() + &quot;\n&quot;;
                }
            } else 
                ret = ret + &quot;\t\t---------NO RELATIONSHIPS---------\n&quot;;
        }
        return ret;
    };
}, {nodeList: {name: &quot;Array&quot;, arguments: [&quot;Node&quot;]}, nodeMap: {name: &quot;Map&quot;, arguments: [null, &quot;Node&quot;]}, relationList: {name: &quot;Array&quot;, arguments: [&quot;NodeRelation&quot;]}, relationMap: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;NodeRelation&quot;]}]}}, {});
var CompetencyGraph = function(includeAssertions) {
    this.nodes = new Array();
    this.edges = new Array();
    this.positiveAssertions = new Array();
    this.negativeAssertions = new Array();
    this.nodeMap = {};
    this.edgeMap = {};
    this.includeAssertions = includeAssertions;
};
CompetencyGraph = stjs.extend(CompetencyGraph, null, [], function(constructor, prototype) {
    constructor.NARROWS_RELATION_TEXT = &quot;narrows&quot;;
    constructor.BROADENS_RELATION_TEXT = &quot;broadens&quot;;
    constructor.REQUIRES_RELATION_TEXT = &quot;requires&quot;;
    constructor.IS_REQUIRED_BY_RELATION_TEXT = &quot;isRequiredBy&quot;;
    constructor.IS_EQUIVALENT_TO_RELATION_TEXT = &quot;isEquivalentTo&quot;;
    constructor.EDGE_MAP_FIELD_DELIMETER = &quot; -------||||||------- &quot;;
    constructor.CleanGraph = function(nodes, edges) {
        this.nodes = nodes;
        this.edges = edges;
    };
    constructor.CleanGraph = stjs.extend(constructor.CleanGraph, null, [], function(constructor, prototype) {
        prototype.nodes = null;
        prototype.edges = null;
    }, {nodes: {name: &quot;Array&quot;, arguments: [null]}, edges: {name: &quot;Array&quot;, arguments: [&quot;CgEdge&quot;]}}, {});
    constructor.CleanGraphWithAssertions = function(nodes, edges, positiveAssertions, negativeAssertions) {
        this.nodes = nodes;
        this.edges = edges;
        this.positiveAssertions = positiveAssertions;
        this.negativeAssertions = negativeAssertions;
    };
    constructor.CleanGraphWithAssertions = stjs.extend(constructor.CleanGraphWithAssertions, null, [], function(constructor, prototype) {
        prototype.nodes = null;
        prototype.edges = null;
        prototype.positiveAssertions = null;
        prototype.negativeAssertions = null;
    }, {nodes: {name: &quot;Array&quot;, arguments: [null]}, edges: {name: &quot;Array&quot;, arguments: [&quot;CgEdge&quot;]}, positiveAssertions: {name: &quot;Array&quot;, arguments: [&quot;SimpleAssertion&quot;]}, negativeAssertions: {name: &quot;Array&quot;, arguments: [&quot;SimpleAssertion&quot;]}}, {});
    prototype.nodes = null;
    prototype.edges = null;
    prototype.positiveAssertions = null;
    prototype.negativeAssertions = null;
    prototype.nodeMap = null;
    prototype.edgeMap = null;
    prototype.includeAssertions = false;
    prototype.addNode = function(id) {
        if (!this.graphContainsNode(id)) {
            this.nodes.push(id);
            this.nodeMap[id] = id;
        }
    };
    prototype.getEdgeKey = function(source, target, relationType) {
        return source + CompetencyGraph.EDGE_MAP_FIELD_DELIMETER + target + CompetencyGraph.EDGE_MAP_FIELD_DELIMETER + relationType;
    };
    prototype.addEdge = function(source, target, relationType) {
        if (!this.graphContainsEdge(source, target, relationType)) {
            this.edges.push(new CgEdge(source, target, relationType));
            var edgeKey = this.getEdgeKey(source, target, relationType);
            this.edgeMap[edgeKey] = edgeKey;
        }
    };
    prototype.addPositiveAssertion = function(simpleAssertion) {
        if (simpleAssertion != null) 
            this.positiveAssertions.push(simpleAssertion);
    };
    prototype.addNegativeAssertion = function(simpleAssertion) {
        if (simpleAssertion != null) 
            this.negativeAssertions.push(simpleAssertion);
    };
    prototype.graphContainsNode = function(nodeId) {
        if (this.nodeMap[nodeId] == null) 
            return false;
        return true;
    };
    prototype.graphContainsEdge = function(source, target, relationType) {
        if (this.edgeMap[this.getEdgeKey(source, target, relationType)] == null) 
            return false;
        return true;
    };
    prototype.createImpliedRelationships = function() {
        var edgesToAdd = new Array();
        var e;
        for (var i = 0; i &lt; this.edges.length; i++) {
            e = this.edges[i];
            if (e.getRelation().equalsIgnoreCase(CompetencyGraph.NARROWS_RELATION_TEXT)) {
                edgesToAdd.push(new CgEdge(e.getTarget(), e.getSource(), CompetencyGraph.BROADENS_RELATION_TEXT));
            } else if (e.getRelation().equalsIgnoreCase(CompetencyGraph.REQUIRES_RELATION_TEXT)) {
                edgesToAdd.push(new CgEdge(e.getTarget(), e.getSource(), CompetencyGraph.IS_REQUIRED_BY_RELATION_TEXT));
            } else if (e.getRelation().equalsIgnoreCase(CompetencyGraph.IS_EQUIVALENT_TO_RELATION_TEXT)) {
                edgesToAdd.push(new CgEdge(e.getTarget(), e.getSource(), CompetencyGraph.IS_EQUIVALENT_TO_RELATION_TEXT));
            }
        }
        var ne;
        for (var i = 0; i &lt; edgesToAdd.length; i++) {
            ne = edgesToAdd[i];
            this.addEdge(ne.getSource(), ne.getTarget(), ne.getRelation());
        }
    };
    prototype.getJsonString = function() {
        if (this.includeAssertions) 
            return JSON.stringify(new CompetencyGraph.CleanGraphWithAssertions(this.nodes, this.edges, this.positiveAssertions, this.negativeAssertions));
         else 
            return JSON.stringify(new CompetencyGraph.CleanGraph(this.nodes, this.edges));
    };
    prototype.getNodes = function() {
        return this.nodes;
    };
    prototype.setNodes = function(nodes) {
        this.nodes = nodes;
    };
    prototype.getEdges = function() {
        return this.edges;
    };
    prototype.setEdges = function(edges) {
        this.edges = edges;
    };
    prototype.getPositiveAssertions = function() {
        return this.positiveAssertions;
    };
    prototype.setPositiveAssertions = function(positiveAssertions) {
        this.positiveAssertions = positiveAssertions;
    };
    prototype.getNegativeAssertions = function() {
        return this.negativeAssertions;
    };
    prototype.setNegativeAssertions = function(negativeAssertions) {
        this.negativeAssertions = negativeAssertions;
    };
}, {nodes: {name: &quot;Array&quot;, arguments: [null]}, edges: {name: &quot;Array&quot;, arguments: [&quot;CgEdge&quot;]}, positiveAssertions: {name: &quot;Array&quot;, arguments: [&quot;SimpleAssertion&quot;]}, negativeAssertions: {name: &quot;Array&quot;, arguments: [&quot;SimpleAssertion&quot;]}, nodeMap: {name: &quot;Map&quot;, arguments: [null, null]}, edgeMap: {name: &quot;Map&quot;, arguments: [null, null]}}, {});
var PapDependencyDefinitions = function() {
    this.dependencyDefinitionMap = {};
};
PapDependencyDefinitions = stjs.extend(PapDependencyDefinitions, null, [], function(constructor, prototype) {
    constructor.DEFAULT_WEIGHT = 1.0;
    constructor.DEFAULT_LEAK = 0.0;
    constructor.DEFAULT_REVERSE = false;
    constructor.DEFAULT_NARROWS_BASE_CLASS = &quot;broadens&quot;;
    constructor.DEFAULT_NARROWS_REVERSE = true;
    constructor.DEFAULT_NARROWS_WEIGHT = 0.9;
    constructor.DEFAULT_NARROWS_LEAK = 0.0;
    constructor.DEFAULT_NARROWS_KEY = &quot;narrows&quot;;
    constructor.DEFAULT_ENABLES_BASE_CLASS = &quot;isSufficientFor&quot;;
    constructor.DEFAULT_ENABLES_REVERSE = true;
    constructor.DEFAULT_ENABLES_WEIGHT = 0.9;
    constructor.DEFAULT_ENABLES_LEAK = 0.0;
    constructor.DEFAULT_ENABLES_KEY = &quot;enables&quot;;
    constructor.DEFAULT_REQUIRES_BASE_CLASS = &quot;isRequiredBy&quot;;
    constructor.DEFAULT_REQUIRES_REVERSE = false;
    constructor.DEFAULT_REQUIRES_WEIGHT = 0.9;
    constructor.DEFAULT_REQUIRES_LEAK = 0.0;
    constructor.DEFAULT_REQUIRES_KEY = &quot;requires&quot;;
    prototype.dependencyDefinitionMap = null;
    /**
     *  Pulled default values from CruncherAssertionProcessor
     *      dependencyDefs = new JSONObject();
     * 
     *      JSONObject narrows = new JSONObject();
     *      narrows.put(&quot;class&quot;,&quot;broadens&quot;);
     *      narrows.put(&quot;reverse&quot;,true);
     *      narrows.put(&quot;weight&quot;,0.9);
     *      dependencyDefs.put(&quot;narrows&quot;,narrows);
     * 
     *      JSONObject enables = new JSONObject();
     *      enables.put(&quot;class&quot;,&quot;isSufficientFor&quot;);
     *      enables.put(&quot;weight&quot;,0.9);
     *      enables.put(&quot;reverse&quot;,true);
     *      dependencyDefs.put(&quot;enables&quot;,enables);
     * 
     *      JSONObject requires = new JSONObject();
     *      requires.put(&quot;class&quot;,&quot;isRequiredBy&quot;);
     *      requires.put(&quot;weight&quot;,0.9);
     *      dependencyDefs.put(&quot;requires&quot;,requires);
     */
    prototype.initDefaultDefinitions = function() {
        var narrowsDepDef = new PapDependencyDefinitionBase(PapDependencyDefinitions.DEFAULT_NARROWS_BASE_CLASS, PapDependencyDefinitions.DEFAULT_NARROWS_REVERSE, PapDependencyDefinitions.DEFAULT_NARROWS_WEIGHT, PapDependencyDefinitions.DEFAULT_NARROWS_LEAK);
        var enablesDepDef = new PapDependencyDefinitionBase(PapDependencyDefinitions.DEFAULT_ENABLES_BASE_CLASS, PapDependencyDefinitions.DEFAULT_ENABLES_REVERSE, PapDependencyDefinitions.DEFAULT_ENABLES_WEIGHT, PapDependencyDefinitions.DEFAULT_ENABLES_LEAK);
        var requiresDepDef = new PapDependencyDefinitionBase(PapDependencyDefinitions.DEFAULT_REQUIRES_BASE_CLASS, PapDependencyDefinitions.DEFAULT_REQUIRES_REVERSE, PapDependencyDefinitions.DEFAULT_REQUIRES_WEIGHT, PapDependencyDefinitions.DEFAULT_REQUIRES_LEAK);
        this.addDependencyDefinition(PapDependencyDefinitions.DEFAULT_NARROWS_KEY, narrowsDepDef);
        this.addDependencyDefinition(PapDependencyDefinitions.DEFAULT_ENABLES_KEY, enablesDepDef);
        this.addDependencyDefinition(PapDependencyDefinitions.DEFAULT_REQUIRES_KEY, requiresDepDef);
    };
    prototype.getWeightForType = function(depType) {
        var base = this.dependencyDefinitionMap[depType];
        if (base == null) 
            return PapDependencyDefinitions.DEFAULT_WEIGHT;
         else 
            return base.getWeight();
    };
    prototype.getLeakForType = function(depType) {
        var base = this.dependencyDefinitionMap[depType];
        if (base == null) 
            return PapDependencyDefinitions.DEFAULT_LEAK;
         else 
            return base.getLeak();
    };
    prototype.getReverseForType = function(depType) {
        var base = this.dependencyDefinitionMap[depType];
        if (base == null) 
            return PapDependencyDefinitions.DEFAULT_REVERSE;
         else 
            return base.getReverse();
    };
    prototype.addDependencyDefinition = function(relationshipName, definition) {
        this.getDependencyDefinitionMap()[relationshipName] = definition;
    };
    prototype.getDependencyDefinitionMap = function() {
        return this.dependencyDefinitionMap;
    };
    prototype.setDependencyDefinitionMap = function(dependencyDefinitionMap) {
        this.dependencyDefinitionMap = dependencyDefinitionMap;
    };
}, {dependencyDefinitionMap: {name: &quot;Map&quot;, arguments: [null, &quot;PapDependencyDefinitionBase&quot;]}}, {});
/**
 *  Graph for working with a framework. Additional computed data (such as profile data) can be overlaid on the graph through the use of &quot;metaverticies&quot; and &quot;metaedges&quot; that hold additional information.
 * 
 *  @author fritz.ray@eduworks.com
 *  @author tom.buskirk@eduworks.com
 *  @class EcFrameworkGraph
 */
var EcFrameworkGraph = function() {
    EcDirectedGraph.call(this);
    this.metaVerticies = new Object();
    this.metaEdges = new Object();
    this.competencyMap = new Object();
    this.edgeMap = new Object();
    this.dontTryAnyMore = new Object();
    this.frameworks = new Array();
};
EcFrameworkGraph = stjs.extend(EcFrameworkGraph, EcDirectedGraph, [], function(constructor, prototype) {
    prototype.metaVerticies = null;
    prototype.metaEdges = null;
    prototype.competencyMap = null;
    prototype.edgeMap = null;
    prototype.dontTryAnyMore = null;
    prototype.frameworks = null;
    prototype.addFrameworkSuccessCallback = null;
    prototype.addFrameworkFailureCallback = null;
    prototype.repo = null;
    /**
     *  Adds a framework to the graph, and creates the edges to connect the competencies in the framework.
     * 
     *  @param {EcFramework}     framework Framework to add to the graph.
     *  @param {EcRepository}    repo Repository to fetch data from that exists in the framework.
     *  @param {function()}      success Method to invoke when done adding the framework.
     *  @param {function(error)} failure Method to invoke when things go badly.
     *  @method addFramework
     *  @memberOf EcFrameworkGraph
     */
    prototype.addFramework = function(framework, repo, success, failure) {
        this.frameworks.push(framework);
        var me = this;
        repo.multiget(framework.competency.concat(framework.relation), function(data) {
            var competencyTemplate = new EcCompetency();
            var alignmentTemplate = new EcAlignment();
            var eah = new EcAsyncHelper();
            eah.each(data, function(d, callback0) {
                if (d.isAny(competencyTemplate.getTypes())) {
                    EcCompetency.get(d.id, function(c) {
                        me.addToMetaStateArray(me.getMetaStateCompetency(c), &quot;framework&quot;, framework);
                        me.addCompetency(c);
                        callback0();
                    }, callback0);
                } else if (d.isAny(alignmentTemplate.getTypes())) {
                    EcAlignment.get(d.id, function(alignment) {
                        me.addRelation(alignment);
                        me.addToMetaStateArray(me.getMetaStateAlignment(alignment), &quot;framework&quot;, framework);
                        callback0();
                    }, callback0);
                } else 
                    callback0();
            }, function(strings) {
                success();
            });
        }, failure);
    };
    prototype.fetchFrameworkAlignments = function(framework) {
        var me = this;
        EcAlignment.search(this.repo, EcGraphUtil.buildIdSearchQueryForIdList(framework.relation), function(ecaa) {
            for (var i = 0; i &lt; ecaa.length; i++) {
                var a = ecaa[i];
                me.addRelation(a);
                me.addToMetaStateArray(me.getMetaStateAlignment(a), &quot;framework&quot;, framework);
            }
            me.addFrameworkSuccessCallback();
        }, me.addFrameworkFailureCallback, null);
    };
    /**
     *  Helper method to populate the graph with assertion data, based on propagation rules implicit in the relations (see devs.cassproject.org, Relations). Does not draw conclusions. Must be able to decrypt &#x27;negative&#x27; value.
     * 
     *  @param {Assertion[]}     assertions Assertion candidates to use to populate the graph.
     *  @param {function()}      success Method to invoke when the operation completes successfully.
     *  @param {function(error)} failure Error method.
     */
    prototype.processAssertionsBoolean = function(assertions, success, failure) {
        var me = this;
        var eah = new EcAsyncHelper();
        eah.each(assertions, function(assertion, done) {
            var competency = me.getCompetency(assertion.competency);
            if (competency == null || !me.containsVertex(competency)) {
                done();
                return;
            }
            assertion.getNegativeAsync(function(negative) {
                me.processAssertionsBooleanPerAssertion(assertion, negative, competency, done, new Array());
            }, eah.failWithCallback(failure, done));
        }, function(strings) {
            success();
        });
    };
    prototype.processAssertionsBooleanPerAssertion = function(assertion, negative, competency, done, visited) {
        var me = this;
        if (EcArray.has(visited, competency)) {
            done();
            return;
        }
        visited.push(competency);
        if (negative) {
            var metaState = this.getMetaStateCompetency(competency);
            this.addToMetaStateArray(metaState, &quot;negativeAssertion&quot;, assertion);
            new EcAsyncHelper().each(me.getOutEdges(competency), function(alignment, callback0) {
                var c = me.getCompetency(alignment.target);
                me.processAssertionBooleanOutward(alignment, callback0, c, me, assertion, negative, visited);
            }, function(strings) {
                new EcAsyncHelper().each(me.getInEdges(competency), function(alignment, callback0) {
                    var c = me.getCompetency(alignment.source);
                    me.processAssertionBooleanInward(alignment, callback0, c, me, assertion, negative, visited);
                }, function(strings) {
                    done();
                });
            });
        } else {
            var metaState = this.getMetaStateCompetency(competency);
            this.addToMetaStateArray(metaState, &quot;positiveAssertion&quot;, assertion);
            new EcAsyncHelper().each(me.getInEdges(competency), function(alignment, callback0) {
                var c = me.getCompetency(alignment.source);
                me.processAssertionBooleanOutward(alignment, callback0, c, me, assertion, negative, visited);
            }, function(strings) {
                new EcAsyncHelper().each(me.getOutEdges(competency), function(alignment, callback0) {
                    var c = me.getCompetency(alignment.target);
                    me.processAssertionBooleanInward(alignment, callback0, c, me, assertion, negative, visited);
                }, function(strings) {
                    done();
                });
            });
        }
    };
    prototype.processAssertionBooleanOutward = function(alignment, callback0, c, me, assertion, negative, visited) {
        if (alignment.relationType == Relation.NARROWS) 
            me.processAssertionsBooleanPerAssertion(assertion, negative, c, callback0, visited);
         else if (alignment.relationType == Relation.IS_EQUIVALENT_TO) 
            me.processAssertionsBooleanPerAssertion(assertion, negative, c, callback0, visited);
         else 
            callback0();
    };
    prototype.processAssertionBooleanInward = function(alignment, callback0, c, me, assertion, negative, visited) {
        if (alignment.relationType == Relation.REQUIRES) 
            me.processAssertionsBooleanPerAssertion(assertion, negative, c, callback0, visited);
         else if (alignment.relationType == Relation.IS_EQUIVALENT_TO) 
            me.processAssertionsBooleanPerAssertion(assertion, negative, c, callback0, visited);
         else 
            callback0();
    };
    prototype.addToMetaStateArray = function(metaState, key, value) {
        if (metaState == null) 
            return;
        if ((metaState)[key] == null) 
            (metaState)[key] = new Array();
        ((metaState)[key]).push(value);
    };
    /**
     *  Fetches the Meta Competency (additional state information used to compute profiles or other data) for a competency.
     * 
     *  @param {EcCompetency} c Competency to fetch meta state for.
     *  @return Meta state (empty object by default)
     *  @method getMetaStateCompetency
     *  @memberOf EcFrameworkGraph
     */
    prototype.getMetaStateCompetency = function(c) {
        var result = this.metaVerticies[c.shortId()];
        if (result == null) {
            if (this.containsVertex(c) == false) 
                return null;
            if (this.metaVerticies[c.shortId()] == null) 
                this.metaVerticies[c.shortId()] = result = new Object();
        }
        return result;
    };
    prototype.getMetaStateAlignment = function(a) {
        var result = this.metaEdges[a.shortId()];
        if (result == null) {
            if (this.containsEdge(a) == false) 
                return null;
            if (this.metaEdges[a.shortId()] == null) 
                this.metaEdges[a.shortId()] = result = new Object();
        }
        return result;
    };
    prototype.containsVertex = function(competency) {
        return (this.competencyMap)[competency.shortId()] != null;
    };
    prototype.containsEdge = function(competency) {
        return (this.edgeMap)[competency.shortId()] != null;
    };
    prototype.getCompetency = function(competencyId) {
        var c = null;
        c = (this.competencyMap)[competencyId];
        if (c == null) 
            c = EcCompetency.getBlocking(competencyId);
        return c;
    };
    prototype.addCompetency = function(competency) {
        if (competency == null) 
            return false;
        if (this.containsVertex(competency)) 
            return false;
        (this.competencyMap)[competency.shortId()] = competency;
        (this.competencyMap)[competency.id] = competency;
        return this.addVertex(competency);
    };
    prototype.addRelation = function(alignment) {
        if (alignment == null) 
            return false;
        if (this.containsEdge(alignment)) 
            return false;
        var source = (this.competencyMap)[alignment.source];
        if (source == null &amp;&amp; (this.dontTryAnyMore)[alignment.source] != null) 
            return false;
        if (source == null) 
            source = this.getCompetency(alignment.source);
        if (source == null) 
            (this.dontTryAnyMore)[alignment.source] = &quot;&quot;;
        var target = (this.competencyMap)[alignment.target];
        if (target == null &amp;&amp; (this.dontTryAnyMore)[alignment.target] != null) 
            return false;
        if (target == null) 
            target = this.getCompetency(alignment.target);
        if (target == null) 
            (this.dontTryAnyMore)[alignment.target] = &quot;&quot;;
        if (source == null || target == null) 
            return false;
        return this.addEdgeUnsafely(alignment, source, target);
    };
    prototype.addHyperEdge = function(edge, vertices) {
         throw new RuntimeException(&quot;Don&#x27;t do this.&quot;);
    };
    prototype.getEdgeType = function(edge) {
        return edge.relationType;
    };
    prototype.getDefaultEdgeType = function() {
        return EcAlignment.NARROWS;
    };
}, {metaVerticies: {name: &quot;Map&quot;, arguments: [null, &quot;Object&quot;]}, metaEdges: {name: &quot;Map&quot;, arguments: [null, &quot;Object&quot;]}, competencyMap: &quot;Object&quot;, edgeMap: &quot;Object&quot;, dontTryAnyMore: &quot;Object&quot;, frameworks: {name: &quot;Array&quot;, arguments: [&quot;EcFramework&quot;]}, addFrameworkSuccessCallback: &quot;Callback0&quot;, addFrameworkFailureCallback: {name: &quot;Callback1&quot;, arguments: [null]}, repo: &quot;EcRepository&quot;, edges: {name: &quot;Array&quot;, arguments: [{name: &quot;Triple&quot;, arguments: [&quot;V&quot;, &quot;V&quot;, &quot;E&quot;]}]}, verticies: {name: &quot;Array&quot;, arguments: [&quot;V&quot;]}}, {});
var NodePacketGraph = function() {
    this.nodePacketList = new Array();
    this.nodePacketMap = {};
    this.relationList = new Array();
};
NodePacketGraph = stjs.extend(NodePacketGraph, null, [], function(constructor, prototype) {
    prototype.nodePacketList = null;
    prototype.nodePacketMap = null;
    prototype.relationList = null;
    prototype.initNodePacketGraph = function(nodes) {
        var np;
        var n;
        this.nodePacketList = new Array();
        this.nodePacketMap = {};
        this.relationList = new Array();
        for (var i = 0; i &lt; nodes.length; i++) {
            n = nodes[i];
            np = new NodePacket();
            np.addNode(n);
            this.nodePacketList.push(np);
            this.nodePacketMap[n.getId()] = np;
        }
    };
    prototype.getNodePacketForNode = function(n) {
        return this.nodePacketMap[n.getId()];
    };
    prototype.mergeNodePackets = function(packet1, packet2) {
        if (packet1 != packet2) {
            var n;
            var na = packet2.getNodeList();
            for (var i = 0; i &lt; na.length; i++) {
                n = na[i];
                packet1.addNode(n);
                this.nodePacketMap[n.getId()] = packet1;
            }
            this.nodePacketList = ArrayUtil.arrayRemove(this.nodePacketList, packet2);
        }
    };
    prototype.getNodePacketList = function() {
        return this.nodePacketList;
    };
    prototype.setNodePacketList = function(nodePacketList) {
        this.nodePacketList = nodePacketList;
    };
    prototype.getRelationList = function() {
        return this.relationList;
    };
    prototype.setRelationList = function(relationList) {
        this.relationList = relationList;
    };
    prototype.addNodePacket = function(np) {
        this.nodePacketList.push(np);
    };
    prototype.addRelation = function(sourceNodePacket, targetNodePacket, relationType) {
        var newPacketRelation = new PacketRelation(sourceNodePacket, targetNodePacket, relationType);
        this.relationList.push(newPacketRelation);
    };
    prototype.buildPacketRelationsFromNodeRelations = function(nodeRelationList) {
        var sourceNodePacket;
        var targetNodePacket;
        var nr;
        for (var i = 0; i &lt; nodeRelationList.length; i++) {
            nr = nodeRelationList[i];
            sourceNodePacket = this.getNodePacketForNode(nr.getSource());
            targetNodePacket = this.getNodePacketForNode(nr.getTarget());
            if (sourceNodePacket != targetNodePacket) 
                this.addRelation(sourceNodePacket, targetNodePacket, nr.getType());
        }
    };
    prototype.toStringGraphAll = function() {
        var ret = &quot;&quot;;
        ret = ret + &quot;&gt;&gt; Packets: \n&quot;;
        var np;
        for (var i = 0; i &lt; this.nodePacketList.length; i++) {
            np = this.nodePacketList[i];
            ret = ret + &quot;   &quot; + np.toString() + &quot;\n&quot;;
        }
        var pr;
        if (this.relationList.length &gt; 0) {
            ret = ret + &quot;&gt;&gt;Relationships: &gt;\n&quot;;
            for (var i = 0; i &lt; this.relationList.length; i++) {
                pr = this.relationList[i];
                ret = ret + &quot;   &quot; + pr.toString() + &quot;\n&quot;;
            }
        } else {
            ret = ret + &quot;&gt;&gt;NO RELATIONS EXIST!&quot;;
        }
        return ret;
    };
}, {nodePacketList: {name: &quot;Array&quot;, arguments: [&quot;NodePacket&quot;]}, nodePacketMap: {name: &quot;Map&quot;, arguments: [null, &quot;NodePacket&quot;]}, relationList: {name: &quot;Array&quot;, arguments: [&quot;PacketRelation&quot;]}}, {});
var TrustCoprocessor = function() {
    AssertionCoprocessor.call(this);
};
TrustCoprocessor = stjs.extend(TrustCoprocessor, AssertionCoprocessor, [], function(constructor, prototype) {
    prototype.agent = null;
    prototype.multiplier = 1.0;
    prototype.removeNoConfidence = false;
    prototype.mutateAssertions = function(ip, listOfCompetencies, success) {
        var keys = EcObject.keys(this.assertionProcessor.assertions);
        for (var keyIndex = 0; keyIndex &lt; keys.length; keyIndex++) {
            var ary = (this.assertionProcessor.assertions)[keys[keyIndex]];
            for (var i = 0; i &lt; ary.length; i++) {
                var a = ary[i];
                if (a.getAgent().toPem() == this.agent.toPem()) {
                    a.confidence = a.confidence * this.multiplier;
                    if (this.removeNoConfidence &amp;&amp; a.confidence == 0.0) 
                        ary.splice(i--, 1);
                }
            }
        }
        success();
    };
}, {agent: &quot;EcPk&quot;, assertionProcessor: &quot;AssertionProcessor&quot;}, {});
var OpenBadgeCoprocessor = function() {
    AssertionCoprocessor.call(this);
};
OpenBadgeCoprocessor = stjs.extend(OpenBadgeCoprocessor, AssertionCoprocessor, [], function(constructor, prototype) {
    prototype.email = null;
    prototype.badgePluginIdentifier = null;
    prototype.confidenceOfBadges = 1.0;
    prototype.collectAssertions = function(ip, listOfCompetencies, success) {
        if (listOfCompetencies.length == 0) {
            AssertionCoprocessor.prototype.collectAssertions.call(this, ip, listOfCompetencies, success);
            return;
        }
        var assertions = new Array();
        var me = this;
        var eah = new EcAsyncHelper();
        eah.each(me.assertionProcessor.repositories, function(currentRepository, callback0) {
            var searchQuery = &quot;@type:\&quot;BadgeClass\&quot;&quot;;
            for (var i = 0; i &lt; listOfCompetencies.length; i++) {
                if (i == 0) 
                    searchQuery += &quot; AND (&quot;;
                if (i &gt; 0) 
                    searchQuery += &quot; OR &quot;;
                searchQuery += &quot;alignment.targetUrl:\&quot;&quot; + listOfCompetencies[i] + &quot;\&quot;&quot;;
            }
            if (listOfCompetencies.length &gt; 0) 
                searchQuery += &quot;)&quot;;
            me.assertionProcessor.log(ip, &quot;Querying repositories for badges regarding &quot; + listOfCompetencies.length + &quot; query: &quot; + searchQuery);
            var params = new Object();
            (params)[&quot;size&quot;] = 5000;
            currentRepository.searchWithParams(searchQuery, params, null, function(p1) {
                me.assertionProcessor.log(ip, p1.length + &quot; badgeClasses found.&quot;);
                var badgeClassHelper = new EcAsyncHelper();
                badgeClassHelper.each(p1, function(badgeClass, badgeClassDone) {
                    currentRepository.search(&quot;@context:\&quot;https://w3id.org/openbadges/v2\&quot; AND @type:Assertion AND badge:\&quot;&quot; + badgeClass.id + &quot;\&quot;&quot;, null, function(badgeAssertions) {
                        for (var j = 0; j &lt; badgeAssertions.length; j++) {
                            var hash = EcCrypto.sha256(me.email + ((badgeAssertions[j])[&quot;recipient&quot;])[&quot;salt&quot;]);
                            if (&quot;sha256$&quot; + hash.toLowerCase() != ((badgeAssertions[j])[&quot;recipient&quot;])[&quot;identity&quot;]) {
                                me.assertionProcessor.log(ip, me.email + &quot; hashed with salt != &quot; + ((badgeAssertions[j])[&quot;recipient&quot;])[&quot;identity&quot;]);
                                badgeAssertions.splice(j--, 1);
                            } else 
                                me.assertionProcessor.log(ip, me.email + &quot; hashed with salt == &quot; + ((badgeAssertions[j])[&quot;recipient&quot;])[&quot;identity&quot;]);
                        }
                        for (var j = 0; j &lt; badgeAssertions.length; j++) {
                            var alignments = (badgeClass)[&quot;alignment&quot;];
                            if (alignments != null) 
                                for (var k = 0; k &lt; alignments.length; k++) {
                                    var alignment = alignments[k];
                                    var a = new Assertion();
                                    a.addOwner(ip.subject[0]);
                                    a.setSubject(ip.subject[0]);
                                    a.setAgent(me.badgePluginIdentifier);
                                    a.competency = (alignment)[&quot;targetUrl&quot;];
                                    me.assertionProcessor.log(ip, &quot;Generating Assertion for competency: &quot; + (alignment)[&quot;targetUrl&quot;]);
                                    a.framework = (alignment)[&quot;targetFramework&quot;];
                                    a.confidence = me.confidenceOfBadges;
                                    var evidence = new Array();
                                    evidence.push(badgeAssertions[j].id);
                                    a.setEvidence(evidence);
                                    a.setAssertionDate(new Date((badgeAssertions[j])[&quot;issuedOn&quot;]).getTime());
                                    assertions.push(a);
                                }
                        }
                        badgeClassDone();
                    }, ip.failure);
                }, function(strings) {
                    callback0();
                });
            }, ip.failure);
        }, function(strings) {
            success(assertions);
        });
    };
}, {badgePluginIdentifier: &quot;EcPk&quot;, assertionProcessor: &quot;AssertionProcessor&quot;}, {});
/**
 *  Processor used in Assertion Processing. Can estimate or determine competence
 *  of individuals.
 * 
 *  @author fritz.ray@eduworks.com
 *  @author tom.buskirk@eduworks.com
 *  @class AssertionProcessor
 *  @module org.cassproject
 */
var AssertionProcessor = function() {
    this.repositories = new Array();
    this.coprocessors = new Array();
    this.step = AssertionProcessor.DEF_STEP;
    this.profileMode = false;
};
AssertionProcessor = stjs.extend(AssertionProcessor, null, [], function(constructor, prototype) {
    constructor.DEF_STEP = false;
    prototype.repositories = null;
    prototype.step = false;
    prototype.profileMode = false;
    prototype.logFunction = null;
    prototype.assertions = null;
    prototype.coprocessors = null;
    prototype.processedEquivalencies = null;
    prototype.context = null;
    prototype.assertionsCollected = false;
    prototype.log = function(ip, string) {
        if (this.logFunction != null) {
            var id = &quot;&quot;;
            if (ip.competency != null &amp;&amp; ip.competency.length &gt; 0) 
                id = ip.competency[0].shortId() + &quot;:&quot;;
            this.logFunction(new Date().getTime() % 100000 + &quot;: &quot; + string);
        }
        ip.log += &quot;\n&quot; + string;
    };
    /**
     *  Asynchronously processes and provides an answer to the question: Does an
     *  individual hold a competency?
     * 
     *  @param {EcPk[]}                  subject Public keys that identify the subject.
     *  @param {EcCompetency}            competency The Competency being inquired about.
     *  @param {EcLevel}                 level The Level of the Competency at which the question
     *                                   is being asked.
     *  @param {EcFramework}             context The Framework in which to scope the inquiry.
     *  @param {EbacSignature[]}         additionalSignatures Additional signatures
     *                                   provided by an authority, used to request additional access on a one-time
     *                                   basis.
     *  @param {function(InquiryPacket)} success The method that is invoked when
     *                                   a decision has been reached.
     *  @param {string                   function(string)} ask The method that is invoked when the
     *                                   assertion processor detects that it needs information. (Usernames,
     *                                   passwords, etc)
     *  @param {function(string)}        failure The method that is invoked when the
     *                                   assertion processor has failed.
     *  @method has
     */
    prototype.has = function(subject, competency, level, context, additionalSignatures, success, ask, failure) {
        var ip = new InquiryPacket(subject, competency, level, context, success, failure, null, InquiryPacket.IPType.COMPETENCY);
        ip.root = true;
        this.processedEquivalencies = {};
        this.assertions = null;
        this.context = context;
        this.log(ip, &quot;Created new inquiry.&quot;);
        var me = this;
        this.continueProcessingFirstPass(ip);
    };
    prototype.collectAssertionsForSecondPass = function(ip, success) {
        this.assertionsCollected = true;
        var listOfActivatedCompetencies = new Array();
        this.collectCompetencies(ip, listOfActivatedCompetencies, new Array());
        var me = this;
        listOfActivatedCompetencies.sort(function(a, b) {
            return b.compareTo(a);
        });
        var eah = new EcAsyncHelper();
        eah.each(this.repositories, function(currentRepository, callback0) {
            var searchQuery = me.buildAssertionsSearchQuery(ip, listOfActivatedCompetencies);
            me.log(ip, &quot;Querying repositories for subject assertions on &quot; + listOfActivatedCompetencies.length + &quot; competencies: &quot; + searchQuery);
            var params = new Object();
            (params)[&quot;size&quot;] = 5000;
            EcAssertion.search(currentRepository, searchQuery, function(p1) {
                me.log(ip, p1.length + &quot; assertions found.&quot;);
                me.assertions = new Object();
                for (var i = 0; i &lt; p1.length; i++) {
                    var a = p1[i];
                    var competency = EcRemoteLinkedData.trimVersionFromUrl(a.competency);
                    if ((me.assertions)[competency] == null) 
                        (me.assertions)[competency] = new Array();
                    var as = (me.assertions)[competency];
                    as.push(a);
                }
                callback0();
            }, function(p1) {
                callback0();
            }, params);
        }, function(strings) {
            var eah2 = new EcAsyncHelper();
            eah2.each(me.coprocessors, function(ac, callback00) {
                ac.assertionProcessor = me;
                ac.collectAssertions(ip, listOfActivatedCompetencies, function(assertions) {
                    for (var i = 0; i &lt; assertions.length; i++) {
                        var a = assertions[i];
                        var competency = EcRemoteLinkedData.trimVersionFromUrl(a.competency);
                        if ((me.assertions)[competency] == null) 
                            (me.assertions)[competency] = new Array();
                        var as = (me.assertions)[competency];
                        as.push(a);
                    }
                    callback00();
                });
            }, function(strings) {
                var eah3 = new EcAsyncHelper();
                eah3.each(me.coprocessors, function(ac, callback000) {
                    ac.assertionProcessor = me;
                    ac.mutateAssertions(ip, listOfActivatedCompetencies, callback000);
                }, function(strings) {
                    success(ip);
                });
            });
        });
    };
    prototype.isIn = function(ip, alreadyDone) {
        for (var i = 0; i &lt; alreadyDone.length; i++) 
            if (ip == alreadyDone[i]) 
                return true;
        return false;
    };
    prototype.continueProcessingSecondPass = function(ip) {
        if (!ip.hasCheckedAssertionsForCompetency) 
            if (this.findSubjectAssertionsForCompetency(ip)) 
                if (EcRemote.async) 
                    return true;
        if (this.processChildPacketsSecondPass(ip.equivalentPackets)) 
            if (EcRemote.async) 
                return true;
        if (this.processChildPacketsSecondPass(ip.subPackets)) 
            if (EcRemote.async) 
                return true;
        if (ip.result == null) {
            this.determineResult(ip);
            this.log(ip, &quot;Determined Result:&quot; + ip.result);
            this.log(ip, &quot;Success:&quot; + ip.success);
            if (ip.result != null &amp;&amp; ip.success != null) {
                this.log(ip, &quot;Running success:&quot; + ip.result);
                ip.success(ip);
            }
            if (EcRemote.async) 
                return true;
        }
        return false;
    };
    prototype.continueProcessingFirstPass = function(ip) {
        if (!ip.finished) {
            if (!ip.hasCheckedRelationshipsForCompetency) {
                this.findCompetencyRelationships(ip);
                if (EcRemote.async) 
                    return true;
            }
            if (!ip.hasCheckedRollupRulesForCompetency) {
                this.findRollupRulesForCompetency(ip);
                if (EcRemote.async) 
                    return true;
            }
            if (this.processChildPackets(ip.equivalentPackets)) 
                return true;
            if (this.processChildPackets(ip.subPackets)) 
                return true;
            ip.finished = true;
            if (!this.assertionsCollected) 
                if (ip.root) {
                    var me = this;
                    this.collectAssertionsForSecondPass(ip, function(p1) {
                        me.continueProcessingSecondPass(ip);
                    });
                    if (EcRemote.async) 
                        return true;
                } else 
                    ip.success(ip);
        }
        if (ip.finished) 
            if (this.assertions != null) 
                return this.continueProcessingSecondPass(ip);
        return false;
    };
    prototype.determineResult = function(ip) {};
    prototype.findCompetencyRelationships = function(ip) {};
    prototype.findSubjectAssertionsForCompetency = function(ip) {};
    prototype.processChildPackets = function(childPackets) {
        if (childPackets != null) 
            for (var i = 0; i &lt; childPackets.length; i++) 
                if (this.continueProcessingFirstPass(childPackets[i])) 
                    return true;
        return false;
    };
    prototype.checkStep = function(ip) {
        this.log(ip, &quot;Checkstep First Pass: &quot; + ip.numberOfQueriesRunning);
        if (ip.numberOfQueriesRunning == 0) 
            if (!this.step &amp;&amp; EcRemote.async) 
                this.continueProcessingFirstPass(ip);
    };
    prototype.processChildPacketsSecondPass = function(childPackets) {
        if (childPackets != null) 
            for (var i = 0; i &lt; childPackets.length; i++) 
                if (this.continueProcessingSecondPass(childPackets[i])) 
                    return true;
        return false;
    };
    prototype.checkStepSecondPass = function(ip) {
        this.log(ip, &quot;Checkstep Second Pass: &quot; + ip.numberOfQueriesRunning);
        if (ip.numberOfQueriesRunning == 0) 
            if (!this.step &amp;&amp; EcRemote.async) 
                this.continueProcessingSecondPass(ip);
    };
    prototype.processEventFailure = function(message, ip) {
        this.log(ip, &quot;Event failed: &quot; + message);
        ip.numberOfQueriesRunning--;
        ip.failure(message);
    };
    prototype.logFoundAssertion = function(a, ip) {
        this.log(ip, &quot;No issues found with assertion.&quot;);
        this.log(ip, &quot;Record Id: &quot; + a.shortId());
        this.log(ip, &quot;Confidence: &quot; + a.confidence);
        this.log(ip, &quot;Number of pieces of evidence: &quot; + a.getEvidenceCount());
        this.log(ip, &quot;Recording in inquiry.&quot;);
    };
    prototype.buildAssertionSearchQuery = function(ip, competency) {
        var result = null;
        if (InquiryPacket.IPType.ROLLUPRULE.equals(ip.type)) {
            if (ip.rule.indexOf(&quot;AND &quot;) == 0) 
                ip.rule = ip.rule.replace(&quot;AND &quot;, &quot;&quot;);
            result = &quot;(&quot; + new EcAssertion().getSearchStringByType() + &quot;) AND (&quot; + ip.rule + &quot;)&quot;;
        } else if (InquiryPacket.IPType.COMPETENCY.equals(ip.type)) 
            result = new EcAssertion().getSearchStringByTypeAndCompetency(competency);
        for (var i = 0; i &lt; ip.subject.length; i++) 
            result += &quot; AND (\\*@reader:\&quot;&quot; + ip.subject[i].toPem() + &quot;\&quot;)&quot;;
        this.log(ip, &quot;Search Query: &quot; + result);
        if (result != null) 
            return result;
         throw new RuntimeException(&quot;Trying to build an assertion search query on an unsupported type: &quot; + ip.type);
    };
    prototype.buildAssertionsSearchQuery = function(ip, competencies) {
        var result = null;
        if (InquiryPacket.IPType.ROLLUPRULE.equals(ip.type)) {
            ip.failure(&quot;NOT SUPPOSED TO BE HERE.&quot;);
             throw new RuntimeException(&quot;Collecting assertions when root node is a rollup rule. Not supported.&quot;);
        } else if (InquiryPacket.IPType.COMPETENCY.equals(ip.type)) {
            result = &quot;(&quot;;
            for (var i = 0; i &lt; competencies.length; i++) {
                if (i != 0) 
                    result += &quot; OR &quot;;
                result += &quot;competency:\&quot;&quot; + competencies[i] + &quot;\&quot;&quot;;
            }
            result += &quot;)&quot;;
        }
        for (var i = 0; i &lt; ip.subject.length; i++) 
            result += &quot; AND (\\*@reader:\&quot;&quot; + ip.subject[i].toPem() + &quot;\&quot;)&quot;;
        if (result != null) 
            return result;
         throw new RuntimeException(&quot;Trying to build an assertion search query on an unsupported type: &quot; + ip.type);
    };
    prototype.processRelationshipPacketsGenerated = function(ip, competency) {
        this.log(ip, &quot;Relationships succesfully processed for: &quot; + competency.id);
        ip.numberOfQueriesRunning--;
        this.checkStep(ip);
    };
    prototype.processRollupRuleInterpretSuccess = function(status, ip) {
        this.log(ip, &quot;Rollup rule successfully interpreted.&quot;);
        ip.numberOfQueriesRunning--;
        this.checkStep(ip);
    };
    prototype.processRollupRuleInterpretSkipped = function(ip) {
        this.log(ip, &quot;Rollup rule skipped.&quot;);
        ip.numberOfQueriesRunning--;
        this.checkStep(ip);
    };
    prototype.findRollupRulesForCompetency = function(ip) {
        ip.hasCheckedRollupRulesForCompetency = true;
        if (!InquiryPacket.IPType.COMPETENCY.equals(ip.type)) {
            this.log(ip, &quot;No rollup rules for combinator types&quot;);
            this.checkStep(ip);
            return;
        }
        var ep = this;
        if (ip.getContext().rollupRule == null) {
            if (EcRemote.async) 
                this.continueProcessingFirstPass(ip);
        } else 
            for (var i = 0; i &lt; ip.getContext().rollupRule.length; i++) {
                ip.numberOfQueriesRunning++;
                EcRollupRule.get(ip.getContext().rollupRule[i], function(rr) {
                    ep.processFindRollupRuleSuccess(rr, ip);
                }, function(p1) {
                    ep.processEventFailure(p1, ip);
                });
            }
    };
    prototype.processFindRollupRuleSuccess = function(rr, ip) {};
    prototype.collectCompetencies = function(ip, listOfActivatedCompetencies, listOfVisitedPackets) {
        if (this.profileMode) {
            for (var i = 0; i &lt; this.context.competency.length; i++) 
                listOfActivatedCompetencies.push(this.context.competency[i]);
            return;
        }
        for (var i = 0; i &lt; listOfVisitedPackets.length; i++) 
            if (ip == listOfVisitedPackets[i]) 
                return;
        listOfVisitedPackets.push(ip);
        for (var i = 0; i &lt; ip.competency.length; i++) {
            for (var j = 0; j &lt; listOfActivatedCompetencies.length; j++) 
                if (ip.competency[i].shortId() == listOfActivatedCompetencies[j]) 
                    continue;
            listOfActivatedCompetencies.push(ip.competency[i].shortId());
        }
        for (var i = 0; i &lt; ip.equivalentPackets.length; i++) 
            this.collectCompetencies(ip.equivalentPackets[i], listOfActivatedCompetencies, listOfVisitedPackets);
        for (var i = 0; i &lt; ip.subPackets.length; i++) 
            this.collectCompetencies(ip.subPackets[i], listOfActivatedCompetencies, listOfVisitedPackets);
    };
}, {repositories: {name: &quot;Array&quot;, arguments: [&quot;EcRepository&quot;]}, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, assertions: &quot;Object&quot;, coprocessors: {name: &quot;Array&quot;, arguments: [&quot;AssertionCoprocessor&quot;]}, processedEquivalencies: {name: &quot;Map&quot;, arguments: [null, null]}, context: &quot;EcFramework&quot;}, {});
var RollupRuleProcessor = function(ip, ep) {
    this.ip = ip;
    this.rollupRulePacketGenerator = new RollupRulePacketGenerator(ip, ep);
};
RollupRuleProcessor = stjs.extend(RollupRuleProcessor, null, [], function(constructor, prototype) {
    prototype.success = null;
    prototype.failure = null;
    prototype.logFunction = null;
    prototype.positive = null;
    prototype.negative = null;
    prototype.onQueryExitResult = null;
    prototype.query = null;
    prototype.rollupRulePacketGenerator = null;
    prototype.s = null;
    prototype.tok = null;
    prototype.que = null;
    prototype.ip = null;
    prototype.log = function(string) {
        if (this.logFunction != null) 
            this.logFunction(string);
    };
    prototype.enterS = function(ctx) {
        if (this.s != null) 
             throw new RuntimeException(&quot;We found another S in our S.&quot;);
        this.s = new RrS();
    };
    prototype.exitS = function(ctx) {
        this.ip.subPackets.push(this.rollupRulePacketGenerator.generatePacket());
    };
    prototype.enterToken = function(ctx) {
        this.s.addToken(this.tok = new RrToken());
    };
    prototype.exitToken = function(ctx) {};
    prototype.enterQuery = function(ctx) {
        this.s.addQuery(this.que = new RrQuery());
        this.query = &quot;&quot;;
        this.onQueryExitResult = null;
    };
    prototype.exitQuery = function(ctx) {
        this.que.query = this.query.trim();
        this.log(&quot;ADDING QUERY: &quot; + this.query.trim());
        this.rollupRulePacketGenerator.addQuery(this.query.trim());
    };
    prototype.exitInnerquery = function(ctx) {
        if (ctx.cLogic != null) 
            this.query += &quot; &quot; + ctx.cLogic.text + &quot; &quot;;
        if (ctx.cValue != null) {
            this.query += ctx.cKey.text + &quot;&quot; + ctx.cOperator.text + &quot;\&quot;&quot; + ctx.cValue.text + &quot;\&quot; &quot;;
        }
        if (ctx.cNumber != null) {
            this.query += ctx.cKey.text + &quot;&quot; + ctx.cOperator.text + &quot;&quot; + ctx.cNumber.text + &quot; &quot;;
        }
    };
    prototype.exitLogical_or_math_operator = function(ctx) {
        if (ctx.cLogic != null) {
            if (&quot;AND&quot; == ctx.cLogic.text.toUpperCase()) {
                this.log(&quot;ADDING OPERATION: &quot; + RollupRulePacketGenerator.OperationType.AND);
                this.rollupRulePacketGenerator.addQueryOperation(RollupRulePacketGenerator.OperationType.AND);
            } else if (&quot;OR&quot; == ctx.cLogic.text.toUpperCase()) {
                this.log(&quot;ADDING OPERATION: &quot; + RollupRulePacketGenerator.OperationType.OR);
                this.rollupRulePacketGenerator.addQueryOperation(RollupRulePacketGenerator.OperationType.OR);
            }
        }
    };
}, {success: {name: &quot;Callback1&quot;, arguments: [null]}, failure: {name: &quot;Callback1&quot;, arguments: [null]}, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, positive: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, negative: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, rollupRulePacketGenerator: &quot;RollupRulePacketGenerator&quot;, s: &quot;RrS&quot;, tok: &quot;RrToken&quot;, que: &quot;RrQuery&quot;, ip: &quot;InquiryPacket&quot;}, {});
var TestGraphBuilder = function() {};
TestGraphBuilder = stjs.extend(TestGraphBuilder, null, [], function(constructor, prototype) {
    constructor.buildTest0 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeA, RelationType.RELATION_TYPE.NARROWS);
    };
    constructor.buildTest1 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeD, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeE, RelationType.RELATION_TYPE.NARROWS);
    };
    constructor.buildTest2 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        var nodeG = new Node(&quot;G&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addNode(nodeG);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.IS_EQUIVALENT_TO);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeF, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeF, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeD, nodeE, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeE, nodeG, RelationType.RELATION_TYPE.REQUIRES);
    };
    constructor.buildTest3 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        var nodeG = new Node(&quot;G&quot;);
        var nodeH = new Node(&quot;H&quot;);
        var nodeI = new Node(&quot;I&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addNode(nodeG);
        graph.addNode(nodeH);
        graph.addNode(nodeI);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeI, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeI, nodeB, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeE, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeE, nodeF, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeF, nodeG, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeG, nodeH, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeH, nodeE, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
    };
    constructor.buildTest4 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        var nodeG = new Node(&quot;G&quot;);
        var nodeH = new Node(&quot;H&quot;);
        var nodeI = new Node(&quot;I&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addNode(nodeG);
        graph.addNode(nodeH);
        graph.addNode(nodeI);
        graph.addRelation(nodeD, nodeE, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeF, nodeG, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeG, nodeH, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeI, nodeB, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeE, nodeF, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeI, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeH, nodeE, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeG, nodeB, RelationType.RELATION_TYPE.NARROWS);
    };
    constructor.buildTest5 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        var nodeG = new Node(&quot;G&quot;);
        var nodeH = new Node(&quot;H&quot;);
        var nodeI = new Node(&quot;I&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addNode(nodeG);
        graph.addNode(nodeH);
        graph.addNode(nodeI);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeI, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeI, nodeB, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeD, nodeE, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeE, nodeF, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeF, nodeG, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeG, nodeH, RelationType.RELATION_TYPE.REQUIRES);
        graph.addRelation(nodeH, nodeE, RelationType.RELATION_TYPE.NARROWS);
    };
    constructor.buildTest6 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        var nodeG = new Node(&quot;G&quot;);
        var nodeH = new Node(&quot;H&quot;);
        var nodeI = new Node(&quot;I&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addNode(nodeG);
        graph.addNode(nodeH);
        graph.addNode(nodeI);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeI, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeI, nodeB, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeE, RelationType.RELATION_TYPE.REQUIRES);
        graph.addRelation(nodeE, nodeF, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeF, nodeG, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeG, nodeH, RelationType.RELATION_TYPE.REQUIRES);
        graph.addRelation(nodeH, nodeE, RelationType.RELATION_TYPE.REQUIRES);
    };
    constructor.buildTest7 = function(graph) {
        var nodeA = new Node(&quot;A&quot;);
        var nodeB = new Node(&quot;B&quot;);
        var nodeC = new Node(&quot;C&quot;);
        var nodeD = new Node(&quot;D&quot;);
        var nodeE = new Node(&quot;E&quot;);
        var nodeF = new Node(&quot;F&quot;);
        graph.addNode(nodeA);
        graph.addNode(nodeB);
        graph.addNode(nodeC);
        graph.addNode(nodeD);
        graph.addNode(nodeE);
        graph.addNode(nodeF);
        graph.addRelation(nodeA, nodeB, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeB, nodeC, RelationType.RELATION_TYPE.NARROWS);
        graph.addRelation(nodeC, nodeD, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeD, nodeB, RelationType.RELATION_TYPE.IS_REQUIRED_BY);
        graph.addRelation(nodeB, nodeF, RelationType.RELATION_TYPE.BROADENS);
        graph.addRelation(nodeF, nodeE, RelationType.RELATION_TYPE.REQUIRES);
        graph.addRelation(nodeE, nodeB, RelationType.RELATION_TYPE.REQUIRES);
    };
    constructor.buildTestGraph = function() {
        var graph = new NodeGraph();
        TestGraphBuilder.buildTest7(graph);
        graph.createImpliedRelations();
        return graph;
    };
}, {}, {});
var CompetencyGraphBuilder = function() {
    this.repositories = new Array();
    this.subjects = new Array();
};
CompetencyGraphBuilder = stjs.extend(CompetencyGraphBuilder, null, [], function(constructor, prototype) {
    constructor.SIZE_OF_ASSERTION_QUERY = 5000;
    prototype.success = null;
    prototype.failure = null;
    prototype.includeAssertions = true;
    prototype.frameworkId = null;
    prototype.rootCompetencyId = null;
    prototype.repositories = null;
    prototype.subjects = null;
    prototype.createImpliedEdges = true;
    prototype.competencyGraph = null;
    prototype.frameworkRelationMap = null;
    prototype.frameworkRelationList = null;
    prototype.assertionList = null;
    prototype.assertionMap = null;
    prototype.relationshipsToProcess = 0;
    prototype.relationshipsProcessed = 0;
    prototype.repositoriesToQuery = 0;
    prototype.repostioriesQueried = 0;
    prototype.assertionsToFillIn = 0;
    prototype.assertionsFilledIn = 0;
    prototype.getRelationsForCompetency = function(competencyId) {
        var competencyRelations = this.frameworkRelationMap[competencyId];
        if (competencyRelations == null) {
            competencyRelations = new Array();
            this.frameworkRelationMap[competencyId] = competencyRelations;
        }
        return competencyRelations;
    };
    prototype.addRelationToCompetencyMap = function(competencyId, relation) {
        var competencyRelations;
        competencyRelations = this.getRelationsForCompetency(competencyId);
        competencyRelations.push(relation);
        this.frameworkRelationMap[competencyId] = competencyRelations;
    };
    prototype.buildFrameworkRelationsMap = function() {
        var relation;
        for (var i = 0; i &lt; this.frameworkRelationList.length; i++) {
            relation = this.frameworkRelationList[i];
            this.addRelationToCompetencyMap(relation.source, relation);
            this.addRelationToCompetencyMap(relation.target, relation);
        }
    };
    prototype.addCompetencyTreeToGraph = function(competencyId) {
        this.competencyGraph.addNode(competencyId);
        var competencyRelations = this.frameworkRelationMap[competencyId];
        if (competencyRelations != null &amp;&amp; competencyRelations.length &gt; 0) {
            var relation;
            for (var i = 0; i &lt; competencyRelations.length; i++) {
                relation = competencyRelations[i];
                if (!this.competencyGraph.graphContainsEdge(relation.source, relation.target, relation.relationType)) {
                    this.competencyGraph.addEdge(relation.source, relation.target, relation.relationType);
                }
                if (!this.competencyGraph.graphContainsNode(relation.target)) {
                    this.addCompetencyTreeToGraph(relation.target);
                }
                if (!this.competencyGraph.graphContainsNode(relation.source)) {
                    this.addCompetencyTreeToGraph(relation.source);
                }
            }
        }
    };
    prototype.returnGraph = function() {
        this.success(this.competencyGraph);
    };
    prototype.addAssertionsToGraph = function() {
        var sa;
        var a;
        for (var i = 0; i &lt; this.assertionList.length; i++) {
            a = this.assertionList[i];
            sa = this.assertionMap[a.id];
            if (sa != null) {
                if (sa.isNegative()) 
                    this.competencyGraph.addNegativeAssertion(sa);
                 else 
                    this.competencyGraph.addPositiveAssertion(sa);
            }
        }
    };
    prototype.checkAssertionDetailsFetched = function() {
        if (this.assertionsFilledIn &gt;= this.assertionsToFillIn) {
            this.addAssertionsToGraph();
            this.returnGraph();
        }
    };
    prototype.fetchAssertionDetailsNegativeStatus = function(a, sa) {
        var cgb = this;
        a.getNegativeAsync(function(negative) {
            if (negative != null &amp;&amp; negative) 
                sa.setNegative(true);
             else 
                sa.setNegative(false);
            cgb.assertionMap[sa.getId()] = sa;
            cgb.assertionsFilledIn++;
            cgb.checkAssertionDetailsFetched();
        }, function(s) {
            sa.setNegative(false);
            cgb.assertionMap[sa.getId()] = sa;
            cgb.assertionsFilledIn++;
            cgb.checkAssertionDetailsFetched();
        });
    };
    prototype.fetchAssertionDetailsExpirationDate = function(a, sa) {
        var cgb = this;
        a.getExpirationDateAsync(function(expirationDate) {
            if (expirationDate == null || expirationDate &lt;= stjs.trunc(new Date().getTime())) {
                cgb.assertionsFilledIn++;
                cgb.checkAssertionDetailsFetched();
            } else {
                sa.setExpirationDate(expirationDate);
                cgb.fetchAssertionDetailsNegativeStatus(a, sa);
            }
        }, function(s) {
            cgb.failure(new ExceptionReturn(&quot;Failed fetchAssertionDetailsExpirationDate: &quot; + s));
        });
    };
    prototype.fetchAssertionDetailsAssertionDate = function(a, sa) {
        var cgb = this;
        a.getAssertionDateAsync(function(assertionDate) {
            if (assertionDate == null || assertionDate &gt; stjs.trunc(new Date().getTime())) {
                cgb.assertionsFilledIn++;
                cgb.checkAssertionDetailsFetched();
            } else {
                sa.setAssertionDate(assertionDate);
                cgb.fetchAssertionDetailsExpirationDate(a, sa);
            }
        }, function(s) {
            cgb.failure(new ExceptionReturn(&quot;Failed fetchAssertionDetailsAssertionDate: &quot; + s));
        });
    };
    prototype.isASubject = function(pk) {
        if (this.subjects == null || this.subjects.length == 0) 
            return true;
        var sub;
        for (var i = 0; i &lt; this.subjects.length; i++) {
            sub = this.subjects[i];
            if (sub.toPem().trim() == pk.toPem().trim()) 
                return true;
        }
        return false;
    };
    prototype.fetchAssertionDetailsSubject = function(a, sa) {
        var cgb = this;
        a.getSubjectAsync(function(sub) {
            if (sub == null || !cgb.isASubject(sub)) {
                cgb.assertionsFilledIn++;
                cgb.checkAssertionDetailsFetched();
            } else {
                sa.setSubjectPem(sub.toPem());
                cgb.fetchAssertionDetailsAssertionDate(a, sa);
            }
        }, function(s) {
            cgb.failure(new ExceptionReturn(&quot;Failed fetchAssertionDetailsSubject: &quot; + s));
        });
    };
    prototype.fillInAssertions = function() {
        this.assertionsToFillIn = this.assertionList.length;
        this.assertionsFilledIn = 0;
        if (this.assertionsToFillIn == 0) 
            this.returnGraph();
        var a;
        var sa;
        for (var i = 0; i &lt; this.assertionList.length; i++) {
            a = this.assertionList[i];
            sa = new SimpleAssertion(a.id, a.competency, a.confidence);
            this.fetchAssertionDetailsSubject(a, sa);
        }
    };
    prototype.checkNumberOfReposQueried = function() {
        if (this.repostioriesQueried &gt;= this.repositoriesToQuery) {
            this.fillInAssertions();
        }
    };
    prototype.addAssertionsToList = function(repoAssertions) {
        for (var i = 0; i &lt; repoAssertions.length; i++) {
            this.assertionList.push(repoAssertions[i]);
        }
        this.repostioriesQueried++;
    };
    prototype.buildAssertionSearchQuery = function() {
        var query = &quot;(&quot;;
        for (var i = 0; i &lt; this.competencyGraph.getNodes().length; i++) {
            if (i != 0) 
                query += &quot; OR &quot;;
            query += &quot;competency:\&quot;&quot; + this.competencyGraph.getNodes()[i] + &quot;\&quot;&quot;;
        }
        query += &quot;)&quot;;
        if (this.subjects != null) {
            for (var i = 0; i &lt; this.subjects.length; i++) {
                query += &quot; AND (\\*@reader:\&quot;&quot; + this.subjects[i].toPem() + &quot;\&quot;)&quot;;
            }
        }
        return query;
    };
    prototype.processCompetencyAssertions = function() {
        this.repositoriesToQuery = this.repositories.length;
        this.repostioriesQueried = 0;
        var currentRepository;
        var params = new Object();
        (params)[&quot;size&quot;] = CompetencyGraphBuilder.SIZE_OF_ASSERTION_QUERY;
        var searchQuery = this.buildAssertionSearchQuery();
        var cgb = this;
        for (var i = 0; i &lt; this.repositories.length; i++) {
            currentRepository = this.repositories[i];
            EcAssertion.search(currentRepository, searchQuery, function(assertions) {
                cgb.addAssertionsToList(assertions);
                cgb.checkNumberOfReposQueried();
            }, function(s) {
                cgb.failure(new ExceptionReturn(&quot;Error fetching assertions: &quot; + s));
            }, params);
        }
    };
    prototype.assembleGraphComponents = function() {
        try {
            this.buildFrameworkRelationsMap();
            this.addCompetencyTreeToGraph(this.rootCompetencyId);
            if (this.createImpliedEdges) 
                this.competencyGraph.createImpliedRelationships();
            if (this.includeAssertions) 
                this.processCompetencyAssertions();
             else 
                this.returnGraph();
        }catch (e) {
            this.failure(new ExceptionReturn(&quot;Exception buildAndReturnCompetencyGraph: &quot; + e.toString()));
        }
    };
    prototype.checkNumberOfRelationsProcessed = function() {
        if (this.relationshipsProcessed &gt;= this.relationshipsToProcess) {
            this.assembleGraphComponents();
        }
    };
    prototype.addRelationshipToList = function(a) {
        this.frameworkRelationList.push(a);
        this.relationshipsProcessed++;
    };
    prototype.fetchFrameworkRelations = function(f) {
        this.relationshipsToProcess = f.relation.length;
        this.relationshipsProcessed = 0;
        var cgb = this;
        if (this.relationshipsToProcess == 0) {
            this.competencyGraph.addNode(this.rootCompetencyId);
            this.success(this.competencyGraph);
        } else {
            for (var i = 0; i &lt; this.relationshipsToProcess; i++) {
                EcAlignment.get(f.relation[i], function(a) {
                    cgb.addRelationshipToList(a);
                    cgb.checkNumberOfRelationsProcessed();
                }, function(s) {
                    cgb.failure(new ExceptionReturn(&quot;Error fetching relationship: &quot; + s));
                });
            }
        }
    };
    prototype.fetchFrameworkAndGo = function() {
        var cgb = this;
        EcFramework.get(this.frameworkId, function(f) {
            cgb.fetchFrameworkRelations(f);
        }, function(s) {
            cgb.failure(new ExceptionReturn(&quot;Error fetching framework(&quot; + cgb.frameworkId + &quot;): &quot; + s));
        });
    };
    prototype.validateInput = function() {
        if (this.includeAssertions &amp;&amp; (this.repositories == null || this.repositories.length == 0)) {
            this.failure(new ExceptionReturn(&quot;Assertion repository information not provided.&quot;));
        } else if (this.success == null) {
            this.failure(new ExceptionReturn(&quot;Success callback required.&quot;));
        } else if (this.frameworkId == null) {
            this.failure(new ExceptionReturn(&quot;Framework ID required.&quot;));
        } else if (this.rootCompetencyId == null) {
            this.failure(new ExceptionReturn(&quot;Root Competency ID required.&quot;));
        }
    };
    prototype.initBuilder = function(createImpliedEdges) {
        this.createImpliedEdges = createImpliedEdges;
        this.competencyGraph = new CompetencyGraph(this.includeAssertions);
        this.assertionMap = {};
        this.frameworkRelationMap = {};
        this.frameworkRelationList = new Array();
        this.assertionList = new Array();
    };
    prototype.buildCompetencyGraph = function(createImpliedEdges) {
        this.validateInput();
        this.initBuilder(createImpliedEdges);
        this.fetchFrameworkAndGo();
    };
}, {success: {name: &quot;Callback1&quot;, arguments: [&quot;CompetencyGraph&quot;]}, failure: {name: &quot;Callback1&quot;, arguments: [&quot;ExceptionReturn&quot;]}, repositories: {name: &quot;Array&quot;, arguments: [&quot;EcRepository&quot;]}, subjects: {name: &quot;Array&quot;, arguments: [&quot;EcPk&quot;]}, competencyGraph: &quot;CompetencyGraph&quot;, frameworkRelationMap: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;EcAlignment&quot;]}]}, frameworkRelationList: {name: &quot;Array&quot;, arguments: [&quot;EcAlignment&quot;]}, assertionList: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, assertionMap: {name: &quot;Map&quot;, arguments: [null, &quot;SimpleAssertion&quot;]}}, {});
var PredictiveAssertionProcessor = function() {};
PredictiveAssertionProcessor = stjs.extend(PredictiveAssertionProcessor, null, [], function(constructor, prototype) {
    constructor.LOG_ENABLED = false;
    constructor.ABRUBT_EXP_RETENTION = 0.0;
    constructor.DEFAULT_RETENTION = 1.0;
    constructor.STEP_SIZE_NUMERATOR = 1.0;
    constructor.INITIAL_VALUE = 0.0;
    constructor.INIT_PARENT_IDX_DEP_PARM = -1;
    constructor.INIT_CHILD_IDX_DEP_PARM = -1;
    constructor.INIT_WEIGHT_DEP_PARM = 0.0;
    constructor.INIT_LEAK_DEP_PARM = 0.0;
    constructor.INIT_REVERSE_DEP_PARM = false;
    constructor.DEFAULT_PROB_LEARN_UNMET_REQS = 0.0;
    constructor.DEFAULT_PROB_INSUFF = 0.0;
    constructor.DEFAULT_DISCOUNT = 1.0;
    prototype.competencyIndex = null;
    prototype.values = null;
    prototype.dependencies = null;
    prototype.assertions = null;
    prototype.dependencyDefs = null;
    prototype.settings = null;
    prototype.inputGraph = null;
    prototype.subjectPem = null;
    prototype.predictionDate = null;
    prototype.competencyNetwork = null;
    prototype.stepSize = 0.0;
    prototype.priorityQueueThreshold = 0.0;
    prototype.competencePrediction = null;
    prototype.log = function(s) {
        if (PredictiveAssertionProcessor.LOG_ENABLED) {
            console.log(s);
        }
    };
    prototype.verifyDependencyDefs = function() {
        if (this.dependencyDefs == null) {
            this.dependencyDefs = new PapDependencyDefinitions();
            this.dependencyDefs.initDefaultDefinitions();
        }
    };
    prototype.processInputParameters = function(inputGraph, subjectPem, predictionDate, dependencyDefs, settings) {
        this.dependencyDefs = dependencyDefs;
        this.verifyDependencyDefs();
        this.settings = settings;
        if (this.settings == null) 
            this.settings = new PapSettings();
        this.inputGraph = inputGraph;
        this.subjectPem = subjectPem;
        if (this.subjectPem != null) 
            this.subjectPem = this.subjectPem.trim();
        this.predictionDate = predictionDate;
        if (this.predictionDate == null) 
            this.predictionDate = stjs.trunc((new Date()).getTime());
        this.stepSize = PredictiveAssertionProcessor.STEP_SIZE_NUMERATOR / this.settings.getIterations();
        this.priorityQueueThreshold = this.settings.getPriorityQueueThreshold() / this.settings.getIterations();
    };
    prototype.initDependenciesMap = function() {
        this.dependencies = {};
        var type;
        for (var i = 0; i &lt; PapDependency.getDependencyTypes().length; i++) {
            type = PapDependency.getDependencyTypes()[i];
            var dependencySubMap = {};
            this.dependencies[type] = dependencySubMap;
        }
    };
    prototype.initAssertionsMap = function() {
        this.assertions = {};
        for (var i = 0; i &lt; this.inputGraph.getNodes().length; i++) {
            this.assertions[String.valueOf(i)] = new Array();
        }
    };
    prototype.buildValuesCompetencyIndexAndDependencies = function() {
        this.competencyIndex = {};
        this.values = new Array();
        for (var i = 0; i &lt; this.inputGraph.getNodes().length; i++) {
            this.values.push(PredictiveAssertionProcessor.INITIAL_VALUE);
            this.competencyIndex[this.inputGraph.getNodes()[i]] = i;
            var type;
            for (var j = 0; j &lt; PapDependency.getDependencyTypes().length; j++) {
                type = PapDependency.getDependencyTypes()[j];
                this.dependencies[type][String.valueOf(i)] = new Array();
            }
        }
    };
    prototype.initDataStructures = function() {
        this.initDependenciesMap();
        this.initAssertionsMap();
        this.buildValuesCompetencyIndexAndDependencies();
    };
    prototype.getDefaultPapDependencyParms = function() {
        var depParms = new PapDependencyParms();
        depParms.setType(PapDependency.NULL_TYPE);
        depParms.setParentIndex(PredictiveAssertionProcessor.INIT_PARENT_IDX_DEP_PARM);
        depParms.setChildIndex(PredictiveAssertionProcessor.INIT_CHILD_IDX_DEP_PARM);
        depParms.setWeight(PredictiveAssertionProcessor.INIT_WEIGHT_DEP_PARM);
        depParms.setLeak(PredictiveAssertionProcessor.INIT_LEAK_DEP_PARM);
        depParms.setReverse(PredictiveAssertionProcessor.INIT_REVERSE_DEP_PARM);
        return depParms;
    };
    prototype.getDependencyParmsForEdge = function(edge) {
        var depType = edge.getRelation();
        var depClass = this.dependencyDefs.getDependencyDefinitionMap()[depType].getDepClass();
        var depParms = this.getDefaultPapDependencyParms();
        switch (depClass.toLowerCase()) {
            case &quot;isrequiredby&quot;:
                depParms.setChildIndex(this.competencyIndex[edge.getSource()]);
                depParms.setParentIndex(this.competencyIndex[edge.getTarget()]);
                depParms.setType(PapDependency.NECESSARY_TYPE);
                depParms.setWeight(this.dependencyDefs.getWeightForType(depType));
                depParms.setLeak(this.dependencyDefs.getLeakForType(depType));
                depParms.setReverse(this.dependencyDefs.getReverseForType(depType));
                break;
            case &quot;issufficientfor&quot;:
                depParms.setChildIndex(this.competencyIndex[edge.getSource()]);
                depParms.setParentIndex(this.competencyIndex[edge.getTarget()]);
                depParms.setType(PapDependency.SUFFICIENT_TYPE);
                depParms.setWeight(this.dependencyDefs.getWeightForType(depType));
                depParms.setLeak(this.dependencyDefs.getLeakForType(depType));
                depParms.setReverse(this.dependencyDefs.getReverseForType(depType));
                break;
            case &quot;isequivalentto&quot;:
                depParms.setParentIndex(this.competencyIndex[edge.getSource()]);
                depParms.setChildIndex(this.competencyIndex[edge.getTarget()]);
                depParms.setType(PapDependency.EQUIVALENCE_TYPE);
                depParms.setWeight(this.dependencyDefs.getWeightForType(depType));
                break;
            case &quot;broadens&quot;:
                depParms.setParentIndex(this.competencyIndex[edge.getSource()]);
                depParms.setChildIndex(this.competencyIndex[edge.getTarget()]);
                depParms.setType(PapDependency.BROADENS_TYPE);
                depParms.setWeight(this.dependencyDefs.getWeightForType(depType));
                depParms.setReverse(this.dependencyDefs.getReverseForType(depType));
                break;
        }
        return depParms;
    };
    prototype.dependencyExists = function(type, index, dependency) {
        var dependencyArray = this.dependencies[type][index];
        if (dependencyArray == null) {
            return true;
        }
        var currentDep;
        for (var i = 0; i &lt; dependencyArray.length; i++) {
            currentDep = dependencyArray[i];
            if (currentDep.equals(dependency)) 
                return true;
        }
        return false;
    };
    prototype.processEdges = function() {
        for (var i = 0; i &lt; this.inputGraph.getEdges().length; i++) {
            var edge = this.inputGraph.getEdges()[i];
            var depParms = this.getDependencyParmsForEdge(edge);
            var newDep;
            if (PapDependency.EQUIVALENCE_TYPE.equals(depParms.getType())) {
                depParms.setDependencyFirst(true);
                newDep = new PapDependency(depParms);
                if (!this.dependencyExists(depParms.getType(), String.valueOf(depParms.getParentIndex()), newDep)) {
                    this.dependencies[depParms.getType()][String.valueOf(depParms.getParentIndex())].push(newDep);
                }
                depParms.swapParentChildIndexes();
                newDep = new PapDependency(depParms);
                if (!this.dependencyExists(depParms.getType(), String.valueOf(depParms.getParentIndex()), newDep)) {
                    this.dependencies[depParms.getType()][String.valueOf(depParms.getParentIndex())].push(newDep);
                }
            } else if (edge.getRelation() != null &amp;&amp; edge.getRelation().trim().length &gt; 0) {
                depParms.setDependencyFirst(!depParms.getReverse());
                newDep = new PapDependency(depParms);
                if (!this.dependencyExists(depParms.getType(), String.valueOf(depParms.getParentIndex()), newDep)) {
                    this.dependencies[depParms.getType()][String.valueOf(depParms.getParentIndex())].push(newDep);
                }
            }
        }
    };
    prototype.addAssertions = function(assertionList) {
        var sa;
        var pa;
        for (var i = 0; i &lt; assertionList.length; i++) {
            sa = assertionList[i];
            if (sa.getAssertionDate() &lt;= this.predictionDate &amp;&amp; ((!this.settings.getAbruptExpiration()) || this.predictionDate &lt;= sa.getExpirationDate())) {
                var index = this.competencyIndex[sa.getCompetencyId()];
                pa = new PapAssertion(sa.getConfidence(), index, sa.getAssertionDate(), sa.getExpirationDate(), !sa.isNegative());
                this.assertions[String.valueOf(index)].push(pa);
            }
        }
    };
    prototype.processAssertions = function() {
        if (this.subjectPem == null || this.subjectPem.length &lt;= 0) {
            this.addAssertions(this.inputGraph.getNegativeAssertions());
            this.addAssertions(this.inputGraph.getPositiveAssertions());
        } else {
            var sa;
            var matchingAssertionList = new Array();
            for (var i = 0; i &lt; this.inputGraph.getNegativeAssertions().length; i++) {
                sa = this.inputGraph.getNegativeAssertions()[i];
                if (this.subjectPem.equals(sa.getSubjectPem())) 
                    matchingAssertionList.push(sa);
            }
            this.addAssertions(matchingAssertionList);
            matchingAssertionList = new Array();
            for (var i = 0; i &lt; this.inputGraph.getPositiveAssertions().length; i++) {
                sa = this.inputGraph.getPositiveAssertions()[i];
                if (this.subjectPem.equals(sa.getSubjectPem())) 
                    matchingAssertionList.push(sa);
            }
            this.addAssertions(matchingAssertionList);
        }
    };
    prototype.getTimeFactor = function(assertionDate, expirationDate) {
        var range = expirationDate - assertionDate;
        var timeUntilPrediction = this.predictionDate - assertionDate;
        var rate = (timeUntilPrediction) / range;
        return rate;
    };
    prototype.getRetention = function(assertionDate, expirationDate) {
        if (this.settings.getAbruptExpiration() &amp;&amp; this.predictionDate &gt; (expirationDate)) 
            return PredictiveAssertionProcessor.ABRUBT_EXP_RETENTION;
         else {
            if (this.settings.getGradualForgetting()) {
                var factor = this.getTimeFactor(assertionDate, expirationDate);
                return Math.exp(-factor);
            } else 
                return PredictiveAssertionProcessor.DEFAULT_RETENTION;
        }
    };
    prototype.addAssertionsToUpdateQueue = function(updateQueue) {
        var assertionList;
        var assertion;
        var val;
        for (var i = 0; i &lt; this.inputGraph.getNodes().length; i++) {
            assertionList = this.assertions[String.valueOf(i)];
            for (var j = 0; j &lt; assertionList.length; j++) {
                assertion = assertionList[j];
                val = this.stepSize * assertion.getConfidence() * this.settings.getEvidenceWeight() * this.getRetention(assertion.getAssertionDate(), assertion.getExpirationDate());
                if (val &gt; this.priorityQueueThreshold) {
                    updateQueue.push(new PapUpdate(assertion.getCompetencyIndex(), val, assertion.getResult()));
                }
            }
        }
    };
    prototype.processNecessaryNetworkDependencies = function(update, updateQueue) {
        var updateDependencies = this.competencyNetwork.getDependencies()[PapDependency.NECESSARY_TYPE][String.valueOf(update.getIndex())];
        if (updateDependencies != null) {
            var probabilityLearnUnmetRequirements = PredictiveAssertionProcessor.DEFAULT_PROB_LEARN_UNMET_REQS;
            if (updateDependencies.length &gt; 0) {
                probabilityLearnUnmetRequirements = updateDependencies[0].getLeak();
            }
            var totalRes = (1 - probabilityLearnUnmetRequirements);
            var dep;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                totalRes *= (1 - dep.getWeight() * this.competencyNetwork.getActivations()[dep.getChildIndex()]);
            }
            var gradient;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                if (!update.hasVisited(dep.getChildIndex())) {
                    gradient = update.getChange() * totalRes / (1 - dep.getWeight() * this.competencyNetwork.getActivations()[dep.getChildIndex()]) * dep.getWeight() * this.settings.getDiscount();
                    if (gradient &gt; this.priorityQueueThreshold) {
                        updateQueue.push(update.updateChild(dep.getChildIndex(), gradient));
                    }
                }
            }
        }
    };
    prototype.processSufficientNetworkDependencies = function(update, updateQueue) {
        var updateDependencies = this.competencyNetwork.getDependencies()[PapDependency.SUFFICIENT_TYPE][String.valueOf(update.getIndex())];
        if (updateDependencies != null) {
            var probabilityInsufficient = PredictiveAssertionProcessor.DEFAULT_PROB_INSUFF;
            if (updateDependencies.length &gt; 0) {
                probabilityInsufficient = updateDependencies[0].getLeak();
            }
            var totalRes = (1 - probabilityInsufficient);
            var dep;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                totalRes *= (1.0 - (1.0 - this.competencyNetwork.getActivations()[dep.getChildIndex()]) * dep.getWeight());
            }
            var gradient;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                if (!update.hasVisited(dep.getChildIndex())) {
                    gradient = update.getChange() * (1.0 - totalRes / (1.0 - dep.getWeight() * (1.0 - this.competencyNetwork.getActivations()[dep.getChildIndex()]))) * this.settings.getDiscount();
                    if (gradient &gt; this.priorityQueueThreshold) {
                        updateQueue.push(update.updateChild(dep.getChildIndex(), gradient));
                    }
                }
            }
        }
    };
    prototype.processEquivalenceNetworkDependencies = function(update, updateQueue) {
        var updateDependencies = this.competencyNetwork.getDependencies()[PapDependency.EQUIVALENCE_TYPE][String.valueOf(update.getIndex())];
        if (updateDependencies != null) {
            var dep;
            var gradient;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                if (!update.hasVisited(dep.getChildIndex())) {
                    gradient = update.getChange() * dep.getWeight() * this.settings.getDiscount();
                    if (Math.abs(gradient) &gt; this.priorityQueueThreshold) {
                        updateQueue.push(update.updateChild(dep.getChildIndex(), gradient));
                    }
                }
            }
        }
    };
    prototype.processBroadensNetworkDependencies = function(update, updateQueue) {
        var updateDependencies = this.competencyNetwork.getDependencies()[PapDependency.BROADENS_TYPE][String.valueOf(update.getIndex())];
        if (updateDependencies != null) {
            var dep;
            var gradient;
            for (var i = 0; i &lt; updateDependencies.length; i++) {
                dep = updateDependencies[i];
                if (!update.hasVisited(dep.getChildIndex())) {
                    gradient = update.getChange() * this.settings.getDiscount() * dep.getWeight();
                    if (gradient &gt; this.priorityQueueThreshold) {
                        updateQueue.push(update.updateChild(dep.getChildIndex(), gradient));
                    }
                }
            }
        }
    };
    prototype.predictCompetence = function() {
        this.competencyNetwork = new PapCompetencyNetwork(this.dependencies, this.inputGraph.getNodes().length, this.settings);
        var updateQueue;
        var currentUpdate;
        for (var iteration = 0; iteration &lt; this.settings.getIterations(); iteration++) {
            updateQueue = new Array();
            this.addAssertionsToUpdateQueue(updateQueue);
             while (updateQueue.length &gt; 0){
                currentUpdate = updateQueue.pop();
                this.competencyNetwork.update(currentUpdate.getIndex(), currentUpdate.getChange(), currentUpdate.getPositive());
                this.processNecessaryNetworkDependencies(currentUpdate, updateQueue);
                this.processSufficientNetworkDependencies(currentUpdate, updateQueue);
                this.processEquivalenceNetworkDependencies(currentUpdate, updateQueue);
                this.processBroadensNetworkDependencies(currentUpdate, updateQueue);
            }
        }
    };
    prototype.buildCompetencePrediction = function() {
        this.competencePrediction = new PapNetworkPrediction(this.predictionDate, this.subjectPem, this.inputGraph.getNodes(), this.competencyNetwork);
    };
    prototype.predictAll = function(inputGraph, subjectPem, predictionDate, dependencyDefs, settings) {
        this.processInputParameters(inputGraph, subjectPem, predictionDate, dependencyDefs, settings);
        this.initDataStructures();
        this.processEdges();
        this.processAssertions();
        this.predictCompetence();
        this.buildCompetencePrediction();
        return this.competencePrediction;
    };
}, {competencyIndex: {name: &quot;Map&quot;, arguments: [null, null]}, values: {name: &quot;Array&quot;, arguments: [null]}, dependencies: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;PapDependency&quot;]}]}]}, assertions: {name: &quot;Map&quot;, arguments: [null, {name: &quot;Array&quot;, arguments: [&quot;PapAssertion&quot;]}]}, dependencyDefs: &quot;PapDependencyDefinitions&quot;, settings: &quot;PapSettings&quot;, inputGraph: &quot;CompetencyGraph&quot;, competencyNetwork: &quot;PapCompetencyNetwork&quot;, competencePrediction: &quot;PapNetworkPrediction&quot;}, {});
/**
 *  Processor used in determining all the competencies a for which a user has assertions.
 *  Utilizes EcFrameworkGraph
 * 
 *  @author fritz.ray@eduworks.com
 *  @author tom.buskirk@eduworks.com
 *  @class ProfileProcessor
 *  @module org.cassproject
 */
var ProfileProcessor = function() {};
ProfileProcessor = stjs.extend(ProfileProcessor, null, [], function(constructor, prototype) {
    constructor.DEBUG = true;
    prototype.profilePkPems = null;
    prototype.repo = null;
    prototype.successCallback = null;
    prototype.failureCallback = null;
    prototype.frameworksToProcess = 0;
    prototype.frameworksProcessed = 0;
    prototype.assertedFrameworkGraphs = null;
    prototype.unfilteredAssertionList = null;
    prototype.profileAssertions = null;
    prototype.addedAssertionIds = null;
    prototype.assertionCompetencies = null;
    prototype.debugMessage = function(o) {
        if (ProfileProcessor.DEBUG) 
            console.log(o);
    };
    prototype.checkAllFrameworkGraphAssertionsHaveProcessed = function() {
        this.debugMessage(&quot;checkAllFrameworkGraphAssertionsHaveProcessed&quot;);
        this.debugMessage(&quot;frameworksProcessed: &quot; + this.frameworksProcessed);
        if (this.frameworksProcessed &gt;= this.frameworksToProcess) {
            this.debugMessage(&quot;All profile assertion framework graphs processed&quot;);
            this.successCallback();
        }
    };
    prototype.processFrameworkGraphAssertions = function(efg, framework) {
        this.debugMessage(&quot;(&quot; + Date.now() + &quot;) Processing framework graph assertions for:&quot;);
        this.debugMessage(framework.shortId());
        this.debugMessage(framework.getName());
        var me = this;
        efg.processAssertionsBoolean(this.profileAssertions, function() {
            me.frameworksProcessed++;
            me.assertedFrameworkGraphs.push(efg);
            me.checkAllFrameworkGraphAssertionsHaveProcessed();
        }, function(err) {
            me.handleFailedFrameworkGraphOperation(&quot;Process Graph: &quot; + err);
        });
    };
    prototype.handleFailedFrameworkGraphOperation = function(err) {
        this.debugMessage(&quot;handleFailedFrameworkGraphOperation: &quot; + err);
        this.frameworksProcessed++;
        this.checkAllFrameworkGraphAssertionsHaveProcessed();
    };
    prototype.buildProfileAssertionFrameworkGraph = function(framework) {
        this.debugMessage(&quot;(&quot; + Date.now() + &quot;) Generating framework graph for:&quot;);
        this.debugMessage(framework.shortId());
        this.debugMessage(framework.getName());
        var me = this;
        var efg = new EcFrameworkGraph();
        efg.addFramework(framework, this.repo, function() {
            me.processFrameworkGraphAssertions(efg, framework);
        }, function(err) {
            me.handleFailedFrameworkGraphOperation(&quot;Build Graph: &quot; + err);
        });
    };
    prototype.generateProfileAssertionFrameworkGraphs = function(profileAssertionFrameworks) {
        if (profileAssertionFrameworks.length &lt;= 0) 
            this.successCallback();
         else {
            this.frameworksToProcess = profileAssertionFrameworks.length;
            this.debugMessage(&quot;Generating framework graphs...&quot;);
            this.debugMessage(profileAssertionFrameworks);
            for (var i = 0; i &lt; profileAssertionFrameworks.length; i++) {
                this.buildProfileAssertionFrameworkGraph(profileAssertionFrameworks[i]);
            }
        }
    };
    prototype.buildAssertionCompetencyList = function() {
        this.assertionCompetencies = new Array();
        for (var i = 0; i &lt; this.profileAssertions.length; i++) {
            var asr = this.profileAssertions[i];
            if (!EcArray.has(this.assertionCompetencies, asr.competency)) {
                this.assertionCompetencies.push(asr.competency);
            }
        }
    };
    prototype.getFrameworkSearchQueryForAssertionCompetencies = function() {
        var searchQuery = &quot;&quot;;
        if (this.assertionCompetencies.length &gt; 1) 
            searchQuery = &quot;(&quot;;
        for (var i = 0; i &lt; this.assertionCompetencies.length; i++) {
            if (i &gt; 0) 
                searchQuery += &quot; OR &quot;;
            searchQuery += &quot;(competency:\&quot;&quot; + this.assertionCompetencies[i] + &quot;\&quot;)&quot;;
        }
        if (this.assertionCompetencies.length &gt; 1) 
            searchQuery += &quot;)&quot;;
        this.debugMessage(&quot;Framework search query: &quot; + searchQuery);
        return searchQuery;
    };
    prototype.findFrameworksForProfileAssertions = function() {
        this.unfilteredAssertionList = null;
        this.buildAssertionCompetencyList();
        this.debugMessage(&quot;Fetching Assertion Frameworks...&quot;);
        var me = this;
        EcFramework.search(this.repo, this.getFrameworkSearchQueryForAssertionCompetencies(), function(arrayOfEcFrameworks) {
            me.debugMessage(&quot;Assertion Frameworks Fetched&quot;);
            me.generateProfileAssertionFrameworkGraphs(arrayOfEcFrameworks);
        }, me.failureCallback, null);
    };
    prototype.filterAssertionList = function() {
        if (this.unfilteredAssertionList.length == 0) 
            this.successCallback();
         else {
            var me = this;
            var eah = new EcAsyncHelper();
            eah.each(this.unfilteredAssertionList, function(assertion, done) {
                assertion.getSubjectAsync(function(subject) {
                    if (subject != null) {
                        if (EcArray.has(me.profilePkPems, subject.toPem())) {
                            if (!EcArray.has(me.addedAssertionIds, assertion.shortId())) {
                                me.profileAssertions.push(assertion);
                                me.addedAssertionIds.push(assertion.shortId());
                            }
                        }
                    }
                    done();
                }, eah.failWithCallback(me.failureCallback, done));
            }, function(aa) {
                me.debugMessage(&quot;Assertions filtered&quot;);
                me.debugMessage(me.profileAssertions);
                me.findFrameworksForProfileAssertions();
            });
        }
    };
    prototype.isEnvelopeOwnedByProfileUser = function(asrEnv) {
        if (asrEnv.owner == null) 
            return false;
        for (var i = 0; i &lt; asrEnv.owner.length; i++) {
            if (EcArray.has(this.profilePkPems, asrEnv.owner[i])) 
                return true;
        }
        return false;
    };
    prototype.isEncryptedAssertionEnvelope = function(asrEnv) {
        return true;
    };
    prototype.processPotentialAssertionEnvelope = function(potAsrEnv) {
        this.debugMessage(&quot;processPotentialAssertionEnvelope: &quot; + potAsrEnv.shortId());
        if (this.isEncryptedAssertionEnvelope(potAsrEnv) &amp;&amp; this.isEnvelopeOwnedByProfileUser(potAsrEnv)) {
            var nv = new EcEncryptedValue();
            nv.copyFrom(potAsrEnv);
            var aed = nv.decryptIntoObject();
            var realAsrEnv = new AssertionEnvelope();
            realAsrEnv.copyFrom(aed);
            for (var i = 0; i &lt; realAsrEnv.assertion.length; i++) {
                var eca = new EcAssertion();
                eca.copyFrom(realAsrEnv.getAssertion(i));
                this.unfilteredAssertionList.push(eca);
            }
        }
    };
    prototype.processAssertionEnvelopes = function(ecRldArray) {
        this.debugMessage(&quot;Processing Assertion Envelopes...&quot;);
        if (ecRldArray != null &amp;&amp; ecRldArray.length &gt; 0) {
            for (var i = 0; i &lt; ecRldArray.length; i++) {
                this.processPotentialAssertionEnvelope(ecRldArray[i]);
            }
        }
        this.filterAssertionList();
    };
    prototype.fetchAssertionEnvelopes = function() {
        this.debugMessage(&quot;Fetching Assertion Envelopes...&quot;);
        var me = this;
        this.repo.searchWithParams(new AssertionEnvelope().getSearchStringByType(), null, null, function(ecRldArray) {
            me.debugMessage(&quot;Assertion Envelopes Fetched&quot;);
            me.processAssertionEnvelopes(ecRldArray);
        }, me.failureCallback);
    };
    prototype.getAssertionSearchQueryForProfilePkPems = function() {
        var searchQuery = &quot;&quot;;
        if (this.profilePkPems.length &gt; 1) 
            searchQuery = &quot;(&quot;;
        for (var i = 0; i &lt; this.profilePkPems.length; i++) {
            if (i &gt; 0) 
                searchQuery += &quot; OR &quot;;
            searchQuery += &quot;(\\*@reader:\&quot;&quot; + this.profilePkPems[i] + &quot;\&quot;)&quot;;
        }
        if (this.profilePkPems.length &gt; 1) 
            searchQuery += &quot;)&quot;;
        this.debugMessage(&quot;Assertion search query: &quot; + searchQuery);
        return searchQuery;
    };
    prototype.fetchProfileAssertions = function() {
        this.debugMessage(&quot;Fetching Assertions...&quot;);
        var me = this;
        EcAssertion.search(this.repo, this.getAssertionSearchQueryForProfilePkPems(), function(arrayOfEcAssertions) {
            me.debugMessage(&quot;Assertions Fetched&quot;);
            if (arrayOfEcAssertions != null &amp;&amp; arrayOfEcAssertions.length &gt; 0) {
                me.unfilteredAssertionList = arrayOfEcAssertions;
            }
            me.fetchAssertionEnvelopes();
        }, me.failureCallback, null);
    };
    prototype.processProfileAssertions = function(repo, profilePkPems, success, failure) {
        this.profilePkPems = profilePkPems;
        this.repo = repo;
        this.successCallback = success;
        this.failureCallback = failure;
        this.assertedFrameworkGraphs = new Array();
        this.profileAssertions = new Array();
        this.unfilteredAssertionList = new Array();
        this.addedAssertionIds = new Array();
        this.fetchProfileAssertions();
    };
}, {profilePkPems: {name: &quot;Array&quot;, arguments: [null]}, repo: &quot;EcRepository&quot;, successCallback: &quot;Callback0&quot;, failureCallback: {name: &quot;Callback1&quot;, arguments: [null]}, assertedFrameworkGraphs: {name: &quot;Array&quot;, arguments: [&quot;EcFrameworkGraph&quot;]}, unfilteredAssertionList: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, profileAssertions: {name: &quot;Array&quot;, arguments: [&quot;EcAssertion&quot;]}, addedAssertionIds: {name: &quot;Array&quot;, arguments: [null]}, assertionCompetencies: {name: &quot;Array&quot;, arguments: [null]}}, {});
var CyclicGraphCollapser = function() {};
CyclicGraphCollapser = stjs.extend(CyclicGraphCollapser, null, [], function(constructor, prototype) {
    prototype.nodesProcessed = null;
    prototype.visitedNodes = null;
    prototype.buildNarrowsIsRequiredByEqualsMap = function(graph) {
        var relationMap = new NodeRelationMap();
        var n;
        var nodeList = graph.getNodeList();
        for (var i = 0; i &lt; nodeList.length; i++) {
            n = nodeList[i];
            relationMap.addNodeRelations(n, graph.getNarrowsIsRequiredByEqualsRelationListForNode(n));
        }
        return relationMap;
    };
    prototype.buildBroadensRequiresEqualsMap = function(graph) {
        var relationMap = new NodeRelationMap();
        var n;
        var nodeList = graph.getNodeList();
        for (var i = 0; i &lt; nodeList.length; i++) {
            n = nodeList[i];
            relationMap.addNodeRelations(n, graph.getBroadensRequiresEqualsRelationListForNode(n));
        }
        return relationMap;
    };
    prototype.mergeEquivalentNodes = function(relationMap, npg) {
        var nodeList = relationMap.getNodeList();
        var nodeRelations;
        var nr;
        for (var i = 0; i &lt; nodeList.length; i++) {
            nodeRelations = relationMap.getRelationsForNode(nodeList[i]);
            for (var j = 0; j &lt; nodeRelations.length; j++) {
                nr = nodeRelations[j];
                if (nr.getType() == RelationType.RELATION_TYPE.IS_EQUIVALENT_TO) {
                    npg.mergeNodePackets(npg.getNodePacketForNode(nr.getSource()), npg.getNodePacketForNode(nr.getTarget()));
                }
            }
        }
    };
    prototype.mergeCyclicNodes = function(startCycleNode, npg) {
        var startingIdx = ArrayUtil.arrayLastIndexOf(this.visitedNodes, startCycleNode);
        var partOfCycleNode;
        for (var i = startingIdx + 1; i &lt; this.visitedNodes.length; i++) {
            partOfCycleNode = this.visitedNodes[i];
            if (partOfCycleNode != startCycleNode) {
                npg.mergeNodePackets(npg.getNodePacketForNode(startCycleNode), npg.getNodePacketForNode(partOfCycleNode));
            }
        }
    };
    prototype.findCycles = function(n, relationMap, npg) {
        if (ArrayUtil.arrayContains(this.visitedNodes, n)) {
            this.mergeCyclicNodes(n, npg);
        } else {
            this.nodesProcessed.push(n);
            var relationsToVisit = relationMap.getRelationsForNode(n);
            if (relationsToVisit == null || relationsToVisit.length == 0) 
                return;
             else {
                this.visitedNodes.push(n);
                var nr;
                for (var i = 0; i &lt; relationsToVisit.length; i++) {
                    nr = relationsToVisit[i];
                    this.findCycles(nr.getTarget(), relationMap, npg);
                }
                this.visitedNodes = ArrayUtil.arrayRemove(this.visitedNodes, n);
            }
        }
    };
    prototype.startFindCycles = function(relationMap, npg) {
        var nodeList = relationMap.getNodeList();
        for (var i = 0; i &lt; nodeList.length; i++) {
            this.visitedNodes = new Array();
            this.findCycles(nodeList[i], relationMap, npg);
        }
    };
    prototype.buildNodePacketGraph = function(relationMap) {
        var npg = new NodePacketGraph();
        npg.initNodePacketGraph(relationMap.getNodeList());
        this.mergeEquivalentNodes(relationMap, npg);
        this.nodesProcessed = new Array();
        this.startFindCycles(relationMap, npg);
        return npg;
    };
    prototype.mergeNodePacketGraphs = function(nirbeNpg, breNpg) {
        var mergedNpg = nirbeNpg;
        var np;
        var nodePacketList = breNpg.getNodePacketList();
        for (var i = 0; i &lt; nodePacketList.length; i++) {
            np = nodePacketList[i];
            if (np.getNodeCount() &gt; 1) {
                var targetNodePacket = mergedNpg.getNodePacketForNode(np.getNodeList()[0]);
                for (var j = 1; j &lt; np.getNodeList().length; j++) {
                    mergedNpg.mergeNodePackets(targetNodePacket, mergedNpg.getNodePacketForNode(np.getNodeList()[j]));
                }
            }
        }
        return mergedNpg;
    };
    prototype.collapseGraph = function(graph) {
        try {
            var nirbeNrm = this.buildNarrowsIsRequiredByEqualsMap(graph);
            var nirbeNpg = this.buildNodePacketGraph(nirbeNrm);
            var breNrm = this.buildBroadensRequiresEqualsMap(graph);
            var breNpg = this.buildNodePacketGraph(breNrm);
            var finalNodePacketGraph = this.mergeNodePacketGraphs(nirbeNpg, breNpg);
            finalNodePacketGraph.buildPacketRelationsFromNodeRelations(graph.getRelationList());
            return finalNodePacketGraph;
        }catch (e) {
             throw e;
        }
    };
}, {nodesProcessed: {name: &quot;Array&quot;, arguments: [&quot;Node&quot;]}, visitedNodes: {name: &quot;Array&quot;, arguments: [&quot;Node&quot;]}}, {});
var CombinatorAssertionProcessor = function() {
    AssertionProcessor.call(this);
};
CombinatorAssertionProcessor = stjs.extend(CombinatorAssertionProcessor, AssertionProcessor, [], function(constructor, prototype) {
    constructor.relationLookup = null;
    prototype.processFoundAssertion = function(a, ip, success, failure) {
        var eah = new EcAsyncHelper();
        var me = this;
        eah.each(ip.subject, function(p1, p2) {
            me.checkSubject(a, p1, ip, p2, function(p1) {
                failure(p1);
            });
        }, function(p1) {
            success();
        });
    };
    prototype.checkSubject = function(a, currentSubject, ip, success, failure) {
        var me = this;
        a.getSubjectAsync(function(sub) {
            if (sub.equals(currentSubject)) {
                me.log(ip, &quot;Matching Assertion found.&quot;);
                a.getAssertionDateAsync(function(assertionDate) {
                    if (assertionDate != null) 
                        if (assertionDate &gt; stjs.trunc(new Date().getTime())) {
                            me.log(ip, &quot;Assertion is made for a future date.&quot;);
                            success();
                            return;
                        }
                    a.getExpirationDateAsync(function(expirationDate) {
                        if (expirationDate != null) 
                            if (expirationDate &lt;= stjs.trunc(new Date().getTime())) {
                                me.log(ip, &quot;Assertion is expired. Skipping.&quot;);
                                success();
                                return;
                            }
                        me.logFoundAssertion(a, ip);
                        a.getNegativeAsync(function(p1) {
                            if (p1 != null &amp;&amp; p1) {
                                me.log(ip, &quot;Found valid negative assertion&quot;);
                                ip.negative.push(a);
                            } else {
                                me.log(ip, &quot;Found valid positive assertion&quot;);
                                ip.positive.push(a);
                            }
                            success();
                        }, function(p1) {
                            me.log(ip, &quot;Found valid positive assertion&quot;);
                            ip.positive.push(a);
                            success();
                        });
                    }, failure);
                }, failure);
            } else 
                failure(&quot;Incorrect subject.&quot;);
        }, failure);
    };
    prototype.processFindAssertionsSuccess = function(data, ip) {
        if (data.length == 0) 
            this.log(ip, &quot;No results found.&quot;);
         else 
            this.log(ip, &quot;Total number of assertions found: &quot; + data.length);
        ip.numberOfQueriesRunning--;
        this.checkStepSecondPass(ip);
    };
    prototype.findSubjectAssertionsForCompetency = function(ip) {
        if (this.assertions == null) 
            return true;
        ip.hasCheckedAssertionsForCompetency = true;
        if (!InquiryPacket.IPType.COMPETENCY.equals(ip.type) &amp;&amp; !InquiryPacket.IPType.ROLLUPRULE.equals(ip.type)) {
            this.log(ip, &quot;No assertions for combinator types&quot;);
            return false;
        }
        var me = this;
        if (InquiryPacket.IPType.COMPETENCY.equals(ip.type)) {
            for (var h = 0; h &lt; ip.competency.length; h++) {
                ip.numberOfQueriesRunning++;
                var competency = ip.competency[h];
                var assertionsForThisCompetency = (this.assertions)[competency.shortId()];
                if (assertionsForThisCompetency == null) 
                    assertionsForThisCompetency = new Array();
                var eah = new EcAsyncHelper();
                eah.each(assertionsForThisCompetency, function(p1, p2) {
                    me.processFoundAssertion(p1, ip, p2, function(p1) {
                        p2();
                    });
                }, function(p1) {
                    me.processFindAssertionsSuccess(p1, ip);
                });
            }
            return true;
        } else 
            for (var i = 0; i &lt; this.repositories.length; i++) {
                var currentRepository = this.repositories[i];
                if (InquiryPacket.IPType.ROLLUPRULE.equals(ip.type)) {
                    ip.numberOfQueriesRunning++;
                    this.log(ip, &quot;Searching: &quot; + currentRepository.selectedServer);
                    currentRepository.search(this.buildAssertionSearchQuery(ip, null), function(p1) {}, function(p1) {
                        var eah = new EcAsyncHelper();
                        eah.each(p1, function(p1, p2) {
                            var a = new EcAssertion();
                            a.copyFrom(p1);
                            me.processFoundAssertion(a, ip, p2, function(p1) {
                                p2();
                            });
                        }, function(p1) {
                            me.processFindAssertionsSuccess(p1, ip);
                        });
                    }, function(p1) {
                        me.processEventFailure(p1, ip);
                    });
                }
            }
        return true;
    };
    prototype.findCompetencyRelationships = function(ip) {
        ip.hasCheckedRelationshipsForCompetency = true;
        if (!InquiryPacket.IPType.COMPETENCY.equals(ip.type)) {
            this.log(ip, &quot;No relationships for combinator types&quot;);
            this.checkStep(ip);
            return;
        }
        var ep = this;
        var relationLookup = this.constructor.relationLookup;
        if (relationLookup == null) {
            relationLookup = new Object();
            if (ep.context != null &amp;&amp; ep.context.relation != null) 
                for (var i = 0; i &lt; ep.context.relation.length; i++) {
                    var a = EcAlignment.getBlocking(ep.context.relation[i]);
                    if (a == null) 
                        continue;
                    if ((relationLookup)[a.source] == null) 
                        (relationLookup)[a.source] = new Array();
                    ((relationLookup)[a.source]).push(a);
                    if ((relationLookup)[a.target] == null) 
                        (relationLookup)[a.target] = new Array();
                    ((relationLookup)[a.target]).push(a);
                }
            if (this.profileMode) 
                this.constructor.relationLookup = relationLookup;
        }
        for (var i = 0; i &lt; ip.competency.length; i++) {
            this.log(ip, &quot;Finding relationships for competency: &quot; + ip.competency[i]);
            this.findCompetencyRelationship(ip, ep, ip.competency[i], relationLookup);
        }
    };
    prototype.findCompetencyRelationship = function(ip, ep, c, relationLookup) {
        var rpg = new RelationshipPacketGenerator(ip, ep, this.processedEquivalencies);
        rpg.failure = ip.failure;
        rpg.logFunction = this.logFunction;
        rpg.relationLookup = relationLookup;
        rpg.success = function() {
            ep.processRelationshipPacketsGenerated(ip, c);
        };
        this.log(ip, &quot;Executing relationship packet generator&quot;);
        ip.numberOfQueriesRunning++;
        rpg.go();
    };
    prototype.processFindRollupRuleSuccess = function(rr, ip) {
        var ep = this;
        if (!ip.hasId(rr.competency)) {
            ep.processRollupRuleInterpretSkipped(ip);
            return;
        }
        this.log(ip, &quot;Found rollup rule: &quot; + rr.rule);
        var rrp = new RollupRuleProcessor(ip, this);
        rrp.positive = ip.positive;
        rrp.negative = ip.negative;
        var rri = new RollupRuleInterface(rr.rule, rrp);
        rri.logFunction = this.logFunction;
        rri.success = function(p1) {
            ep.processRollupRuleInterpretSuccess(p1, ip);
        };
        rri.failure = ip.failure;
        this.log(ip, &quot;Executing rollup rule interpreter&quot;);
        rri.go();
    };
}, {relationLookup: &quot;Object&quot;, repositories: {name: &quot;Array&quot;, arguments: [&quot;EcRepository&quot;]}, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, assertions: &quot;Object&quot;, coprocessors: {name: &quot;Array&quot;, arguments: [&quot;AssertionCoprocessor&quot;]}, processedEquivalencies: {name: &quot;Map&quot;, arguments: [null, null]}, context: &quot;EcFramework&quot;}, {});
var FrameworkCollapser = function() {};
FrameworkCollapser = stjs.extend(FrameworkCollapser, null, [], function(constructor, prototype) {
    prototype.repo = null;
    prototype.framework = null;
    prototype.createImpliedRelations = false;
    prototype.competencyArray = null;
    prototype.competencyNodeMap = null;
    prototype.relationArray = null;
    prototype.frameworkNodeGraph = null;
    prototype.collapsedFrameworkNodePacketGraph = null;
    prototype.successCallback = null;
    prototype.failureCallback = null;
    prototype.addCompetenciesToFrameworkNodeGraph = function() {
        var cmp;
        var n;
        this.competencyNodeMap = {};
        for (var i = 0; i &lt; this.competencyArray.length; i++) {
            cmp = this.competencyArray[i];
            n = new Node(cmp.shortId());
            n.setName(cmp.getName());
            n.setDescription(cmp.getDescription());
            this.frameworkNodeGraph.addNode(n);
            this.competencyNodeMap[cmp.shortId()] = n;
        }
    };
    prototype.getRelationType = function(rs) {
        if (&quot;requires&quot;.equalsIgnoreCase(rs)) 
            return RelationType.RELATION_TYPE.REQUIRES;
         else if (&quot;narrows&quot;.equalsIgnoreCase(rs)) 
            return RelationType.RELATION_TYPE.NARROWS;
         else if (&quot;isEquivalentTo&quot;.equalsIgnoreCase(rs)) 
            return RelationType.RELATION_TYPE.IS_EQUIVALENT_TO;
         else 
            return null;
    };
    prototype.addRelationshipsToFrameworkNodeGraph = function() {
        var rel;
        var type;
        var sourceNode;
        var targetNode;
        for (var i = 0; i &lt; this.relationArray.length; i++) {
            rel = this.relationArray[i];
            type = this.getRelationType(rel.relationType);
            if (type != null) {
                sourceNode = this.competencyNodeMap[rel.source];
                targetNode = this.competencyNodeMap[rel.target];
                if (sourceNode != null &amp;&amp; targetNode != null) {
                    this.frameworkNodeGraph.addRelation(sourceNode, targetNode, type);
                }
            }
        }
    };
    prototype.generateFrameworkNodeGraph = function() {
        this.frameworkNodeGraph = new NodeGraph();
        this.addCompetenciesToFrameworkNodeGraph();
        this.addRelationshipsToFrameworkNodeGraph();
        if (this.createImpliedRelations) 
            this.frameworkNodeGraph.createImpliedRelations();
    };
    prototype.collapseFrameworkNodeGraph = function() {
        var cgc = new CyclicGraphCollapser();
        this.collapsedFrameworkNodePacketGraph = cgc.collapseGraph(this.frameworkNodeGraph);
    };
    prototype.continueFrameworkCollapse = function() {
        try {
            this.generateFrameworkNodeGraph();
            try {
                this.collapseFrameworkNodeGraph();
                this.successCallback(this.framework.shortId(), this.collapsedFrameworkNodePacketGraph);
            }catch (e2) {
                this.failureCallback(&quot;Framework collapse failed: &quot; + e2.toString());
            }
        }catch (e) {
            this.failureCallback(&quot;Framework node graph generation failed: &quot; + e.toString());
        }
    };
    prototype.fetchFrameworkAlignments = function(framework) {
        var me = this;
        EcAlignment.search(this.repo, EcGraphUtil.buildIdSearchQueryForIdList(framework.relation), function(ecaa) {
            me.relationArray = ecaa;
            me.continueFrameworkCollapse();
        }, me.failureCallback, null);
    };
    prototype.collapseFramework = function(repo, framework, createImpliedRelations, success, failure) {
        if (framework == null) 
            failure(&quot;Framework is null or undefined&quot;);
         else if (framework.competency == null || framework.competency.length &lt; 1) 
            failure(&quot;Framework has no competencies&quot;);
         else if (repo == null) 
            failure(&quot;Repo is null or undefined&quot;);
         else {
            this.repo = repo;
            this.framework = framework;
            this.createImpliedRelations = createImpliedRelations;
            this.successCallback = success;
            this.failureCallback = failure;
            var me = this;
            var fwkParam = framework;
            EcCompetency.search(repo, EcGraphUtil.buildIdSearchQueryForIdList(framework.competency), function(ecca) {
                me.competencyArray = ecca;
                me.fetchFrameworkAlignments(fwkParam);
            }, me.failureCallback, null);
        }
    };
}, {repo: &quot;EcRepository&quot;, framework: &quot;EcFramework&quot;, competencyArray: {name: &quot;Array&quot;, arguments: [&quot;EcCompetency&quot;]}, competencyNodeMap: {name: &quot;Map&quot;, arguments: [null, &quot;Node&quot;]}, relationArray: {name: &quot;Array&quot;, arguments: [&quot;EcAlignment&quot;]}, frameworkNodeGraph: &quot;NodeGraph&quot;, collapsedFrameworkNodePacketGraph: &quot;NodePacketGraph&quot;, successCallback: {name: &quot;Callback2&quot;, arguments: [null, &quot;NodePacketGraph&quot;]}, failureCallback: {name: &quot;Callback1&quot;, arguments: [null]}}, {});
var OptimisticQuadnaryAssertionProcessor = function() {
    CombinatorAssertionProcessor.call(this);
};
OptimisticQuadnaryAssertionProcessor = stjs.extend(OptimisticQuadnaryAssertionProcessor, CombinatorAssertionProcessor, [], function(constructor, prototype) {
    prototype.transferIndeterminateOptimistically = true;
    prototype.determineCombinatorAndResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) {
            ip.result = InquiryPacket.ResultType.FALSE;
        } else if (ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else if (ip.anyChildPacketsAreUnknown()) {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        } else {
            ip.result = InquiryPacket.ResultType.TRUE;
        }
    };
    prototype.determineCombinatorNarrowsResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.FALSE;
        } else {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        }
    };
    prototype.determineCombinatorBroadensResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) {
            ip.result = InquiryPacket.ResultType.FALSE;
        } else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else if (!(ip.anyChildPacketsAreFalse() || ip.anyChildPacketsAreUnknown())) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        }
    };
    prototype.determineCombinatorRequiresResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) {
            ip.result = InquiryPacket.ResultType.FALSE;
        } else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        }
    };
    prototype.determineCombinatorIsRequiredByResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.FALSE;
        } else {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        }
    };
    prototype.determineCombinatorOrResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) {
            ip.result = InquiryPacket.ResultType.TRUE;
        } else if (ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else if (ip.allChildPacketsUnknown()) {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        } else {
            ip.result = InquiryPacket.ResultType.FALSE;
        }
    };
    prototype.getPacketAssertionResult = function(ip) {
        if (ip.positive.length &gt; 0 &amp;&amp; ip.negative.length == 0) {
            return InquiryPacket.ResultType.TRUE;
        } else if (ip.positive.length == 0 &amp;&amp; ip.negative.length &gt; 0) {
            return InquiryPacket.ResultType.FALSE;
        } else if (ip.positive.length &gt; 0 &amp;&amp; ip.negative.length &gt; 0) {
            return InquiryPacket.ResultType.INDETERMINANT;
        } else {
            return InquiryPacket.ResultType.UNKNOWN;
        }
    };
    prototype.determineResultForUnknownAssertionResult = function(ip) {
        if (ip.allChildPacketsUnknown()) {
            ip.result = InquiryPacket.ResultType.UNKNOWN;
        } else if (ip.allEquivalentPacketsUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) {
                ip.result = InquiryPacket.ResultType.TRUE;
            } else if (ip.allSubPacketsFalseOrUnknown()) {
                ip.result = InquiryPacket.ResultType.FALSE;
            } else {
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
            }
        } else if (ip.allEquivalentPacketsTrueOrUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) {
                ip.result = InquiryPacket.ResultType.TRUE;
            } else {
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
            }
        } else if (ip.allEquivalentPacketsFalseOrUnknown()) {
            if (ip.allSubPacketsFalseOrUnknown()) {
                ip.result = InquiryPacket.ResultType.FALSE;
            } else {
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
            }
        } else {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        }
    };
    prototype.determineResultForTrueAssertionResult = function(ip) {
        if (ip.allEquivalentPacketsTrueOrUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) {
                ip.result = InquiryPacket.ResultType.TRUE;
            } else {
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
            }
        } else {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        }
    };
    prototype.determineResultForFalseAssertionResult = function(ip) {
        if (ip.allEquivalentPacketsFalseOrUnknown()) {
            if (ip.allSubPacketsFalseOrUnknown()) {
                ip.result = InquiryPacket.ResultType.FALSE;
            } else {
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
            }
        } else {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        }
    };
    /**
     *  IF IP type is COMPETENCY|ROLLUPRULE: assertionResult = ( IF number of
     *  positive assertions &gt; 0 &amp;&amp; number of negative assertions = 0 THEN
     *  assertionResult = TRUE IF number of positive assertions = 0 &amp;&amp; number of
     *  negative assertions &gt; 0 THEN assertionResult = FALSE IF number of
     *  positive assertions &gt; 0 &amp;&amp; number of negative assertions &gt; 0 THEN
     *  assertionResult = INDETERMINANT IF number of positive assertions = 0 &amp;&amp;
     *  number of negative assertions = 0 THEN assertionResult = UNKNOWN )
     *  &lt;p&gt;
     *  IF assertionResult = INDETERMINANT THEN INDETERMINANT ELSE IF any
     *  equivalent packets = INDETERMINANT THEN INDETERMINANT ELSE IF any sub
     *  packets = INDETERMINANT THEN INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF assertionResult = UNKNOWN: IF all equivalent packets = UNKNOWN IF
     *  all sub packets = UNKNOWN THEN UNKNOWN IF all sub packets = TRUE|UNKNOWN
     *  THEN TRUE IF all sub packets = FALSE|UNKNOWN THEN FALSE ELSE
     *  INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF all equivalent packets = TRUE|UNKNOWN IF all sub packets =
     *  TRUE|UNKNOWN THEN TRUE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF all equivalent packets = FALSE|UNKNOWN IF all sub packets =
     *  FALSE|UNKNOWN THEN FALSE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     *  &lt;p&gt;
     *  &lt;p&gt;
     *  ELSE IF assertionResult = TRUE: IF all equivalent packets = TRUE|UNKNOWN
     *  IF all sub packets = TRUE|UNKNOWN THEN TRUE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF assertionResult = FALSE: IF all equivalent packets =
     *  FALSE|UNKNOWN IF all sub packets = FALSE|UNKNOWN THEN FALSE ELSE
     *  INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     */
    prototype.determineCompetencyOrRollupRuleResult = function(ip) {
        var assertionResult = this.getPacketAssertionResult(ip);
        if (InquiryPacket.ResultType.INDETERMINANT.equals(assertionResult) || ip.anyIndeterminantChildPackets()) {
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else if (InquiryPacket.ResultType.UNKNOWN.equals(assertionResult)) {
            this.determineResultForUnknownAssertionResult(ip);
        } else if (InquiryPacket.ResultType.TRUE.equals(assertionResult)) {
            this.determineResultForTrueAssertionResult(ip);
        } else {
            this.determineResultForFalseAssertionResult(ip);
        }
    };
    prototype.determineResult = function(ip) {
        if (ip.numberOfQueriesRunning == 0) {
            if (InquiryPacket.IPType.RELATION_AND.equals(ip.type)) {
                this.determineCombinatorAndResult(ip);
            } else if (InquiryPacket.IPType.RELATION_OR.equals(ip.type)) {
                this.determineCombinatorOrResult(ip);
            } else if (InquiryPacket.IPType.RELATION_NARROWS.equals(ip.type)) {
                this.determineCombinatorNarrowsResult(ip);
            } else if (InquiryPacket.IPType.RELATION_BROADENS.equals(ip.type)) {
                this.determineCombinatorBroadensResult(ip);
            } else if (InquiryPacket.IPType.RELATION_REQUIRES.equals(ip.type)) {
                this.determineCombinatorRequiresResult(ip);
            } else if (InquiryPacket.IPType.RELATION_ISREQUIREDBY.equals(ip.type)) {
                this.determineCombinatorIsRequiredByResult(ip);
            } else {
                this.determineCompetencyOrRollupRuleResult(ip);
            }
        } else {
            this.log(ip, &quot;We are not finished accumulating data to answer this query. Error: &quot; + ip.numberOfQueriesRunning);
        }
    };
}, {relationLookup: &quot;Object&quot;, repositories: {name: &quot;Array&quot;, arguments: [&quot;EcRepository&quot;]}, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, assertions: &quot;Object&quot;, coprocessors: {name: &quot;Array&quot;, arguments: [&quot;AssertionCoprocessor&quot;]}, processedEquivalencies: {name: &quot;Map&quot;, arguments: [null, null]}, context: &quot;EcFramework&quot;}, {});
var PessimisticQuadnaryAssertionProcessor = function() {
    CombinatorAssertionProcessor.call(this);
};
PessimisticQuadnaryAssertionProcessor = stjs.extend(PessimisticQuadnaryAssertionProcessor, CombinatorAssertionProcessor, [], function(constructor, prototype) {
    prototype.transferIndeterminateOptimistically = true;
    prototype.determineCombinatorAndResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) 
            ip.result = InquiryPacket.ResultType.FALSE;
         else if (ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
         else if (ip.anyChildPacketsAreUnknown()) 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
         else 
            ip.result = InquiryPacket.ResultType.TRUE;
    };
    prototype.determineCombinatorNarrowsResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) 
            ip.result = InquiryPacket.ResultType.TRUE;
         else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.TRUE;
         else 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
    };
    prototype.determineCombinatorBroadensResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) 
            ip.result = InquiryPacket.ResultType.FALSE;
         else if (ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.FALSE;
         else 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
    };
    prototype.determineCombinatorRequiresResult = function(ip) {
        if (ip.anyChildPacketsAreFalse()) 
            ip.result = InquiryPacket.ResultType.FALSE;
         else if (ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.FALSE;
         else 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
    };
    prototype.determineCombinatorIsRequiredByResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) 
            ip.result = InquiryPacket.ResultType.TRUE;
         else if (this.transferIndeterminateOptimistically &amp;&amp; ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.TRUE;
         else 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
    };
    prototype.determineCombinatorOrResult = function(ip) {
        if (ip.anyChildPacketsAreTrue()) 
            ip.result = InquiryPacket.ResultType.TRUE;
         else if (ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
         else if (ip.allChildPacketsUnknown()) 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
         else 
            ip.result = InquiryPacket.ResultType.FALSE;
    };
    prototype.getPacketAssertionResult = function(ip) {
        if (ip.positive.length &gt; 0 &amp;&amp; ip.negative.length == 0) 
            return InquiryPacket.ResultType.TRUE;
         else if (ip.positive.length == 0 &amp;&amp; ip.negative.length &gt; 0) 
            return InquiryPacket.ResultType.FALSE;
         else if (ip.positive.length &gt; 0 &amp;&amp; ip.negative.length &gt; 0) 
            return InquiryPacket.ResultType.INDETERMINANT;
         else 
            return InquiryPacket.ResultType.UNKNOWN;
    };
    prototype.determineResultForUnknownAssertionResult = function(ip) {
        if (ip.allChildPacketsUnknown()) 
            ip.result = InquiryPacket.ResultType.UNKNOWN;
         else if (ip.allEquivalentPacketsUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) 
                ip.result = InquiryPacket.ResultType.TRUE;
             else if (ip.allSubPacketsFalseOrUnknown()) 
                ip.result = InquiryPacket.ResultType.FALSE;
             else 
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else if (ip.allEquivalentPacketsTrueOrUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) 
                ip.result = InquiryPacket.ResultType.TRUE;
             else 
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else if (ip.allEquivalentPacketsFalseOrUnknown()) {
            if (ip.allSubPacketsFalseOrUnknown()) 
                ip.result = InquiryPacket.ResultType.FALSE;
             else 
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
    };
    prototype.determineResultForTrueAssertionResult = function(ip) {
        if (ip.allEquivalentPacketsTrueOrUnknown()) {
            if (ip.allSubPacketsTrueOrUnknown()) 
                ip.result = InquiryPacket.ResultType.TRUE;
             else 
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
    };
    prototype.determineResultForFalseAssertionResult = function(ip) {
        if (ip.allEquivalentPacketsFalseOrUnknown()) {
            if (ip.allSubPacketsFalseOrUnknown()) 
                ip.result = InquiryPacket.ResultType.FALSE;
             else 
                ip.result = InquiryPacket.ResultType.INDETERMINANT;
        } else 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
    };
    /**
     *  IF IP type is COMPETENCY|ROLLUPRULE: assertionResult = ( IF number of
     *  positive assertions &gt; 0 &amp;&amp; number of negative assertions = 0 THEN
     *  assertionResult = TRUE IF number of positive assertions = 0 &amp;&amp; number of
     *  negative assertions &gt; 0 THEN assertionResult = FALSE IF number of
     *  positive assertions &gt; 0 &amp;&amp; number of negative assertions &gt; 0 THEN
     *  assertionResult = INDETERMINANT IF number of positive assertions = 0 &amp;&amp;
     *  number of negative assertions = 0 THEN assertionResult = UNKNOWN )
     *  &lt;p&gt;
     *  IF assertionResult = INDETERMINANT THEN INDETERMINANT ELSE IF any
     *  equivalent packets = INDETERMINANT THEN INDETERMINANT ELSE IF any sub
     *  packets = INDETERMINANT THEN INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF assertionResult = UNKNOWN: IF all equivalent packets = UNKNOWN IF
     *  all sub packets = UNKNOWN THEN UNKNOWN IF all sub packets = TRUE|UNKNOWN
     *  THEN TRUE IF all sub packets = FALSE|UNKNOWN THEN FALSE ELSE
     *  INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF all equivalent packets = TRUE|UNKNOWN IF all sub packets =
     *  TRUE|UNKNOWN THEN TRUE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF all equivalent packets = FALSE|UNKNOWN IF all sub packets =
     *  FALSE|UNKNOWN THEN FALSE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     *  &lt;p&gt;
     *  &lt;p&gt;
     *  ELSE IF assertionResult = TRUE: IF all equivalent packets = TRUE|UNKNOWN
     *  IF all sub packets = TRUE|UNKNOWN THEN TRUE ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     *  &lt;p&gt;
     *  ELSE IF assertionResult = FALSE: IF all equivalent packets =
     *  FALSE|UNKNOWN IF all sub packets = FALSE|UNKNOWN THEN FALSE ELSE
     *  INDETERMINANT
     *  &lt;p&gt;
     *  ELSE INDETERMINANT
     */
    prototype.determineCompetencyOrRollupRuleResult = function(ip) {
        var assertionResult = this.getPacketAssertionResult(ip);
        if (InquiryPacket.ResultType.INDETERMINANT.equals(assertionResult) || ip.anyIndeterminantChildPackets()) 
            ip.result = InquiryPacket.ResultType.INDETERMINANT;
         else if (InquiryPacket.ResultType.UNKNOWN.equals(assertionResult)) 
            this.determineResultForUnknownAssertionResult(ip);
         else if (InquiryPacket.ResultType.TRUE.equals(assertionResult)) 
            this.determineResultForTrueAssertionResult(ip);
         else 
            this.determineResultForFalseAssertionResult(ip);
    };
    prototype.determineResult = function(ip) {
        if (ip.numberOfQueriesRunning == 0) {
            if (InquiryPacket.IPType.RELATION_AND.equals(ip.type)) 
                this.determineCombinatorAndResult(ip);
             else if (InquiryPacket.IPType.RELATION_OR.equals(ip.type)) 
                this.determineCombinatorOrResult(ip);
             else if (InquiryPacket.IPType.RELATION_NARROWS.equals(ip.type)) 
                this.determineCombinatorNarrowsResult(ip);
             else if (InquiryPacket.IPType.RELATION_BROADENS.equals(ip.type)) 
                this.determineCombinatorBroadensResult(ip);
             else if (InquiryPacket.IPType.RELATION_REQUIRES.equals(ip.type)) 
                this.determineCombinatorRequiresResult(ip);
             else if (InquiryPacket.IPType.RELATION_ISREQUIREDBY.equals(ip.type)) 
                this.determineCombinatorIsRequiredByResult(ip);
             else 
                this.determineCompetencyOrRollupRuleResult(ip);
        } else {
            this.log(ip, &quot;We are not finished accumulating data to answer this query. Error: &quot; + ip.numberOfQueriesRunning);
        }
    };
}, {relationLookup: &quot;Object&quot;, repositories: {name: &quot;Array&quot;, arguments: [&quot;EcRepository&quot;]}, logFunction: {name: &quot;Callback1&quot;, arguments: [&quot;Object&quot;]}, assertions: &quot;Object&quot;, coprocessors: {name: &quot;Array&quot;, arguments: [&quot;AssertionCoprocessor&quot;]}, processedEquivalencies: {name: &quot;Map&quot;, arguments: [null, null]}, context: &quot;EcFramework&quot;}, {});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
